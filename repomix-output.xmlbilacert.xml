This file is a merged representation of a subset of the codebase, containing specifically included files, combined into a single document by Repomix.

<file_summary>
This section contains a summary of this file.

<purpose>
This file contains a packed representation of a subset of the repository's contents that is considered the most important context.
It is designed to be easily consumable by AI systems for analysis, code review,
or other automated processes.
</purpose>

<file_format>
The content is organized as follows:
1. This summary section
2. Repository information
3. Directory structure
4. Repository files (if enabled)
5. Multiple file entries, each consisting of:
  - File path as an attribute
  - Full contents of the file
</file_format>

<usage_guidelines>
- This file should be treated as read-only. Any changes should be made to the
  original repository files, not this packed version.
- When processing this file, use the file path to distinguish
  between different files in the repository.
- Be aware that this file may contain sensitive information. Handle it with
  the same level of security as you would the original repository.
</usage_guidelines>

<notes>
- Some files may have been excluded based on .gitignore rules and Repomix's configuration
- Binary files are not included in this packed representation. Please refer to the Repository Structure section for a complete list of file paths, including binary files
- Only files matching these patterns are included: src
- Files matching patterns in .gitignore are excluded
- Files matching default ignore patterns are excluded
- Files are sorted by Git change count (files with more changes are at the bottom)
</notes>

</file_summary>

<directory_structure>
src/
  app/
    about/
      page.tsx
    admin/
      blogs/
        [id]/
          edit/
            page.tsx
          page.tsx
        new/
          page.tsx
        actions.ts
        BlogDetails.tsx
        BlogForm.tsx
        BlogsClient.tsx
        columns.tsx
        DeleteBlogDialog.tsx
        loading.tsx
        page.tsx
        schema.ts
      contacts/
        [id]/
          edit/
            page.tsx
          page.tsx
        new/
          page.tsx
        actions.ts
        columns.tsx
        ContactDetails.tsx
        ContactForm.tsx
        ContactsClient.tsx
        data-table.tsx
        DeleteContactDialog.tsx
        loading.tsx
        page.tsx
        schema.ts
      dashboard/
        DashboardClient.tsx
        loading.tsx
        page.tsx
      form_submissions/
        [id]/
          edit/
            page.tsx
          page.tsx
        actions.ts
        columns.tsx
        data-table.tsx
        DeleteSubmissionDialog.tsx
        page.tsx
        schema.ts
        StatusUpdate.tsx
        SubmissionDetails.tsx
        SubmissionForm.tsx
        SubmissionsClient.tsx
      login/
        page.tsx
      services/
        [id]/
          edit/
            page.tsx
          page.tsx
          ServiceDetails.tsx
        new/
          page.tsx
        actions.ts
        columns.tsx
        data-table.tsx
        DeleteServiceDialog.tsx
        loading.tsx
        page.tsx
        schema.ts
        ServiceForm.tsx
        ServicesClient.tsx
      testimonials/
        [id]/
          edit/
            page.tsx
          page.tsx
        new/
          page.tsx
        actions.ts
        DeleteTestimonialDialog.tsx
        loading.tsx
        page.tsx
        schema.ts
        TestimonialDetails.tsx
        TestimonialEmbed.tsx
        TestimonialForm.tsx
        TestimonialsClient.tsx
      layout.tsx
    blog/
      [slug]/
        page.tsx
      page.tsx
    contact/
      actions.ts
      ContactForm.tsx
      page.tsx
      schema.ts
    faq/
      FAQContent.tsx
      page.tsx
    services/
      [slug]/
        page.tsx
      page.tsx
    favicon.ico
    globals.css
    layout.tsx
    page.tsx
  components/
    admin/
      AdminLayout.tsx
      Header.tsx
      Sidebar.tsx
      StatCard.tsx
      SupabaseNotConfigured.tsx
    ui/
      accordion.tsx
      alert-dialog.tsx
      alert.tsx
      avatar.tsx
      badge.tsx
      button.tsx
      calendar.tsx
      card.tsx
      carousel.tsx
      chart.tsx
      checkbox.tsx
      collapsible.tsx
      dialog.tsx
      dropdown-menu.tsx
      form.tsx
      ImageUpload.tsx
      input.tsx
      label.tsx
      menubar.tsx
      popover.tsx
      progress.tsx
      radio-group.tsx
      scroll-area.tsx
      select.tsx
      separator.tsx
      sheet.tsx
      sidebar.tsx
      skeleton.tsx
      slider.tsx
      switch.tsx
      table.tsx
      tabs.tsx
      textarea.tsx
      toast.tsx
      toaster.tsx
      tooltip.tsx
    FacebookSDKInitializer.tsx
    Footer.tsx
    Header.tsx
    Icon.tsx
    icons.tsx
    MainLayout.tsx
    StructuredData.tsx
    Testimonials.tsx
    WhatsAppButton.tsx
  hooks/
    use-mobile.tsx
    use-toast.ts
    useBlogs.ts
    useContacts.ts
    useFormSubmission.ts
    useServices.ts
    useSubmissions.ts
    useTestimonials.ts
    useUser.ts
  lib/
    supabase/
      SQL/
        rls_policies.sql
        storage_policies.sql
        supa_migration.sql
      admin.ts
      api.ts
      blog.ts
      client.ts
      server.ts
      services.ts
      supa_migration.sql
      supabase.ts
    placeholder-images.json
    placeholder-images.ts
    types.ts
    utils.ts
</directory_structure>

<files>
This section contains the contents of the repository's files.

<file path="src/app/admin/blogs/new/page.tsx">
import BlogForm from '../BlogForm';
import { Card, CardContent, CardHeader, CardTitle, CardDescription } from '@/components/ui/card';
import Link from 'next/link';
import { Button } from '@/components/ui/button';
import { ArrowLeft } from 'lucide-react';

export const metadata = {
    title: 'New Blog Post | Bilacert Admin Pro',
    description: 'Create a new blog post.',
};

export default function NewBlogPage() {
    return (
        <div className="space-y-6">
            <Button variant="outline" asChild>
                <Link href="/admin/blogs">
                    <ArrowLeft className="mr-2 h-4 w-4" />
                    Back to Blogs
                </Link>
            </Button>
            <Card>
                <CardHeader>
                    <CardTitle>Add New Post</CardTitle>
                    <CardDescription>Fill out the form below to create a new post.</CardDescription>
                </CardHeader>
                <CardContent>
                    <BlogForm />
                </CardContent>
            </Card>
        </div>
    );
}
</file>

<file path="src/app/admin/blogs/loading.tsx">
import { Card, CardContent, CardHeader, CardFooter } from '@/components/ui/card';
import { Skeleton } from '@/components/ui/skeleton';

export default function BlogsLoading() {
    return (
        <div className="grid grid-cols-1 gap-6 md:grid-cols-2 lg:grid-cols-3">
            {Array.from({ length: 6 }).map((_, i) => (
                <Card key={i}>
                    <CardHeader>
                        <Skeleton className="h-6 w-3/4" />
                        <Skeleton className="h-4 w-1/2" />
                    </CardHeader>
                    <CardContent className="space-y-4">
                         <Skeleton className="h-12 w-full" />
                        <div className="space-y-2">
                            <Skeleton className="h-4 w-1/4" />
                            <Skeleton className="h-5 w-1/3" />
                        </div>
                        <div className="space-y-2">
                            <Skeleton className="h-4 w-1/4" />
                            <Skeleton className="h-5 w-1/2" />
                        </div>
                    </CardContent>
                    <CardFooter className="flex justify-end">
                        <Skeleton className="h-8 w-8" />
                    </CardFooter>
                </Card>
            ))}
        </div>
    )
}
</file>

<file path="src/app/admin/blogs/page.tsx">
import { Suspense } from 'react';
import BlogsClient from './BlogsClient';
import BlogsLoading from './loading';
import { Button } from '@/components/ui/button';
import Link from 'next/link';
import { PlusCircle } from 'lucide-react';

export const metadata = {
    title: 'Blogs | Bilacert Admin Pro',
    description: 'Create and manage blog posts.',
};

export default function BlogsPage() {
  return (
    <div className="space-y-6">
        <div className="flex items-center justify-between">
            <h1 className="text-3xl font-bold tracking-tight">Blogs</h1>
            <Button asChild>
                <Link href="/admin/blogs/new">
                    <PlusCircle className="mr-2 h-4 w-4" />
                    Add Post
                </Link>
            </Button>
        </div>
        <Suspense fallback={<BlogsLoading />}>
            <BlogsClient />
        </Suspense>
    </div>
  );
}
</file>

<file path="src/app/admin/contacts/actions.ts">
'use server';

import { createSupabaseAdminClient } from '@/lib/supabase/admin';
import { contactSchema } from './schema';
import { revalidatePath } from 'next/cache';
import { Contact } from '@/lib/types';

export async function getContacts() {
  const supabase = createSupabaseAdminClient();
  const { data, error } = await supabase
    .from('contacts')
    .select('*')
    .order('name', { ascending: true });

  if (error) {
    throw new Error(error.message);
  }

  return data as Contact[];
}

export async function upsertContact(values: unknown, contactId?: string) {
  const supabase = createSupabaseAdminClient();
  const parsedValues = contactSchema.safeParse(values);

  if (!parsedValues.success) {
    return { error: parsedValues.error.message };
  }

  const { data, error } = await supabase
    .from('contacts')
    .upsert(contactId ? { ...parsedValues.data, id: contactId } : parsedValues.data)
    .select('*')
    .single();

  if (error) {
    return { error: `Database error: ${error.message}` };
  }

  revalidatePath('/admin/contacts');
  revalidatePath(`/admin/contacts/${(data as Contact).id}`);

  return {
    data: data,
    message: `Contact ${contactId ? 'updated' : 'created'} successfully!`,
  };
}

export async function deleteContact(contactId: string) {
  const supabase = createSupabaseAdminClient();
  const { error } = await supabase.from('contacts').delete().eq('id', contactId);

  if (error) {
    return { error: `Database error: ${error.message}` };
  }

  revalidatePath('/admin/contacts');

  return {
    message: 'Contact deleted successfully!',
  };
}
</file>

<file path="src/app/admin/contacts/page.tsx">
import { Suspense } from 'react';
import ContactsClient from './ContactsClient';
import ContactsLoading from './loading';
import { Button } from '@/components/ui/button';
import Link from 'next/link';
import { PlusCircle } from 'lucide-react';

export const metadata = {
    title: 'Contacts | Bilacert Admin Pro',
    description: 'Manage your contacts.',
};

export default function ContactsPage() {
  return (
    <div className="space-y-6">
        <div className="flex items-center justify-between">
            <h1 className="text-3xl font-bold tracking-tight">Contacts</h1>
        </div>
        <Suspense fallback={<ContactsLoading />}>
            <ContactsClient />
        </Suspense>
    </div>
  );
}
</file>

<file path="src/app/admin/contacts/schema.ts">
import * as z from 'zod';

export const contactSchema = z.object({
  name: z.string().min(1, 'Name is required'),
  email: z.string().email('Please enter a valid email'),
  phone: z.string().optional(),
  service: z.string().optional(),
  message: z.string().optional(),
});
</file>

<file path="src/app/admin/dashboard/loading.tsx">
import { Skeleton } from "@/components/ui/skeleton"
import { Card, CardContent, CardHeader } from "@/components/ui/card"

export default function DashboardLoading() {
  return (
    <div className="space-y-8">
      <div className="grid gap-4 md:grid-cols-2 lg:grid-cols-4">
        <Card>
          <CardHeader className="flex flex-row items-center justify-between space-y-0 pb-2">
            <Skeleton className="h-4 w-24" />
            <Skeleton className="h-4 w-4" />
          </CardHeader>
          <CardContent>
            <Skeleton className="h-8 w-16" />
            <Skeleton className="mt-2 h-3 w-32" />
          </CardContent>
        </Card>
        <Card>
          <CardHeader className="flex flex-row items-center justify-between space-y-0 pb-2">
            <Skeleton className="h-4 w-28" />
            <Skeleton className="h-4 w-4" />
          </CardHeader>
          <CardContent>
            <Skeleton className="h-8 w-12" />
            <Skeleton className="mt-2 h-3 w-24" />
          </CardContent>
        </Card>
        <Card>
          <CardHeader className="flex flex-row items-center justify-between space-y-0 pb-2">
            <Skeleton className="h-4 w-20" />
            <Skeleton className="h-4 w-4" />
          </CardHeader>
          <CardContent>
            <Skeleton className="h-8 w-14" />
          </CardContent>
        </Card>
        <Card>
          <CardHeader className="flex flex-row items-center justify-between space-y-0 pb-2">
            <Skeleton className="h-4 w-32" />
            <Skeleton className="h-4 w-4" />
          </CardHeader>
          <CardContent>
            <Skeleton className="h-8 w-24" />
            <Skeleton className="mt-2 h-3 w-40" />
          </CardContent>
        </Card>
      </div>
      <div className="grid gap-8 md:grid-cols-2">
        <Card>
          <CardHeader>
            <Skeleton className="h-6 w-3/4" />
          </CardHeader>
          <CardContent>
            <Skeleton className="h-[300px] w-full" />
          </CardContent>
        </Card>
        <Card>
          <CardHeader>
            <Skeleton className="h-6 w-3/4" />
          </CardHeader>
          <CardContent>
            <Skeleton className="h-[300px] w-full" />
          </CardContent>
        </Card>
      </div>
    </div>
  )
}
</file>

<file path="src/app/admin/dashboard/page.tsx">
import { Suspense } from 'react';
import DashboardClient from './DashboardClient';
import DashboardLoading from './loading';

export const metadata = {
  title: 'Dashboard | Bilacert Admin Pro',
  description: 'Real-time overview of submissions and metrics.',
};

export default function DashboardPage() {
  return (
    <Suspense fallback={<DashboardLoading />}>
      <DashboardClient />
    </Suspense>
  );
}
</file>

<file path="src/app/admin/form_submissions/actions.ts">
'use server';

import { createSupabaseAdminClient } from '@/lib/supabase/admin';
import { submissionSchema } from './schema';
import { revalidatePath } from 'next/cache';
import { Submission } from '@/lib/types';

export async function upsertSubmission(values: unknown, submissionId: string) {
  const supabase = createSupabaseAdminClient();
  const parsedValues = submissionSchema.safeParse(values);

  if (!parsedValues.success) {
    return { error: parsedValues.error.message };
  }
  
  const submissionData = {
    full_name: parsedValues.data.fullName,
    email: parsedValues.data.email,
    phone: parsedValues.data.phone,
    company: parsedValues.data.company,
    industry: parsedValues.data.industry,
    service_name: parsedValues.data.serviceName,
    status: parsedValues.data.status,
    details: parsedValues.data.details ? JSON.parse(parsedValues.data.details) : null,
    internal_notes: parsedValues.data.internalNotes,
    assigned_to: parsedValues.data.assignedTo || null,
    updated_at: new Date().toISOString(),
  };

  const { data, error } = await supabase
    .from('form_submissions')
    .update(submissionData)
    .eq('id', submissionId)
    .select('*')
    .single();

  if (error) {
    return { error: `Database error: ${error.message}` };
  }

  revalidatePath('/admin/form_submissions');
  revalidatePath(`/admin/form_submissions/${(data as Submission).id}`);

  return {
    data: data,
    message: `Submission updated successfully!`,
  };
}

export async function updateSubmissionStatus(submissionId: string, status: Submission['status']) {
    const supabase = createSupabaseAdminClient();

    const { data, error } = await supabase
        .from('form_submissions')
        .update({ status: status, updated_at: new Date().toISOString() })
        .eq('id', submissionId)
        .select('*')
        .single();

    if (error) {
        return { error: `Database error: ${error.message}` };
    }

    revalidatePath('/admin/form_submissions');
    revalidatePath(`/admin/form_submissions/${(data as Submission).id}`);

    return {
        data: data,
        message: 'Status updated successfully',
    };
}
</file>

<file path="src/app/admin/form_submissions/columns.tsx">
"use client"

import { ColumnDef } from "@tanstack/react-table"
import { Submission } from "@/lib/types"
import { format } from "date-fns"
import { ArrowUpDown, MoreHorizontal } from "lucide-react"
import { Button } from "@/components/ui/button"
import {
  DropdownMenu,
  DropdownMenuContent,
  DropdownMenuItem,
  DropdownMenuLabel,
  DropdownMenuSeparator,
  DropdownMenuTrigger,
} from "@/components/ui/dropdown-menu"
import Link from 'next/link';
import StatusUpdate from "./StatusUpdate"

export const statusVariantMap: { [key: string]: "default" | "secondary" | "destructive" | "outline" } = {
    pending: "secondary",
    'in-progress': "outline",
    completed: "default",
    rejected: "destructive",
    archived: "secondary"
}

interface ColumnsOptions {
    onDelete: (submission: Submission) => void;
}


export const columns = ({ onDelete }: ColumnsOptions): ColumnDef<Submission>[] => [
  {
    accessorKey: "formType",
    header: "Form Type",
  },
  {
    accessorKey: "serviceName",
    header: "Service Name",
  },
  {
    accessorKey: "fullName",
    header: "Client Name",
  },
  {
    accessorKey: "email",
    header: "Client Email",
  },
  {
    accessorKey: "createdAt",
    header: ({ column }) => {
        return (
          <Button
            variant="ghost"
            onClick={() => column.toggleSorting(column.getIsSorted() === "asc")}
          >
            Submitted At
            <ArrowUpDown className="ml-2 h-4 w-4" />
          </Button>
        )
      },
    cell: ({ row }) => {
        const date = row.getValue("createdAt") as string;
        if (!date) return "N/A";
        const formattedDate = format(new Date(date), "PPpp");
        return <div className="font-medium">{formattedDate}</div>
    }
  },
  {
    accessorKey: "status",
    header: "Status",
    cell: ({ row }) => {
        return <StatusUpdate submission={row.original} />
    }
  },
  {
    id: "actions",
    cell: ({ row }) => {
      const submission = row.original
 
      return (
        <DropdownMenu>
          <DropdownMenuTrigger asChild>
            <Button variant="ghost" className="h-8 w-8 p-0">
              <span className="sr-only">Open menu</span>
              <MoreHorizontal className="h-4 w-4" />
            </Button>
          </DropdownMenuTrigger>
          <DropdownMenuContent align="end">
            <DropdownMenuLabel>Actions</DropdownMenuLabel>
            <DropdownMenuItem asChild>
                <Link href={`/admin/form_submissions/${submission.id}`}>View Details</Link>
            </DropdownMenuItem>
             <DropdownMenuItem asChild>
                <Link href={`/admin/form_submissions/${submission.id}/edit`}>Edit</Link>
            </DropdownMenuItem>
            <DropdownMenuSeparator />
            <DropdownMenuItem
                className="text-destructive focus:bg-destructive/10 focus:text-destructive"
                onClick={() => onDelete(submission)}
            >
                Delete
            </DropdownMenuItem>
          </DropdownMenuContent>
        </DropdownMenu>
      )
    },
  },
]
</file>

<file path="src/app/admin/form_submissions/page.tsx">
import { Suspense } from 'react';
import SubmissionsClient from './SubmissionsClient';
import { Card, CardContent, CardHeader, CardTitle } from '@/components/ui/card';
import { Skeleton } from '@/components/ui/skeleton';

export const metadata = {
    title: 'Form Submissions | Bilacert Admin Pro',
    description: 'View and manage all form submissions.',
};

function SubmissionsLoading() {
    return (
        <Card>
            <CardHeader>
                <CardTitle>All Submissions</CardTitle>
            </CardHeader>
            <CardContent>
                <div className="space-y-4">
                    <Skeleton className="h-10 w-full" />
                    <Skeleton className="h-10 w-full" />
                    <Skeleton className="h-10 w-full" />
                    <Skeleton className="h-10 w-full" />
                </div>
            </CardContent>
        </Card>
    )
}

export default function FormSubmissionsPage() {
  return (
    <div className="space-y-6">
        <h1 className="text-3xl font-bold tracking-tight">Form Submissions</h1>
        <Suspense fallback={<SubmissionsLoading />}>
            <SubmissionsClient />
        </Suspense>
    </div>
  );
}
</file>

<file path="src/app/admin/form_submissions/schema.ts">
import * as z from 'zod';

export const submissionSchema = z.object({
  fullName: z.string().min(1, 'Full name is required'),
  email: z.string().email(),
  phone: z.string().optional(),
  company: z.string().optional(),
  industry: z.string().optional(),
  serviceName: z.string().optional(),
  status: z.enum(['pending', 'in-progress', 'completed', 'rejected', 'archived']),
  details: z.string().optional().refine((val) => {
    if (!val || val.trim() === '') return true;
    try {
      JSON.parse(val);
      return true;
    } catch (e) {
      return false;
    }
  }, { message: 'Details must be a valid JSON object.' }),
  internalNotes: z.string().optional(),
  assignedTo: z.string().optional(),
});
</file>

<file path="src/app/admin/form_submissions/StatusUpdate.tsx">
'use client';

import { useState } from 'react';
import {
  Select,
  SelectContent,
  SelectItem,
  SelectTrigger,
  SelectValue,
} from '@/components/ui/select';
import { Badge } from '@/components/ui/badge';
import { useToast } from '@/hooks/use-toast';
import type { Submission } from '@/lib/types';
import { statusVariantMap } from './columns';
import { Loader2 } from 'lucide-react';
import { updateSubmissionStatus } from './actions';

interface StatusUpdateProps {
  submission: Submission;
}

const statuses: Submission['status'][] = ['pending', 'in-progress', 'completed', 'rejected', 'archived'];

export default function StatusUpdate({ submission }: StatusUpdateProps) {
  const { toast } = useToast();
  const [currentStatus, setCurrentStatus] = useState(submission.status);
  const [isLoading, setIsLoading] = useState(false);

  const handleStatusChange = async (newStatus: Submission['status']) => {
    if (newStatus === currentStatus) return;

    setIsLoading(true);
    try {
      const result = await updateSubmissionStatus(submission.id, newStatus);

      if (result.error) throw new Error(result.error);

      setCurrentStatus(newStatus as Submission['status']);
      toast({
        title: 'Status updated',
        description: `Submission status changed to "${newStatus}".`,
      });
    } catch (error: any) {
      toast({
        variant: 'destructive',
        title: 'Error updating status',
        description: error.message,
      });
    } finally {
      setIsLoading(false);
    }
  };

  return (
    <div className="flex items-center gap-2">
      {isLoading && <Loader2 className="h-4 w-4 animate-spin" />}
      <Select value={currentStatus} onValueChange={handleStatusChange} disabled={isLoading}>
        <SelectTrigger className="w-[180px]">
          <SelectValue asChild>
             <Badge variant={statusVariantMap[currentStatus] || 'default'} className="capitalize">{currentStatus}</Badge>
          </SelectValue>
        </SelectTrigger>
        <SelectContent>
          {statuses.map((status) => (
            <SelectItem key={status} value={status} className="capitalize">
              <div className="flex items-center gap-2">
                {status}
              </div>
            </SelectItem>
          ))}
        </SelectContent>
      </Select>
    </div>
  );
}
</file>

<file path="src/app/admin/form_submissions/SubmissionsClient.tsx">
'use client';

import { useState } from 'react';
import { useSubmissions } from '@/hooks/useSubmissions';
import { Card, CardContent, CardHeader, CardTitle } from '@/components/ui/card';
import { columns } from './columns';
import { Submission } from '@/lib/types';
import { DataTable } from './data-table';
import DeleteSubmissionDialog from './DeleteSubmissionDialog';

export default function SubmissionsClient() {
  const { submissions, loading, error } = useSubmissions();
  const [isDeleteDialogOpen, setIsDeleteDialogOpen] = useState(false);
  const [selectedSubmission, setSelectedSubmission] = useState<Submission | null>(null);

  const handleDelete = (submission: Submission) => {
    setSelectedSubmission(submission);
    setIsDeleteDialogOpen(true);
  };

  const handleCloseDialogs = () => {
    setIsDeleteDialogOpen(false);
    setSelectedSubmission(null);
  };

  if (error) {
    return <div className="text-destructive">Error loading submissions: {error.message}</div>;
  }

  return (
    <>
      <Card>
        <CardHeader>
          <CardTitle>All Submissions</CardTitle>
        </CardHeader>
        <CardContent>
          <DataTable columns={columns({ onDelete: handleDelete })} data={submissions as Submission[]} isLoading={loading} />
        </CardContent>
      </Card>
      
      {isDeleteDialogOpen && (
        <DeleteSubmissionDialog
            isOpen={isDeleteDialogOpen}
            onClose={handleCloseDialogs}
            submission={selectedSubmission}
        />
      )}
    </>
  );
}
</file>

<file path="src/app/admin/login/page.tsx">
'use client';

import { useState } from 'react';
import { supabase, isSupabaseConfigured } from '@/lib/supabase/supabase';
import { Button } from '@/components/ui/button';
import {
  Card,
  CardContent,
  CardDescription,
  CardFooter,
  CardHeader,
  CardTitle,
} from '@/components/ui/card';
import { Input } from '@/components/ui/input';
import { Label } from '@/components/ui/label';
import { Logo } from '@/components/icons';
import { Loader2 } from 'lucide-react';
import Link from 'next/link';
import { useToast } from '@/hooks/use-toast';
import { useRouter } from 'next/navigation';
import SupabaseNotConfigured from '@/components/admin/SupabaseNotConfigured';

export default function LoginPage() {
  const { toast } = useToast();
  const router = useRouter();
  const [email, setEmail] = useState('');
  const [password, setPassword] = useState('');
  const [isLoading, setIsLoading] = useState(false);
  const [error, setError] = useState('');

  if (!isSupabaseConfigured) {
    return <SupabaseNotConfigured />;
  }

  const handleLogin = async (e: React.FormEvent) => {
    e.preventDefault();
    setIsLoading(true);
    setError('');
    const { error } = await supabase.auth.signInWithPassword({
      email,
      password,
    });

    if (error) {
      setError('Failed to log in. Please check your credentials.');
      toast({
        variant: 'destructive',
        title: 'Login Failed',
        description: error.message || 'Please check your credentials.',
      });
    } else {
      router.push('/admin/dashboard');
    }
    setIsLoading(false);
  };

  return (
    <div className="flex min-h-screen w-full items-center justify-center bg-background p-4">
      <Card className="w-full max-w-sm">
        <CardHeader className="text-center">
          <div className="mx-auto mb-4 flex h-16 w-16 items-center justify-center rounded-full bg-primary/10">
            <Logo className="h-8 w-8 text-primary" />
          </div>
          <CardTitle className="text-2xl font-bold">
            Bilacert Admin Pro
          </CardTitle>
          <CardDescription>
            Enter your credentials to access the dashboard
          </CardDescription>
        </CardHeader>
        <CardContent>
          <form onSubmit={handleLogin} className="space-y-4">
            <div className="space-y-2">
              <Label htmlFor="email">Email</Label>
              <Input
                id="email"
                type="email"
                placeholder="admin@example.com"
                required
                value={email}
                onChange={(e) => setEmail(e.target.value)}
                disabled={isLoading}
              />
            </div>
            <div className="space-y-2">
              <Label htmlFor="password">Password</Label>
              <Input
                id="password"
                type="password"
                required
                value={password}
                onChange={(e) => setPassword(e.target.value)}
                disabled={isLoading}
              />
            </div>
            {error && <p className="text-sm text-destructive">{error}</p>}
            <Button type="submit" className="w-full" disabled={isLoading}>
              {isLoading ? (
                <Loader2 className="mr-2 h-4 w-4 animate-spin" />
              ) : (
                'Log In'
              )}
            </Button>
          </form>
        </CardContent>
        <CardFooter className="flex justify-center text-sm">
          <Link href="#" className="text-primary hover:underline">
            Forgot your password?
          </Link>
        </CardFooter>
      </Card>
    </div>
  );
}
</file>

<file path="src/app/admin/services/new/page.tsx">
import ServiceForm from '../ServiceForm';
import { Card, CardContent, CardHeader, CardTitle, CardDescription } from '@/components/ui/card';
import Link from 'next/link';
import { Button } from '@/components/ui/button';
import { ArrowLeft } from 'lucide-react';

export const metadata = {
    title: 'New Service | Bilacert Admin Pro',
    description: 'Add a new regulatory service.',
};

export default function NewServicePage() {
    return (
        <div className="space-y-6">
            <Button variant="outline" asChild>
                <Link href="/admin/services">
                    <ArrowLeft className="mr-2 h-4 w-4" />
                    Back to Services
                </Link>
            </Button>
            <Card>
                <CardHeader>
                    <CardTitle>Add New Service</CardTitle>
                    <CardDescription>Fill out the form below to create a new service.</CardDescription>
                </CardHeader>
                <CardContent>
                    <ServiceForm />
                </CardContent>
            </Card>
        </div>
    );
}
</file>

<file path="src/app/admin/services/actions.ts">
'use server';

import { createSupabaseAdminClient } from '@/lib/supabase/admin';
import { serviceSchema } from './schema';
import { revalidatePath } from 'next/cache';
import { Service } from '@/lib/types';

export async function upsertService(values: unknown, serviceId?: string) {
  const supabase = createSupabaseAdminClient();
  const parsedValues = serviceSchema.safeParse(values);

  if (!parsedValues.success) {
    return { error: parsedValues.error.message };
  }
  
  const transformStringToArray = (str?: string) => str ? str.split('\n').map(s => s.trim()).filter(Boolean) : [];

  const serviceData: any = {
    title: parsedValues.data.title,
    slug: parsedValues.data.slug,
    href: parsedValues.data.href,
    category: parsedValues.data.category,
    description: parsedValues.data.description,
    short_description: parsedValues.data.short_description,
    icon: parsedValues.data.icon,
    order_index: parsedValues.data.order_index,
    content: parsedValues.data.content,
    features: transformStringToArray(parsedValues.data.features),
    requirements: transformStringToArray(parsedValues.data.requirements),
    includes: transformStringToArray(parsedValues.data.includes),
    published: parsedValues.data.published,
    featured: parsedValues.data.featured,
    processing_time: parsedValues.data.processing_time,
    pricing: parsedValues.data.pricing,
    image: parsedValues.data.image,
    thumbnail: parsedValues.data.thumbnail,
    seo_title: parsedValues.data.seo_title,
    seo_description: parsedValues.data.seo_description,
    seo_keywords: parsedValues.data.seo_keywords,
    pricing_plans: parsedValues.data.pricing_plans.map(p => ({ ...p, features: transformStringToArray(p.features) })),
    process_steps: parsedValues.data.process_steps,
    success_story: parsedValues.data.success_story,
    updated_at: new Date().toISOString(),
  };

  const { data, error } = await supabase
    .from('services')
    .upsert(serviceId ? { ...serviceData, id: serviceId } : { ...serviceData, created_at: new Date().toISOString() })
    .select('*')
    .single();

  if (error) {
    return { error: `Database error: ${error.message}` };
  }

  revalidatePath('/admin/services');
  revalidatePath(`/admin/services/${(data as Service).id}`);
  revalidatePath(`/services/${(data as Service).slug}`);

  return {
    data: data,
    message: `Service ${serviceId ? 'updated' : 'created'} successfully!`,
  };
}
</file>

<file path="src/app/admin/services/page.tsx">
import { Suspense } from 'react';
import ServicesClient from './ServicesClient';
import ServicesLoading from './loading';

export const metadata = {
    title: 'Services | Bilacert Admin Pro',
    description: 'Manage regulatory services.',
};

export default function ServicesPage() {
  return (
    <Suspense fallback={<ServicesLoading />}>
        <ServicesClient />
    </Suspense>
  );
}
</file>

<file path="src/app/admin/services/schema.ts">
import * as z from 'zod';

const pricingPlanSchema = z.object({
    title: z.string().min(1, 'Title is required'),
    description: z.string().default(''),
    price: z.string().min(1, 'Price is required'),
    features: z.string().default(''),
    popular: z.boolean().default(false),
});

const processStepSchema = z.object({
    step: z.string().min(1, 'Step number is required'),
    title: z.string().min(1, 'Title is required'),
    description: z.string().min(1, 'Description is required'),
});

const successStorySchema = z.object({
    scenario: z.string().optional(),
    challenge: z.string().optional(),
    solution: z.string().optional(),
    result: z.string().optional(),
});

export const serviceSchema = z.object({
  title: z.string().min(1, 'Title is required'),
  slug: z.string().min(1, 'Slug is required'),
  href: z.string().min(1, 'URL (href) is required').refine(val => val.startsWith('/'), { message: 'Href must start with /' }),
  category: z.string().min(1, 'Category is required'),
  description: z.string().min(1, 'Description is required'),
  short_description: z.string().optional(),
  icon: z.string().optional(),
  order_index: z.coerce.number().optional(),
  content: z.string().optional(),
  features: z.string().optional(),
  requirements: z.string().optional(),
  includes: z.string().optional(),
  published: z.boolean().default(false),
  featured: z.boolean().default(false),
  processing_time: z.string().optional(),
  pricing: z.coerce.number().optional(),
  image: z.string().optional(),
  thumbnail: z.string().optional(),
  seo_title: z.string().optional(),
  seo_description: z.string().optional(),
  seo_keywords: z.string().optional(),
  pricing_plans: z.array(pricingPlanSchema).default([]),
  process_steps: z.array(processStepSchema).default([]),
  success_story: successStorySchema.optional(),
});

export type ServiceFormValues = z.infer<typeof serviceSchema>;
</file>

<file path="src/app/admin/services/ServiceForm.tsx">
'use client';

import { useForm, useFieldArray } from 'react-hook-form';
import { zodResolver } from '@hookform/resolvers/zod';
import { Button } from '@/components/ui/button';
import {
  Form,
  FormControl,
  FormDescription,
  FormField,
  FormItem,
  FormLabel,
  FormMessage,
} from '@/components/ui/form';
import { Input } from '@/components/ui/input';
import { useToast } from '@/hooks/use-toast';
import type { Service } from '@/lib/types';
import { useEffect } from 'react';
import { Loader2, PlusCircle, Trash2 } from 'lucide-react';
import { Textarea } from '@/components/ui/textarea';
import { useRouter } from 'next/navigation';
import Link from 'next/link';
import { Switch } from '@/components/ui/switch';
import ImageUpload from '@/components/ui/ImageUpload';
import { Card, CardContent, CardHeader, CardTitle } from '@/components/ui/card';
import { serviceSchema, ServiceFormValues } from './schema';
import { upsertService } from './actions';

interface ServiceFormProps {
  service?: Service | null;
}

const slugify = (str: string) =>
  str
    .toLowerCase()
    .trim()
    .replace(/[^\w\s-]/g, '')
    .replace(/[\s_-]+/g, '-')
    .replace(/^-+|-+$/g, '');

export default function ServiceForm({ service }: ServiceFormProps) {
  const { toast } = useToast();
  const router = useRouter();
  const isEditing = !!service;

  const form = useForm<ServiceFormValues>({
    resolver: zodResolver(serviceSchema),
    defaultValues: {
      title: '', slug: '', href: '', category: '', description: '',
      short_description: '', icon: '', order_index: 0, content: '',
      features: '', requirements: '', includes: '',
      published: false, featured: false, processing_time: '', pricing: 0,
      image: '', thumbnail: '', seo_title: '', seo_description: '', seo_keywords: '',
      pricing_plans: [
          { title: 'Basic', description: '', price: '', features: '', popular: false },
          { title: 'Standard', description: '', price: '', features: '', popular: true },
          { title: 'Premium', description: '', price: '', features: '', popular: false },
      ],
      process_steps: [],
      success_story: { scenario: '', challenge: '', solution: '', result: '' },
    },
  });

  const {
    handleSubmit,
    control,
    reset,
    watch,
    setValue,
    formState: { isSubmitting },
  } = form;

  const { fields: processStepFields, append: appendProcessStep, remove: removeProcessStep } = useFieldArray({
    control,
    name: 'process_steps'
  });
  
  const { fields: pricingPlanFields } = useFieldArray({
    control,
    name: "pricing_plans"
  });

  const title = watch('title');

  useEffect(() => {
    if (!isEditing && title) {
      const slug = slugify(title);
      setValue('slug', slug);
      setValue('href', `/services/${slug}`);
    }
  }, [title, setValue, isEditing]);

  useEffect(() => {
    if (service) {
      const defaultPricingPlans = [
        { title: 'Basic', description: '', price: '', features: '', popular: false },
        { title: 'Standard', description: '', price: '', features: '', popular: true },
        { title: 'Premium', description: '', price: '', features: '', popular: false },
      ];
      
      const servicePricingPlans = (service.pricing_plans || []).map(p => ({
        ...p,
        features: Array.isArray(p.features) ? p.features.join('\n') : p.features || '',
      }));
      
      const populatedPlans = defaultPricingPlans.map((defaultPlan, index) => {
          return servicePricingPlans[index] || defaultPlan;
      });

      reset({
        title: service.title || '',
        slug: service.slug || '',
        href: service.href || '',
        category: service.category || '',
        description: service.description || '',
        short_description: service.short_description || '',
        icon: service.icon || '',
        order_index: service.order_index || 0,
        content: service.content || '',
        features: Array.isArray(service.features) ? service.features.join('\n') : '',
        requirements: Array.isArray(service.requirements) ? service.requirements.join('\n') : '',
        includes: Array.isArray(service.includes) ? service.includes.join('\n') : '',
        published: service.published || false,
        featured: service.featured || false,
        processing_time: service.processing_time || '',
        pricing: service.pricing || 0,
        image: service.image || '',
        thumbnail: service.thumbnail || '',
        seo_title: service.seo_title || '',
        seo_description: service.seo_description || '',
        seo_keywords: service.seo_keywords || '',
        pricing_plans: populatedPlans,
        process_steps: service.process_steps || [],
        success_story: service.success_story || { scenario: '', challenge: '', solution: '', result: '' },
      });
    }
  }, [service, reset]);

  const onSubmit = async (values: ServiceFormValues) => {
    try {
      const { error, message } = await upsertService(values, service?.id);

      if (error) {
        throw new Error(error);
      }

      toast({
        title: message,
      });
      router.push('/admin/services');
      router.refresh();
    } catch (error: any) {
      toast({
        variant: 'destructive',
        title: 'Error saving service',
        description: error.message,
      });
    }
  };

  return (
    <Form {...form}>
      <form onSubmit={handleSubmit(onSubmit)} className="space-y-8">
        <div className="grid grid-cols-1 gap-8 lg:grid-cols-3">
          <div className="space-y-6 lg:col-span-2">
            
            <Card>
              <CardHeader><CardTitle>Core Details</CardTitle></CardHeader>
              <CardContent className="space-y-4">
                <FormField control={form.control} name="title" render={({ field }) => ( <FormItem><FormLabel>Title</FormLabel><FormControl><Input {...field} /></FormControl><FormMessage /></FormItem> )} />
                <FormField control={form.control} name="slug" render={({ field }) => ( <FormItem><FormLabel>Slug</FormLabel><FormControl><Input {...field} /></FormControl><FormMessage /></FormItem> )} />
                <FormField control={form.control} name="href" render={({ field }) => ( <FormItem><FormLabel>URL (href)</FormLabel><FormControl><Input {...field} /></FormControl><FormMessage /></FormItem> )} />
                <FormField control={form.control} name="description" render={({ field }) => ( <FormItem><FormLabel>Description</FormLabel><FormControl><Textarea {...field} /></FormControl><FormMessage /></FormItem> )} />
                <FormField control={form.control} name="short_description" render={({ field }) => ( <FormItem><FormLabel>Short Description</FormLabel><FormControl><Textarea {...field} /></FormControl><FormMessage /></FormItem> )} />
                <FormField control={form.control} name="content" render={({ field }) => ( <FormItem><FormLabel>Content</FormLabel><FormControl><Textarea rows={5} {...field} /></FormControl><FormMessage /></FormItem> )} />
              </CardContent>
            </Card>

            <Card>
                <CardHeader><CardTitle>Features & Requirements</CardTitle></CardHeader>
                <CardContent className="space-y-4">
                    <FormField control={form.control} name="features" render={({ field }) => (<FormItem><FormLabel>Features (one per line)</FormLabel><FormControl><Textarea {...field} /></FormControl><FormMessage /></FormItem>)} />
                    <FormField control={form.control} name="requirements" render={({ field }) => (<FormItem><FormLabel>Requirements (one per line)</FormLabel><FormControl><Textarea {...field} /></FormControl><FormMessage /></FormItem>)} />
                    <FormField control={form.control} name="includes" render={({ field }) => (<FormItem><FormLabel>What's Included (one per line)</FormLabel><FormControl><Textarea {...field} /></FormControl><FormMessage /></FormItem>)} />
                </CardContent>
            </Card>

            <Card>
                <CardHeader><CardTitle>Pricing Plans</CardTitle></CardHeader>
                <CardContent className="space-y-4">
                <div className="grid grid-cols-1 gap-6">
                    {pricingPlanFields.map((field, index) => (
                    <Card key={field.id} className="bg-muted/30">
                        <CardHeader>
                            <CardTitle className="text-lg">{`Plan ${index + 1}`}</CardTitle>
                        </CardHeader>
                        <CardContent className="space-y-4">
                          <FormField control={form.control} name={`pricing_plans.${index}.title`} render={({ field }) => (<FormItem><FormLabel>Plan Title</FormLabel><FormControl><Input {...field} /></FormControl><FormMessage /></FormItem>)} />
                          <FormField control={form.control} name={`pricing_plans.${index}.description`} render={({ field }) => (<FormItem><FormLabel>Plan Description</FormLabel><FormControl><Input {...field} /></FormControl><FormMessage /></FormItem>)} />
                          <FormField control={form.control} name={`pricing_plans.${index}.price`} render={({ field }) => (<FormItem><FormLabel>Price</FormLabel><FormControl><Input {...field} /></FormControl><FormMessage /></FormItem>)} />
                          <FormField control={form.control} name={`pricing_plans.${index}.features`} render={({ field }) => (<FormItem><FormLabel>Features (one per line)</FormLabel><FormControl><Textarea {...field} /></FormControl><FormMessage /></FormItem>)} />
                          <FormField
                            control={form.control}
                            name={`pricing_plans.${index}.popular`}
                            render={({ field }) => (
                                <FormItem className="flex flex-row items-center justify-between rounded-lg border bg-card p-4">
                                    <div className="space-y-0.5">
                                        <FormLabel className="text-base">Most Popular</FormLabel>
                                        <FormDescription>Highlight this plan.</FormDescription>
                                    </div>
                                    <FormControl>
                                        <Switch checked={field.value} onCheckedChange={field.onChange} />
                                    </FormControl>
                                </FormItem>
                            )}
                            />
                        </CardContent>
                    </Card>
                    ))}
                </div>
                </CardContent>
            </Card>

             <Card>
                <CardHeader><CardTitle>Process Steps</CardTitle></CardHeader>
                <CardContent className="space-y-4">
                    {processStepFields.map((field, index) => (
                        <div key={field.id} className="flex items-start gap-4 p-4 border rounded-md">
                            <div className="grid gap-2 flex-grow">
                                 <FormField control={form.control} name={`process_steps.${index}.step`} render={({ field }) => (<FormItem><FormLabel>Step Number</FormLabel><FormControl><Input {...field} /></FormControl><FormMessage /></FormItem>)} />
                                <FormField control={form.control} name={`process_steps.${index}.title`} render={({ field }) => (<FormItem><FormLabel>Step Title</FormLabel><FormControl><Input {...field} /></FormControl><FormMessage /></FormItem>)} />
                                <FormField control={form.control} name={`process_steps.${index}.description`} render={({ field }) => (<FormItem><FormLabel>Step Description</FormLabel><FormControl><Textarea {...field} rows={2} /></FormControl><FormMessage /></FormItem>)} />
                            </div>
                            <Button type="button" variant="destructive" size="icon" onClick={() => removeProcessStep(index)} className="mt-7"><Trash2 className="h-4 w-4" /></Button>
                        </div>
                    ))}
                     <Button type="button" variant="outline" onClick={() => appendProcessStep({ step: `${processStepFields.length + 1}`, title: '', description: '' })}><PlusCircle className="mr-2 h-4 w-4" /> Add Step</Button>
                </CardContent>
            </Card>

            <Card>
                <CardHeader><CardTitle>Success Story</CardTitle></CardHeader>
                <CardContent className="space-y-4">
                     <FormField control={form.control} name="success_story.scenario" render={({ field }) => (<FormItem><FormLabel>Scenario</FormLabel><FormControl><Textarea {...field} value={field.value ?? ''} /></FormControl></FormItem>)} />
                    <FormField control={form.control} name="success_story.challenge" render={({ field }) => (<FormItem><FormLabel>Challenge</FormLabel><FormControl><Textarea {...field} value={field.value ?? ''} /></FormControl></FormItem>)} />
                    <FormField control={form.control} name="success_story.solution" render={({ field }) => (<FormItem><FormLabel>Solution</FormLabel><FormControl><Textarea {...field} value={field.value ?? ''} /></FormControl></FormItem>)} />
                    <FormField control={form.control} name="success_story.result" render={({ field }) => (<FormItem><FormLabel>Result</FormLabel><FormControl><Textarea {...field} value={field.value ?? ''} /></FormControl></FormItem>)} />
                </CardContent>
            </Card>

          </div>
          <div className="space-y-6 lg:col-span-1">
             <Card>
                <CardHeader><CardTitle>Publishing</CardTitle></CardHeader>
                <CardContent className="space-y-4">
                    <FormField control={form.control} name="published" render={({ field }) => ( <FormItem className="flex flex-row items-center justify-between rounded-lg border p-4"><div className="space-y-0.5"><FormLabel>Published</FormLabel><FormDescription>Make this service visible on the site.</FormDescription></div><FormControl><Switch checked={field.value} onCheckedChange={field.onChange} /></FormControl></FormItem> )}/>
                    <FormField control={form.control} name="featured" render={({ field }) => ( <FormItem className="flex flex-row items-center justify-between rounded-lg border p-4"><div className="space-y-0.5"><FormLabel>Featured</FormLabel><FormDescription>Feature this service on the homepage.</FormDescription></div><FormControl><Switch checked={field.value} onCheckedChange={field.onChange} /></FormControl></FormItem> )}/>
                </CardContent>
            </Card>
            <Card>
                <CardHeader><CardTitle>Details</CardTitle></CardHeader>
                <CardContent className="space-y-4">
                    <FormField control={form.control} name="category" render={({ field }) => ( <FormItem><FormLabel>Category</FormLabel><FormControl><Input {...field} /></FormControl><FormMessage /></FormItem> )}/>
                    <FormField control={form.control} name="icon" render={({ field }) => ( <FormItem><FormLabel>Icon</FormLabel><FormControl><Input {...field} placeholder="e.g., Shield" /></FormControl><FormMessage /></FormItem> )}/>
                    <FormField control={form.control} name="order_index" render={({ field }) => ( <FormItem><FormLabel>Order Index</FormLabel><FormControl><Input type="number" {...field} /></FormControl><FormMessage /></FormItem> )}/>
                    <FormField control={form.control} name="processing_time" render={({ field }) => ( <FormItem><FormLabel>Processing Time</FormLabel><FormControl><Input {...field} /></FormControl><FormMessage /></FormItem> )}/>
                    <FormField control={form.control} name="pricing" render={({ field }) => ( <FormItem><FormLabel>Price (ZAR)</FormLabel><FormControl><Input type="number" step="0.01" {...field} /></FormControl><FormMessage /></FormItem> )}/>
                </CardContent>
            </Card>

             <Card>
                <CardHeader><CardTitle>SEO</CardTitle></CardHeader>
                <CardContent className="space-y-4">
                    <FormField control={form.control} name="seo_title" render={({ field }) => ( <FormItem><FormLabel>SEO Title</FormLabel><FormControl><Input {...field} /></FormControl><FormMessage /></FormItem> )}/>
                    <FormField control={form.control} name="seo_description" render={({ field }) => ( <FormItem><FormLabel>SEO Description</FormLabel><FormControl><Textarea {...field} /></FormControl><FormMessage /></FormItem> )}/>
                    <FormField control={form.control} name="seo_keywords" render={({ field }) => ( <FormItem><FormLabel>SEO Keywords</FormLabel><FormControl><Input {...field} /></FormControl><FormMessage /></FormItem> )}/>
                </CardContent>
            </Card>

             <Card>
                <CardHeader><CardTitle>Media</CardTitle></CardHeader>
                <CardContent className="space-y-4">
                    <FormField control={form.control} name="image" render={({ field }) => ( <FormItem><FormLabel>Image</FormLabel><FormControl><ImageUpload bucket='services' initialUrl={field.value} onUpload={(url) => field.onChange(url)} onRemove={() => field.onChange('')} /></FormControl><FormMessage /></FormItem> )}/>
                    <FormField control={form.control} name="thumbnail" render={({ field }) => ( <FormItem><FormLabel>Thumbnail</FormLabel><FormControl><ImageUpload bucket='services' initialUrl={field.value} onUpload={(url) => field.onChange(url)} onRemove={() => field.onChange('')} /></FormControl><FormMessage /></FormItem> )}/>
                </CardContent>
            </Card>
          </div>
        </div>

        <div className="mt-8 flex justify-end gap-4">
          <Button type="button" variant="outline" asChild>
            <Link href="/admin/services">Cancel</Link>
          </Button>
          <Button type="submit" disabled={isSubmitting}>
            {isSubmitting && <Loader2 className="mr-2 h-4 w-4 animate-spin" />}
            {isEditing ? 'Save Changes' : 'Create Service'}
          </Button>
        </div>
      </form>
    </Form>
  );
}
</file>

<file path="src/app/admin/testimonials/actions.ts">
'use server';

import { createSupabaseAdminClient } from '@/lib/supabase/admin';
import { testimonialSchema } from './schema';
import { revalidatePath } from 'next/cache';
import { Testimonial } from '@/lib/types';

export async function upsertTestimonial(values: unknown, testimonialId?: string) {
  const supabase = createSupabaseAdminClient();
  const parsedValues = testimonialSchema.safeParse(values);

  if (!parsedValues.success) {
    return { error: parsedValues.error.message };
  }

  const { data, error } = await supabase
    .from('testimonials')
    .upsert(testimonialId ? { ...parsedValues.data, id: testimonialId } : { post_url: parsedValues.data.postUrl })
    .select('*')
    .single();

  if (error) {
    return { error: `Database error: ${error.message}` };
  }

  revalidatePath('/admin/testimonials');
  revalidatePath(`/admin/testimonials/${(data as Testimonial).id}`);

  return {
    data: data,
    message: `Testimonial ${testimonialId ? 'updated' : 'created'} successfully!`,
  };
}
</file>

<file path="src/app/admin/testimonials/page.tsx">
import { Suspense } from 'react';
import TestimonialsClient from './TestimonialsClient';
import TestimonialsLoading from './loading';

export const metadata = {
    title: 'Testimonials | Bilacert Admin Pro',
    description: 'Manage customer testimonials from social media.',
};

export default function TestimonialsPage() {
  return (
    <div className="space-y-6">
        <h1 className="text-3xl font-bold tracking-tight">Testimonials</h1>
        <Suspense fallback={<TestimonialsLoading />}>
            <TestimonialsClient />
        </Suspense>
    </div>
  );
}
</file>

<file path="src/app/admin/testimonials/schema.ts">
import * as z from 'zod';

export const testimonialSchema = z.object({
  postUrl: z.string().url('Please enter a valid Facebook post URL'),
});
</file>

<file path="src/app/contact/actions.ts">
'use server';

import { createSupabaseAdminClient } from '@/lib/supabase/admin';
import { contactFormSchema } from './schema';

export async function submitContactForm(values: unknown) {
  const supabase = createSupabaseAdminClient();
  const parsedValues = contactFormSchema.safeParse(values);

  if (!parsedValues.success) {
    return { success: false, message: parsedValues.error.message };
  }

  const { data, error } = await supabase.from('contacts').insert([
    {
      name: parsedValues.data.fullName,
      email: parsedValues.data.email,
      phone: parsedValues.data.phone,
      service: parsedValues.data.service,
      message: parsedValues.data.message,
    },
  ]);

  if (error) {
    return { success: false, message: `Database error: ${error.message}` };
  }

  return {
    success: true,
    message: 'Thank you for your message! We will get back to you soon.',
  };
}
</file>

<file path="src/app/contact/schema.ts">
import * as z from 'zod';

export const contactFormSchema = z.object({
  formType: z.string(),
  fullName: z.string().min(1, 'Name is required'),
  email: z.string().email('Please enter a valid email'),
  phone: z.string().optional(),
  service: z.string().optional(),
  message: z.string().optional(),
});
</file>

<file path="src/app/globals.css">
@tailwind base;
@tailwind components;
@tailwind utilities;

body {
  font-family: Arial, Helvetica, sans-serif;
}

@layer base {
  :root {
    --background: 210 29% 96%;
    --foreground: 211 43% 17%;
    --card: 0 0% 100%;
    --card-foreground: 211 43% 17%;
    --popover: 0 0% 100%;
    --popover-foreground: 211 43% 17%;
    --primary: 211 77% 17%;
    --primary-foreground: 0 0% 98%;
    --secondary: 210 25% 90%;
    --secondary-foreground: 211 77% 17%;
    --muted: 210 25% 90%;
    --muted-foreground: 210 15% 45%;
    --accent: 30 87% 62%;
    --accent-foreground: 211 77% 17%;
    --destructive: 0 84.2% 60.2%;
    --destructive-foreground: 0 0% 98%;
    --border: 210 20% 88%;
    --input: 210 20% 88%;
    --ring: 30 87% 62%;
    --chart-1: 211 77% 17%;
    --chart-2: 30 87% 62%;
    --chart-3: 210 25% 70%;
    --chart-4: 43 74% 66%;
    --chart-5: 27 87% 67%;
    --radius: 0.5rem;
    --sidebar-background: 211 77% 17%;
    --sidebar-foreground: 210 20% 80%;
    --sidebar-primary: 30 87% 62%;
    --sidebar-primary-foreground: 211 77% 17%;
    --sidebar-accent: 211 77% 22%;
    --sidebar-accent-foreground: 0 0% 98%;
    --sidebar-border: 211 77% 25%;
    --sidebar-ring: 30 87% 62%;
  }
  .dark {
    --background: 211 77% 10%;
    --foreground: 210 29% 96%;
    --card: 211 77% 13%;
    --card-foreground: 210 29% 96%;
    --popover: 211 77% 10%;
    --popover-foreground: 210 29% 96%;
    --primary: 210 29% 96%;
    --primary-foreground: 211 77% 17%;
    --secondary: 211 77% 15%;
    --secondary-foreground: 210 29% 96%;
    --muted: 211 77% 15%;
    --muted-foreground: 210 20% 65%;
    --accent: 30 87% 62%;
    --accent-foreground: 211 77% 17%;
    --destructive: 0 62.8% 30.6%;
    --destructive-foreground: 0 0% 98%;
    --border: 211 77% 20%;
    --input: 211 77% 20%;
    --ring: 30 87% 62%;
    --chart-1: 210 29% 96%;
    --chart-2: 30 87% 62%;
    --chart-3: 211 77% 30%;
    --chart-4: 280 65% 60%;
    --chart-5: 340 75% 55%;
    --sidebar-background: 211 77% 17%;
    --sidebar-foreground: 210 20% 80%;
    --sidebar-primary: 30 87% 62%;
    --sidebar-primary-foreground: 211 77% 17%;
    --sidebar-accent: 211 77% 22%;
    --sidebar-accent-foreground: 0 0% 98%;
    --sidebar-border: 211 77% 25%;
    --sidebar-ring: 30 87% 62%;
  }
}

@layer base {
  * {
    @apply border-border;
  }
  body {
    @apply bg-background text-foreground;
  }
}
</file>

<file path="src/components/admin/AdminLayout.tsx">
'use client';

import React, { useEffect } from 'react';
import { usePathname, useRouter } from 'next/navigation';
import { useUser } from '@/hooks/useUser';
import { SidebarProvider } from '@/components/ui/sidebar';
import AdminSidebar from '@/components/admin/Sidebar';
import AdminHeader from '@/components/admin/Header';
import { Loader2 } from 'lucide-react';

export default function AdminLayout({
  children,
}: {
  children: React.ReactNode;
}) {
  const pathname = usePathname();
  const router = useRouter();
  const { user, loading } = useUser();

  useEffect(() => {
    if (!loading) {
      if (!user && pathname !== '/admin/login') {
        router.push('/admin/login');
      }
      if (user && pathname === '/admin/login') {
        router.push('/admin/dashboard');
      }
    }
  }, [user, loading, pathname, router]);

  if (loading) {
    return (
      <div className="flex h-screen w-full items-center justify-center bg-background">
        <Loader2 className="h-8 w-8 animate-spin text-primary" />
      </div>
    );
  }

  if (!user && pathname !== '/admin/login') {
    return null; // or a loading spinner, as the redirect is happening
  }

  if (user && pathname === '/admin/login') {
    return null; // or a loading spinner, as the redirect is happening
  }

  if (pathname === '/admin/login') {
    return <>{children}</>;
  }

  return (
    <SidebarProvider>
      <AdminSidebar />
      <main className="flex min-h-svh flex-1 flex-col bg-background">
        <AdminHeader />
        <div className="flex-1 p-4 sm:p-6 lg:p-8">{children}</div>
      </main>
    </SidebarProvider>
  );
}
</file>

<file path="src/components/admin/Header.tsx">
'use client';

import { useUser } from '@/hooks/useUser';
import { supabase } from '@/lib/supabase/supabase';
import {
  DropdownMenu,
  DropdownMenuContent,
  DropdownMenuItem,
  DropdownMenuLabel,
  DropdownMenuSeparator,
  DropdownMenuTrigger,
} from '@/components/ui/dropdown-menu';
import { Avatar, AvatarFallback, AvatarImage } from '@/components/ui/avatar';
import { Button } from '@/components/ui/button';
import { SidebarTrigger } from '@/components/ui/sidebar';
import { LogOut, User as UserIcon, ChevronDown } from 'lucide-react';
import { PlaceHolderImages } from '@/lib/placeholder-images';
import { usePathname, useRouter } from 'next/navigation';
import { useToast } from '@/hooks/use-toast';

function getTitleFromPathname(pathname: string): string {
  const segment = pathname.split('/').pop() || 'dashboard';
  return segment.charAt(0).toUpperCase() + segment.slice(1);
}

export default function AdminHeader() {
  const { user } = useUser();
  const { toast } = useToast();
  const router = useRouter();
  const pathname = usePathname();
  const avatar = PlaceHolderImages.find((img) => img.id === 'user-avatar-1');
  const pageTitle = getTitleFromPathname(pathname);

  const handleLogout = async () => {
    try {
      const { error } = await supabase.auth.signOut();
      if (error) throw error;
      router.push('/admin/login');
    } catch (error: any) {
      toast({
        variant: 'destructive',
        title: 'Logout failed',
        description: error.message,
      });
    }
  };

  const getInitials = (email: string) => {
    return email ? email.substring(0, 2).toUpperCase() : 'AD';
  };

  const displayName = user?.user_metadata?.full_name || user?.email;
  const avatarUrl = user?.user_metadata?.avatar_url || user?.user_metadata?.profile_image || (avatar ? avatar.imageUrl : undefined);


  return (
    <header className="sticky top-0 z-10 flex h-16 items-center justify-between border-b bg-card px-4 sm:px-6">
      <div className="flex items-center gap-4">
        <SidebarTrigger className="md:hidden" />
        <h1 className="hidden text-xl font-semibold md:block">{pageTitle}</h1>
      </div>

      {user && (
        <DropdownMenu>
          <DropdownMenuTrigger asChild>
            <Button variant="ghost" className="flex items-center gap-2">
              <Avatar className="h-8 w-8">
                <AvatarImage
                  src={avatarUrl}
                  alt={displayName || 'Admin'}
                />
                <AvatarFallback>{getInitials(user.email || '')}</AvatarFallback>
              </Avatar>
              <div className="hidden flex-col items-start text-left md:flex">
                <span className="text-sm font-medium">
                  {displayName}
                </span>
              </div>
              <ChevronDown className="h-4 w-4 text-muted-foreground" />
            </Button>
          </DropdownMenuTrigger>
          <DropdownMenuContent align="end" className="w-56">
            <DropdownMenuLabel>
              <div className="flex flex-col">
                <span className="font-medium">{displayName}</span>
                <span className="text-xs text-muted-foreground">
                  {user.email}
                </span>
              </div>
            </DropdownMenuLabel>
            <DropdownMenuSeparator />
            <DropdownMenuItem>
              <UserIcon className="mr-2 h-4 w-4" />
              <span>Profile</span>
            </DropdownMenuItem>
            <DropdownMenuSeparator />
            <DropdownMenuItem
              onClick={handleLogout}
              className="text-destructive focus:bg-destructive/10 focus:text-destructive"
            >
              <LogOut className="mr-2 h-4 w-4" />
              <span>Log out</span>
            </DropdownMenuItem>
          </DropdownMenuContent>
        </DropdownMenu>
      )}
    </header>
  );
}
</file>

<file path="src/components/admin/StatCard.tsx">
import type { ReactNode } from 'react';
import { Card, CardContent, CardHeader, CardTitle } from '@/components/ui/card';

interface StatCardProps {
  title: string;
  value: string;
  icon: ReactNode;
  description?: string;
}

export default function StatCard({ title, value, icon, description }: StatCardProps) {
  return (
    <Card>
      <CardHeader className="flex flex-row items-center justify-between space-y-0 pb-2">
        <CardTitle className="text-sm font-medium">{title}</CardTitle>
        <div className="text-muted-foreground">{icon}</div>
      </CardHeader>
      <CardContent>
        <div className="text-2xl font-bold">{value}</div>
        {description && <p className="text-xs text-muted-foreground">{description}</p>}
      </CardContent>
    </Card>
  );
}
</file>

<file path="src/components/admin/SupabaseNotConfigured.tsx">
export default function SupabaseNotConfigured() {
  return (
    <div className="flex h-screen w-full items-center justify-center bg-background p-8">
      <div className="max-w-2xl rounded-lg border border-destructive bg-card p-8 text-center shadow-lg">
        <h1 className="text-2xl font-bold text-destructive">Supabase Not Configured</h1>
        <p className="mt-4 text-card-foreground">
          Your application is not yet configured to connect to Supabase. To fix this, you need to add your Supabase project's credentials to the environment file.
        </p>
        <div className="mt-6 text-left text-sm">
          <p className="font-semibold">Follow these steps:</p>
          <ol className="ml-5 mt-2 list-decimal space-y-2">
            <li>Go to your <a href="https://supabase.com/dashboard" target="_blank" rel="noopener noreferrer" className="text-primary underline">Supabase project dashboard</a>.</li>
            <li>Navigate to <strong>Project Settings</strong> (the gear icon in the left sidebar).</li>
            <li>Click on the <strong>API</strong> tab.</li>
            <li>You will find your <strong>Project URL</strong> and the <strong><code className="bg-muted px-1 py-0.5 rounded-sm font-mono text-xs">anon</code> public key</strong>.</li>
            <li>Open the <code className="bg-muted px-1 py-0.5 rounded-sm font-mono text-xs">.env</code> file in your project's root directory.</li>
            <li>Replace the placeholder values with your actual credentials:</li>
          </ol>
        </div>
        <pre className="mt-4 w-full overflow-x-auto rounded-md bg-muted p-4 text-left text-sm">
          <code className="font-mono">
            NEXT_PUBLIC_SUPABASE_URL="YOUR_SUPABASE_URL"
            <br />
            NEXT_PUBLIC_SUPABASE_ANON_KEY="YOUR_SUPABASE_ANON_KEY"
          </code>
        </pre>
        <p className="mt-4 text-xs text-muted-foreground">
          After saving the <code className="bg-muted px-1 py-0.5 rounded-sm font-mono text-xs">.env</code> file, your application should automatically update. If it doesn't, please restart the development server.
        </p>
      </div>
    </div>
  );
}
</file>

<file path="src/components/ui/accordion.tsx">
"use client"

import * as React from "react"
import * as AccordionPrimitive from "@radix-ui/react-accordion"
import { ChevronDown } from "lucide-react"

import { cn } from "@/lib/utils"

const Accordion = AccordionPrimitive.Root

const AccordionItem = React.forwardRef<
  React.ElementRef<typeof AccordionPrimitive.Item>,
  React.ComponentPropsWithoutRef<typeof AccordionPrimitive.Item>
>(({ className, ...props }, ref) => (
  <AccordionPrimitive.Item
    ref={ref}
    className={cn("border-b", className)}
    {...props}
  />
))
AccordionItem.displayName = "AccordionItem"

const AccordionTrigger = React.forwardRef<
  React.ElementRef<typeof AccordionPrimitive.Trigger>,
  React.ComponentPropsWithoutRef<typeof AccordionPrimitive.Trigger>
>(({ className, children, ...props }, ref) => (
  <AccordionPrimitive.Header className="flex">
    <AccordionPrimitive.Trigger
      ref={ref}
      className={cn(
        "flex flex-1 items-center justify-between py-4 font-medium transition-all hover:underline [&[data-state=open]>svg]:rotate-180",
        className
      )}
      {...props}
    >
      {children}
      <ChevronDown className="h-4 w-4 shrink-0 transition-transform duration-200" />
    </AccordionPrimitive.Trigger>
  </AccordionPrimitive.Header>
))
AccordionTrigger.displayName = AccordionPrimitive.Trigger.displayName

const AccordionContent = React.forwardRef<
  React.ElementRef<typeof AccordionPrimitive.Content>,
  React.ComponentPropsWithoutRef<typeof AccordionPrimitive.Content>
>(({ className, children, ...props }, ref) => (
  <AccordionPrimitive.Content
    ref={ref}
    className="overflow-hidden text-sm transition-all data-[state=closed]:animate-accordion-up data-[state=open]:animate-accordion-down"
    {...props}
  >
    <div className={cn("pb-4 pt-0", className)}>{children}</div>
  </AccordionPrimitive.Content>
))

AccordionContent.displayName = AccordionPrimitive.Content.displayName

export { Accordion, AccordionItem, AccordionTrigger, AccordionContent }
</file>

<file path="src/components/ui/alert-dialog.tsx">
"use client"

import * as React from "react"
import * as AlertDialogPrimitive from "@radix-ui/react-alert-dialog"

import { cn } from "@/lib/utils"
import { buttonVariants } from "@/components/ui/button"

const AlertDialog = AlertDialogPrimitive.Root

const AlertDialogTrigger = AlertDialogPrimitive.Trigger

const AlertDialogPortal = AlertDialogPrimitive.Portal

const AlertDialogOverlay = React.forwardRef<
  React.ElementRef<typeof AlertDialogPrimitive.Overlay>,
  React.ComponentPropsWithoutRef<typeof AlertDialogPrimitive.Overlay>
>(({ className, ...props }, ref) => (
  <AlertDialogPrimitive.Overlay
    className={cn(
      "fixed inset-0 z-50 bg-background/80 backdrop-blur-sm data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0",
      className
    )}
    {...props}
    ref={ref}
  />
))
AlertDialogOverlay.displayName = AlertDialogPrimitive.Overlay.displayName

const AlertDialogContent = React.forwardRef<
  React.ElementRef<typeof AlertDialogPrimitive.Content>,
  React.ComponentPropsWithoutRef<typeof AlertDialogPrimitive.Content>
>(({ className, ...props }, ref) => (
  <AlertDialogPortal>
    <AlertDialogOverlay />
    <AlertDialogPrimitive.Content
      ref={ref}
      className={cn(
        "fixed left-[50%] top-[50%] z-50 grid w-full max-w-lg translate-x-[-50%] translate-y-[-50%] gap-4 border bg-background p-6 shadow-lg duration-200 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[state=closed]:slide-out-to-left-1/2 data-[state=closed]:slide-out-to-top-[48%] data-[state=open]:slide-in-from-left-1/2 data-[state=open]:slide-in-from-top-[48%] sm:rounded-lg",
        className
      )}
      {...props}
    />
  </AlertDialogPortal>
))
AlertDialogContent.displayName = AlertDialogPrimitive.Content.displayName

const AlertDialogHeader = ({
  className,
  ...props
}: React.HTMLAttributes<HTMLDivElement>) => (
  <div
    className={cn(
      "flex flex-col space-y-2 text-center sm:text-left",
      className
    )}
    {...props}
  />
)
AlertDialogHeader.displayName = "AlertDialogHeader"

const AlertDialogFooter = ({
  className,
  ...props
}: React.HTMLAttributes<HTMLDivElement>) => (
  <div
    className={cn(
      "flex flex-col-reverse sm:flex-row sm:justify-end sm:space-x-2",
      className
    )}
    {...props}
  />
)
AlertDialogFooter.displayName = "AlertDialogFooter"

const AlertDialogTitle = React.forwardRef<
  React.ElementRef<typeof AlertDialogPrimitive.Title>,
  React.ComponentPropsWithoutRef<typeof AlertDialogPrimitive.Title>
>(({ className, ...props }, ref) => (
  <AlertDialogPrimitive.Title
    ref={ref}
    className={cn("text-lg font-semibold", className)}
    {...props}
  />
))
AlertDialogTitle.displayName = AlertDialogPrimitive.Title.displayName

const AlertDialogDescription = React.forwardRef<
  React.ElementRef<typeof AlertDialogPrimitive.Description>,
  React.ComponentPropsWithoutRef<typeof AlertDialogPrimitive.Description>
>(({ className, ...props }, ref) => (
  <AlertDialogPrimitive.Description
    ref={ref}
    className={cn("text-sm text-muted-foreground", className)}
    {...props}
  />
))
AlertDialogDescription.displayName =
  AlertDialogPrimitive.Description.displayName

const AlertDialogAction = React.forwardRef<
  React.ElementRef<typeof AlertDialogPrimitive.Action>,
  React.ComponentPropsWithoutRef<typeof AlertDialogPrimitive.Action>
>(({ className, ...props }, ref) => (
  <AlertDialogPrimitive.Action
    ref={ref}
    className={cn(buttonVariants(), className)}
    {...props}
  />
))
AlertDialogAction.displayName = AlertDialogPrimitive.Action.displayName

const AlertDialogCancel = React.forwardRef<
  React.ElementRef<typeof AlertDialogPrimitive.Cancel>,
  React.ComponentPropsWithoutRef<typeof AlertDialogPrimitive.Cancel>
>(({ className, ...props }, ref) => (
  <AlertDialogPrimitive.Cancel
    ref={ref}
    className={cn(
      buttonVariants({ variant: "outline" }),
      "mt-2 sm:mt-0",
      className
    )}
    {...props}
  />
))
AlertDialogCancel.displayName = AlertDialogPrimitive.Cancel.displayName

export {
  AlertDialog,
  AlertDialogPortal,
  AlertDialogOverlay,
  AlertDialogTrigger,
  AlertDialogContent,
  AlertDialogHeader,
  AlertDialogFooter,
  AlertDialogTitle,
  AlertDialogDescription,
  AlertDialogAction,
  AlertDialogCancel,
}
</file>

<file path="src/components/ui/alert.tsx">
import * as React from "react"
import { cva, type VariantProps } from "class-variance-authority"

import { cn } from "@/lib/utils"

const alertVariants = cva(
  "relative w-full rounded-lg border p-4 [&>svg~*]:pl-7 [&>svg+div]:translate-y-[-3px] [&>svg]:absolute [&>svg]:left-4 [&>svg]:top-4 [&>svg]:text-foreground",
  {
    variants: {
      variant: {
        default: "bg-background text-foreground",
        destructive:
          "border-destructive/50 text-destructive dark:border-destructive [&>svg]:text-destructive",
      },
    },
    defaultVariants: {
      variant: "default",
    },
  }
)

const Alert = React.forwardRef<
  HTMLDivElement,
  React.HTMLAttributes<HTMLDivElement> & VariantProps<typeof alertVariants>
>(({ className, variant, ...props }, ref) => (
  <div
    ref={ref}
    role="alert"
    className={cn(alertVariants({ variant }), className)}
    {...props}
  />
))
Alert.displayName = "Alert"

const AlertTitle = React.forwardRef<
  HTMLParagraphElement,
  React.HTMLAttributes<HTMLHeadingElement>
>(({ className, ...props }, ref) => (
  <h5
    ref={ref}
    className={cn("mb-1 font-medium leading-none tracking-tight", className)}
    {...props}
  />
))
AlertTitle.displayName = "AlertTitle"

const AlertDescription = React.forwardRef<
  HTMLParagraphElement,
  React.HTMLAttributes<HTMLParagraphElement>
>(({ className, ...props }, ref) => (
  <div
    ref={ref}
    className={cn("text-sm [&_p]:leading-relaxed", className)}
    {...props}
  />
))
AlertDescription.displayName = "AlertDescription"

export { Alert, AlertTitle, AlertDescription }
</file>

<file path="src/components/ui/avatar.tsx">
"use client"

import * as React from "react"
import * as AvatarPrimitive from "@radix-ui/react-avatar"

import { cn } from "@/lib/utils"

const Avatar = React.forwardRef<
  React.ElementRef<typeof AvatarPrimitive.Root>,
  React.ComponentPropsWithoutRef<typeof AvatarPrimitive.Root>
>(({ className, ...props }, ref) => (
  <AvatarPrimitive.Root
    ref={ref}
    className={cn(
      "relative flex h-10 w-10 shrink-0 overflow-hidden rounded-full",
      className
    )}
    {...props}
  />
))
Avatar.displayName = AvatarPrimitive.Root.displayName

const AvatarImage = React.forwardRef<
  React.ElementRef<typeof AvatarPrimitive.Image>,
  React.ComponentPropsWithoutRef<typeof AvatarPrimitive.Image>
>(({ className, ...props }, ref) => (
  <AvatarPrimitive.Image
    ref={ref}
    className={cn("aspect-square h-full w-full", className)}
    {...props}
  />
))
AvatarImage.displayName = AvatarPrimitive.Image.displayName

const AvatarFallback = React.forwardRef<
  React.ElementRef<typeof AvatarPrimitive.Fallback>,
  React.ComponentPropsWithoutRef<typeof AvatarPrimitive.Fallback>
>(({ className, ...props }, ref) => (
  <AvatarPrimitive.Fallback
    ref={ref}
    className={cn(
      "flex h-full w-full items-center justify-center rounded-full bg-muted",
      className
    )}
    {...props}
  />
))
AvatarFallback.displayName = AvatarPrimitive.Fallback.displayName

export { Avatar, AvatarImage, AvatarFallback }
</file>

<file path="src/components/ui/badge.tsx">
import * as React from "react"
import { cva, type VariantProps } from "class-variance-authority"

import { cn } from "@/lib/utils"

const badgeVariants = cva(
  "inline-flex items-center rounded-full border px-2.5 py-0.5 text-xs font-semibold transition-colors focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2",
  {
    variants: {
      variant: {
        default:
          "border-transparent bg-primary text-primary-foreground hover:bg-primary/80",
        secondary:
          "border-transparent bg-secondary text-secondary-foreground hover:bg-secondary/80",
        destructive:
          "border-transparent bg-destructive text-destructive-foreground hover:bg-destructive/80",
        outline: "text-foreground",
      },
    },
    defaultVariants: {
      variant: "default",
    },
  }
)

export interface BadgeProps
  extends React.HTMLAttributes<HTMLDivElement>,
    VariantProps<typeof badgeVariants> {}

function Badge({ className, variant, ...props }: BadgeProps) {
  return (
    <div className={cn(badgeVariants({ variant }), className)} {...props} />
  )
}

export { Badge, badgeVariants }
</file>

<file path="src/components/ui/button.tsx">
import * as React from "react"
import { Slot } from "@radix-ui/react-slot"
import { cva, type VariantProps } from "class-variance-authority"

import { cn } from "@/lib/utils"

const buttonVariants = cva(
  "inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0",
  {
    variants: {
      variant: {
        default: "bg-primary text-primary-foreground hover:bg-primary/90",
        destructive:
          "bg-destructive text-destructive-foreground hover:bg-destructive/90",
        outline:
          "border border-input bg-background hover:bg-accent hover:text-accent-foreground",
        secondary:
          "bg-secondary text-secondary-foreground hover:bg-secondary/80",
        ghost: "hover:bg-accent hover:text-accent-foreground",
        link: "text-primary underline-offset-4 hover:underline",
      },
      size: {
        default: "h-10 px-4 py-2",
        sm: "h-9 rounded-md px-3",
        lg: "h-11 rounded-md px-8",
        icon: "h-10 w-10",
      },
    },
    defaultVariants: {
      variant: "default",
      size: "default",
    },
  }
)

export interface ButtonProps
  extends React.ButtonHTMLAttributes<HTMLButtonElement>,
    VariantProps<typeof buttonVariants> {
  asChild?: boolean
}

const Button = React.forwardRef<HTMLButtonElement, ButtonProps>(
  ({ className, variant, size, asChild = false, ...props }, ref) => {
    const Comp = asChild ? Slot : "button"
    return (
      <Comp
        className={cn(buttonVariants({ variant, size, className }))}
        ref={ref}
        {...props}
      />
    )
  }
)
Button.displayName = "Button"

export { Button, buttonVariants }
</file>

<file path="src/components/ui/card.tsx">
import * as React from "react"

import { cn } from "@/lib/utils"

const Card = React.forwardRef<
  HTMLDivElement,
  React.HTMLAttributes<HTMLDivElement>
>(({ className, ...props }, ref) => (
  <div
    ref={ref}
    className={cn(
      "rounded-lg border bg-card text-card-foreground shadow-sm",
      className
    )}
    {...props}
  />
))
Card.displayName = "Card"

const CardHeader = React.forwardRef<
  HTMLDivElement,
  React.HTMLAttributes<HTMLDivElement>
>(({ className, ...props }, ref) => (
  <div
    ref={ref}
    className={cn("flex flex-col space-y-1.5 p-6", className)}
    {...props}
  />
))
CardHeader.displayName = "CardHeader"

const CardTitle = React.forwardRef<
  HTMLDivElement,
  React.HTMLAttributes<HTMLDivElement>
>(({ className, ...props }, ref) => (
  <div
    ref={ref}
    className={cn(
      "text-2xl font-semibold leading-none tracking-tight",
      className
    )}
    {...props}
  />
))
CardTitle.displayName = "CardTitle"

const CardDescription = React.forwardRef<
  HTMLDivElement,
  React.HTMLAttributes<HTMLDivElement>
>(({ className, ...props }, ref) => (
  <div
    ref={ref}
    className={cn("text-sm text-muted-foreground", className)}
    {...props}
  />
))
CardDescription.displayName = "CardDescription"

const CardContent = React.forwardRef<
  HTMLDivElement,
  React.HTMLAttributes<HTMLDivElement>
>(({ className, ...props }, ref) => (
  <div ref={ref} className={cn("p-6 pt-0", className)} {...props} />
))
CardContent.displayName = "CardContent"

const CardFooter = React.forwardRef<
  HTMLDivElement,
  React.HTMLAttributes<HTMLDivElement>
>(({ className, ...props }, ref) => (
  <div
    ref={ref}
    className={cn("flex items-center p-6 pt-0", className)}
    {...props}
  />
))
CardFooter.displayName = "CardFooter"

export { Card, CardHeader, CardFooter, CardTitle, CardDescription, CardContent }
</file>

<file path="src/components/ui/carousel.tsx">
"use client"

import * as React from "react"
import useEmblaCarousel, {
  type UseEmblaCarouselType,
} from "embla-carousel-react"
import { ArrowLeft, ArrowRight } from "lucide-react"

import { cn } from "@/lib/utils"
import { Button } from "@/components/ui/button"

type CarouselApi = UseEmblaCarouselType[1]
type UseCarouselParameters = Parameters<typeof useEmblaCarousel>
type CarouselOptions = UseCarouselParameters[0]
type CarouselPlugin = UseCarouselParameters[1]

type CarouselProps = {
  opts?: CarouselOptions
  plugins?: CarouselPlugin
  orientation?: "horizontal" | "vertical"
  setApi?: (api: CarouselApi) => void
}

type CarouselContextProps = {
  carouselRef: ReturnType<typeof useEmblaCarousel>[0]
  api: ReturnType<typeof useEmblaCarousel>[1]
  scrollPrev: () => void
  scrollNext: () => void
  canScrollPrev: boolean
  canScrollNext: boolean
} & CarouselProps

const CarouselContext = React.createContext<CarouselContextProps | null>(null)

function useCarousel() {
  const context = React.useContext(CarouselContext)

  if (!context) {
    throw new Error("useCarousel must be used within a <Carousel />")
  }

  return context
}

const Carousel = React.forwardRef<
  HTMLDivElement,
  React.HTMLAttributes<HTMLDivElement> & CarouselProps
>(
  (
    {
      orientation = "horizontal",
      opts,
      setApi,
      plugins,
      className,
      children,
      ...props
    },
    ref
  ) => {
    const [carouselRef, api] = useEmblaCarousel(
      {
        ...opts,
        axis: orientation === "horizontal" ? "x" : "y",
      },
      plugins
    )
    const [canScrollPrev, setCanScrollPrev] = React.useState(false)
    const [canScrollNext, setCanScrollNext] = React.useState(false)

    const onSelect = React.useCallback((api: CarouselApi) => {
      if (!api) {
        return
      }

      setCanScrollPrev(api.canScrollPrev())
      setCanScrollNext(api.canScrollNext())
    }, [])

    const scrollPrev = React.useCallback(() => {
      api?.scrollPrev()
    }, [api])

    const scrollNext = React.useCallback(() => {
      api?.scrollNext()
    }, [api])

    const handleKeyDown = React.useCallback(
      (event: React.KeyboardEvent<HTMLDivElement>) => {
        if (event.key === "ArrowLeft") {
          event.preventDefault()
          scrollPrev()
        } else if (event.key === "ArrowRight") {
          event.preventDefault()
          scrollNext()
        }
      },
      [scrollPrev, scrollNext]
    )

    React.useEffect(() => {
      if (!api || !setApi) {
        return
      }

      setApi(api)
    }, [api, setApi])

    React.useEffect(() => {
      if (!api) {
        return
      }

      onSelect(api)
      api.on("reInit", onSelect)
      api.on("select", onSelect)

      return () => {
        api?.off("select", onSelect)
      }
    }, [api, onSelect])

    return (
      <CarouselContext.Provider
        value={{
          carouselRef,
          api: api,
          opts,
          orientation:
            orientation || (opts?.axis === "y" ? "vertical" : "horizontal"),
          scrollPrev,
          scrollNext,
          canScrollPrev,
          canScrollNext,
        }}
      >
        <div
          ref={ref}
          onKeyDownCapture={handleKeyDown}
          className={cn("relative", className)}
          role="region"
          aria-roledescription="carousel"
          {...props}
        >
          {children}
        </div>
      </CarouselContext.Provider>
    )
  }
)
Carousel.displayName = "Carousel"

const CarouselContent = React.forwardRef<
  HTMLDivElement,
  React.HTMLAttributes<HTMLDivElement>
>(({ className, ...props }, ref) => {
  const { carouselRef, orientation } = useCarousel()

  return (
    <div ref={carouselRef} className="overflow-hidden">
      <div
        ref={ref}
        className={cn(
          "flex",
          orientation === "horizontal" ? "-ml-4" : "-mt-4 flex-col",
          className
        )}
        {...props}
      />
    </div>
  )
})
CarouselContent.displayName = "CarouselContent"

const CarouselItem = React.forwardRef<
  HTMLDivElement,
  React.HTMLAttributes<HTMLDivElement>
>(({ className, ...props }, ref) => {
  const { orientation } = useCarousel()

  return (
    <div
      ref={ref}
      role="group"
      aria-roledescription="slide"
      className={cn(
        "min-w-0 shrink-0 grow-0 basis-full",
        orientation === "horizontal" ? "pl-4" : "pt-4",
        className
      )}
      {...props}
    />
  )
})
CarouselItem.displayName = "CarouselItem"

const CarouselPrevious = React.forwardRef<
  HTMLButtonElement,
  React.ComponentProps<typeof Button>
>(({ className, variant = "outline", size = "icon", ...props }, ref) => {
  const { orientation, scrollPrev, canScrollPrev } = useCarousel()

  return (
    <Button
      ref={ref}
      variant={variant}
      size={size}
      className={cn(
        "absolute  h-8 w-8 rounded-full",
        orientation === "horizontal"
          ? "-left-12 top-1/2 -translate-y-1/2"
          : "-top-12 left-1/2 -translate-x-1/2 rotate-90",
        className
      )}
      disabled={!canScrollPrev}
      onClick={scrollPrev}
      {...props}
    >
      <ArrowLeft className="h-4 w-4" />
      <span className="sr-only">Previous slide</span>
    </Button>
  )
})
CarouselPrevious.displayName = "CarouselPrevious"

const CarouselNext = React.forwardRef<
  HTMLButtonElement,
  React.ComponentProps<typeof Button>
>(({ className, variant = "outline", size = "icon", ...props }, ref) => {
  const { orientation, scrollNext, canScrollNext } = useCarousel()

  return (
    <Button
      ref={ref}
      variant={variant}
      size={size}
      className={cn(
        "absolute h-8 w-8 rounded-full",
        orientation === "horizontal"
          ? "-right-12 top-1/2 -translate-y-1/2"
          : "-bottom-12 left-1/2 -translate-x-1/2 rotate-90",
        className
      )}
      disabled={!canScrollNext}
      onClick={scrollNext}
      {...props}
    >
      <ArrowRight className="h-4 w-4" />
      <span className="sr-only">Next slide</span>
    </Button>
  )
})
CarouselNext.displayName = "CarouselNext"

export {
  type CarouselApi,
  Carousel,
  CarouselContent,
  CarouselItem,
  CarouselPrevious,
  CarouselNext,
}
</file>

<file path="src/components/ui/checkbox.tsx">
"use client"

import * as React from "react"
import * as CheckboxPrimitive from "@radix-ui/react-checkbox"
import { Check } from "lucide-react"

import { cn } from "@/lib/utils"

const Checkbox = React.forwardRef<
  React.ElementRef<typeof CheckboxPrimitive.Root>,
  React.ComponentPropsWithoutRef<typeof CheckboxPrimitive.Root>
>(({ className, ...props }, ref) => (
  <CheckboxPrimitive.Root
    ref={ref}
    className={cn(
      "peer h-4 w-4 shrink-0 rounded-sm border border-primary ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 data-[state=checked]:bg-primary data-[state=checked]:text-primary-foreground",
      className
    )}
    {...props}
  >
    <CheckboxPrimitive.Indicator
      className={cn("flex items-center justify-center text-current")}
    >
      <Check className="h-4 w-4" />
    </CheckboxPrimitive.Indicator>
  </CheckboxPrimitive.Root>
))
Checkbox.displayName = CheckboxPrimitive.Root.displayName

export { Checkbox }
</file>

<file path="src/components/ui/collapsible.tsx">
"use client"

import * as CollapsiblePrimitive from "@radix-ui/react-collapsible"

const Collapsible = CollapsiblePrimitive.Root

const CollapsibleTrigger = CollapsiblePrimitive.CollapsibleTrigger

const CollapsibleContent = CollapsiblePrimitive.CollapsibleContent

export { Collapsible, CollapsibleTrigger, CollapsibleContent }
</file>

<file path="src/components/ui/dialog.tsx">
"use client"

import * as React from "react"
import * as DialogPrimitive from "@radix-ui/react-dialog"
import { X } from "lucide-react"

import { cn } from "@/lib/utils"

const Dialog = DialogPrimitive.Root

const DialogTrigger = DialogPrimitive.Trigger

const DialogPortal = DialogPrimitive.Portal

const DialogClose = DialogPrimitive.Close

const DialogOverlay = React.forwardRef<
  React.ElementRef<typeof DialogPrimitive.Overlay>,
  React.ComponentPropsWithoutRef<typeof DialogPrimitive.Overlay>
>(({ className, ...props }, ref) => (
  <DialogPrimitive.Overlay
    ref={ref}
    className={cn(
      "fixed inset-0 z-50 bg-transparent data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0",
      className
    )}
    {...props}
  />
))
DialogOverlay.displayName = DialogPrimitive.Overlay.displayName

const DialogContent = React.forwardRef<
  React.ElementRef<typeof DialogPrimitive.Content>,
  React.ComponentPropsWithoutRef<typeof DialogPrimitive.Content>
>(({ className, children, ...props }, ref) => (
  <DialogPortal>
    <DialogOverlay />
    <DialogPrimitive.Content
      ref={ref}
      className={cn(
        "fixed left-[50%] top-[50%] z-50 grid w-full max-w-lg translate-x-[-50%] translate-y-[-50%] gap-4 border bg-background p-6 shadow-lg duration-200 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[state=closed]:slide-out-to-left-1/2 data-[state=closed]:slide-out-to-top-[48%] data-[state=open]:slide-in-from-left-1/2 data-[state=open]:slide-in-from-top-[48%] sm:rounded-lg",
        className
      )}
      {...props}
    >
      {children}
      <DialogPrimitive.Close className="absolute right-4 top-4 rounded-sm opacity-70 ring-offset-background transition-opacity hover:opacity-100 focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none data-[state=open]:bg-accent data-[state=open]:text-muted-foreground">
        <X className="h-4 w-4" />
        <span className="sr-only">Close</span>
      </DialogPrimitive.Close>
    </DialogPrimitive.Content>
  </DialogPortal>
))
DialogContent.displayName = DialogPrimitive.Content.displayName

const DialogHeader = ({
  className,
  ...props
}: React.HTMLAttributes<HTMLDivElement>) => (
  <div
    className={cn(
      "flex flex-col space-y-1.5 text-center sm:text-left",
      className
    )}
    {...props}
  />
)
DialogHeader.displayName = "DialogHeader"

const DialogFooter = ({
  className,
  ...props
}: React.HTMLAttributes<HTMLDivElement>) => (
  <div
    className={cn(
      "flex flex-col-reverse sm:flex-row sm:justify-end sm:space-x-2",
      className
    )}
    {...props}
  />
)
DialogFooter.displayName = "DialogFooter"

const DialogTitle = React.forwardRef<
  React.ElementRef<typeof DialogPrimitive.Title>,
  React.ComponentPropsWithoutRef<typeof DialogPrimitive.Title>
>(({ className, ...props }, ref) => (
  <DialogPrimitive.Title
    ref={ref}
    className={cn(
      "text-lg font-semibold leading-none tracking-tight",
      className
    )}
    {...props}
  />
))
DialogTitle.displayName = DialogPrimitive.Title.displayName

const DialogDescription = React.forwardRef<
  React.ElementRef<typeof DialogPrimitive.Description>,
  React.ComponentPropsWithoutRef<typeof DialogPrimitive.Description>
>(({ className, ...props }, ref) => (
  <DialogPrimitive.Description
    ref={ref}
    className={cn("text-sm text-muted-foreground", className)}
    {...props}
  />
))
DialogDescription.displayName = DialogPrimitive.Description.displayName

export {
  Dialog,
  DialogPortal,
  DialogOverlay,
  DialogClose,
  DialogTrigger,
  DialogContent,
  DialogHeader,
  DialogFooter,
  DialogTitle,
  DialogDescription,
}
</file>

<file path="src/components/ui/dropdown-menu.tsx">
"use client"

import * as React from "react"
import * as DropdownMenuPrimitive from "@radix-ui/react-dropdown-menu"
import { Check, ChevronRight, Circle } from "lucide-react"

import { cn } from "@/lib/utils"

const DropdownMenu = DropdownMenuPrimitive.Root

const DropdownMenuTrigger = DropdownMenuPrimitive.Trigger

const DropdownMenuGroup = DropdownMenuPrimitive.Group

const DropdownMenuPortal = DropdownMenuPrimitive.Portal

const DropdownMenuSub = DropdownMenuPrimitive.Sub

const DropdownMenuRadioGroup = DropdownMenuPrimitive.RadioGroup

const DropdownMenuSubTrigger = React.forwardRef<
  React.ElementRef<typeof DropdownMenuPrimitive.SubTrigger>,
  React.ComponentPropsWithoutRef<typeof DropdownMenuPrimitive.SubTrigger> & {
    inset?: boolean
  }
>(({ className, inset, children, ...props }, ref) => (
  <DropdownMenuPrimitive.SubTrigger
    ref={ref}
    className={cn(
      "flex cursor-default gap-2 select-none items-center rounded-sm px-2 py-1.5 text-sm outline-none focus:bg-accent data-[state=open]:bg-accent [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0",
      inset && "pl-8",
      className
    )}
    {...props}
  >
    {children}
    <ChevronRight className="ml-auto" />
  </DropdownMenuPrimitive.SubTrigger>
))
DropdownMenuSubTrigger.displayName =
  DropdownMenuPrimitive.SubTrigger.displayName

const DropdownMenuSubContent = React.forwardRef<
  React.ElementRef<typeof DropdownMenuPrimitive.SubContent>,
  React.ComponentPropsWithoutRef<typeof DropdownMenuPrimitive.SubContent>
>(({ className, ...props }, ref) => (
  <DropdownMenuPrimitive.SubContent
    ref={ref}
    className={cn(
      "z-50 min-w-[8rem] overflow-hidden rounded-md border bg-popover p-1 text-popover-foreground shadow-lg data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",
      className
    )}
    {...props}
  />
))
DropdownMenuSubContent.displayName =
  DropdownMenuPrimitive.SubContent.displayName

const DropdownMenuContent = React.forwardRef<
  React.ElementRef<typeof DropdownMenuPrimitive.Content>,
  React.ComponentPropsWithoutRef<typeof DropdownMenuPrimitive.Content>
>(({ className, sideOffset = 4, ...props }, ref) => (
  <DropdownMenuPrimitive.Portal>
    <DropdownMenuPrimitive.Content
      ref={ref}
      sideOffset={sideOffset}
      className={cn(
        "z-50 min-w-[8rem] overflow-hidden rounded-md border bg-popover p-1 text-popover-foreground shadow-md data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",
        className
      )}
      {...props}
    />
  </DropdownMenuPrimitive.Portal>
))
DropdownMenuContent.displayName = DropdownMenuPrimitive.Content.displayName

const DropdownMenuItem = React.forwardRef<
  React.ElementRef<typeof DropdownMenuPrimitive.Item>,
  React.ComponentPropsWithoutRef<typeof DropdownMenuPrimitive.Item> & {
    inset?: boolean
  }
>(({ className, inset, ...props }, ref) => (
  <DropdownMenuPrimitive.Item
    ref={ref}
    className={cn(
      "relative flex cursor-default select-none items-center gap-2 rounded-sm px-2 py-1.5 text-sm outline-none transition-colors focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50 [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0",
      inset && "pl-8",
      className
    )}
    {...props}
  />
))
DropdownMenuItem.displayName = DropdownMenuPrimitive.Item.displayName

const DropdownMenuCheckboxItem = React.forwardRef<
  React.ElementRef<typeof DropdownMenuPrimitive.CheckboxItem>,
  React.ComponentPropsWithoutRef<typeof DropdownMenuPrimitive.CheckboxItem>
>(({ className, children, checked, ...props }, ref) => (
  <DropdownMenuPrimitive.CheckboxItem
    ref={ref}
    className={cn(
      "relative flex cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none transition-colors focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",
      className
    )}
    checked={checked}
    {...props}
  >
    <span className="absolute left-2 flex h-3.5 w-3.5 items-center justify-center">
      <DropdownMenuPrimitive.ItemIndicator>
        <Check className="h-4 w-4" />
      </DropdownMenuPrimitive.ItemIndicator>
    </span>
    {children}
  </DropdownMenuPrimitive.CheckboxItem>
))
DropdownMenuCheckboxItem.displayName =
  DropdownMenuPrimitive.CheckboxItem.displayName

const DropdownMenuRadioItem = React.forwardRef<
  React.ElementRef<typeof DropdownMenuPrimitive.RadioItem>,
  React.ComponentPropsWithoutRef<typeof DropdownMenuPrimitive.RadioItem>
>(({ className, children, ...props }, ref) => (
  <DropdownMenuPrimitive.RadioItem
    ref={ref}
    className={cn(
      "relative flex cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none transition-colors focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",
      className
    )}
    {...props}
  >
    <span className="absolute left-2 flex h-3.5 w-3.5 items-center justify-center">
      <DropdownMenuPrimitive.ItemIndicator>
        <Circle className="h-2 w-2 fill-current" />
      </DropdownMenuPrimitive.ItemIndicator>
    </span>
    {children}
  </DropdownMenuPrimitive.RadioItem>
))
DropdownMenuRadioItem.displayName = DropdownMenuPrimitive.RadioItem.displayName

const DropdownMenuLabel = React.forwardRef<
  React.ElementRef<typeof DropdownMenuPrimitive.Label>,
  React.ComponentPropsWithoutRef<typeof DropdownMenuPrimitive.Label> & {
    inset?: boolean
  }
>(({ className, inset, ...props }, ref) => (
  <DropdownMenuPrimitive.Label
    ref={ref}
    className={cn(
      "px-2 py-1.5 text-sm font-semibold",
      inset && "pl-8",
      className
    )}
    {...props}
  />
))
DropdownMenuLabel.displayName = DropdownMenuPrimitive.Label.displayName

const DropdownMenuSeparator = React.forwardRef<
  React.ElementRef<typeof DropdownMenuPrimitive.Separator>,
  React.ComponentPropsWithoutRef<typeof DropdownMenuPrimitive.Separator>
>(({ className, ...props }, ref) => (
  <DropdownMenuPrimitive.Separator
    ref={ref}
    className={cn("-mx-1 my-1 h-px bg-muted", className)}
    {...props}
  />
))
DropdownMenuSeparator.displayName = DropdownMenuPrimitive.Separator.displayName

const DropdownMenuShortcut = ({
  className,
  ...props
}: React.HTMLAttributes<HTMLSpanElement>) => {
  return (
    <span
      className={cn("ml-auto text-xs tracking-widest opacity-60", className)}
      {...props}
    />
  )
}
DropdownMenuShortcut.displayName = "DropdownMenuShortcut"

export {
  DropdownMenu,
  DropdownMenuTrigger,
  DropdownMenuContent,
  DropdownMenuItem,
  DropdownMenuCheckboxItem,
  DropdownMenuRadioItem,
  DropdownMenuLabel,
  DropdownMenuSeparator,
  DropdownMenuShortcut,
  DropdownMenuGroup,
  DropdownMenuPortal,
  DropdownMenuSub,
  DropdownMenuSubContent,
  DropdownMenuSubTrigger,
  DropdownMenuRadioGroup,
}
</file>

<file path="src/components/ui/form.tsx">
"use client"

import * as React from "react"
import * as LabelPrimitive from "@radix-ui/react-label"
import { Slot } from "@radix-ui/react-slot"
import {
  Controller,
  FormProvider,
  useFormContext,
  type ControllerProps,
  type FieldPath,
  type FieldValues,
} from "react-hook-form"

import { cn } from "@/lib/utils"
import { Label } from "@/components/ui/label"

const Form = FormProvider

type FormFieldContextValue<
  TFieldValues extends FieldValues = FieldValues,
  TName extends FieldPath<TFieldValues> = FieldPath<TFieldValues>
> = {
  name: TName
}

const FormFieldContext = React.createContext<FormFieldContextValue>(
  {} as FormFieldContextValue
)

const FormField = <
  TFieldValues extends FieldValues = FieldValues,
  TName extends FieldPath<TFieldValues> = FieldPath<TFieldValues>
>({
  ...props
}: ControllerProps<TFieldValues, TName>) => {
  return (
    <FormFieldContext.Provider value={{ name: props.name }}>
      <Controller {...props} />
    </FormFieldContext.Provider>
  )
}

const useFormField = () => {
  const fieldContext = React.useContext(FormFieldContext)
  const itemContext = React.useContext(FormItemContext)
  const { getFieldState, formState } = useFormContext()

  const fieldState = getFieldState(fieldContext.name, formState)

  if (!fieldContext) {
    throw new Error("useFormField should be used within <FormField>")
  }

  const { id } = itemContext

  return {
    id,
    name: fieldContext.name,
    formItemId: `${id}-form-item`,
    formDescriptionId: `${id}-form-item-description`,
    formMessageId: `${id}-form-item-message`,
    ...fieldState,
  }
}

type FormItemContextValue = {
  id: string
}

const FormItemContext = React.createContext<FormItemContextValue>(
  {} as FormItemContextValue
)

const FormItem = React.forwardRef<
  HTMLDivElement,
  React.HTMLAttributes<HTMLDivElement>
>(({ className, ...props }, ref) => {
  const id = React.useId()

  return (
    <FormItemContext.Provider value={{ id }}>
      <div ref={ref} className={cn("space-y-2", className)} {...props} />
    </FormItemContext.Provider>
  )
})
FormItem.displayName = "FormItem"

const FormLabel = React.forwardRef<
  React.ElementRef<typeof LabelPrimitive.Root>,
  React.ComponentPropsWithoutRef<typeof LabelPrimitive.Root>
>(({ className, ...props }, ref) => {
  const { error, formItemId } = useFormField()

  return (
    <Label
      ref={ref}
      className={cn(error && "text-destructive", className)}
      htmlFor={formItemId}
      {...props}
    />
  )
})
FormLabel.displayName = "FormLabel"

const FormControl = React.forwardRef<
  React.ElementRef<typeof Slot>,
  React.ComponentPropsWithoutRef<typeof Slot>
>(({ ...props }, ref) => {
  const { error, formItemId, formDescriptionId, formMessageId } = useFormField()

  return (
    <Slot
      ref={ref}
      id={formItemId}
      aria-describedby={
        !error
          ? `${formDescriptionId}`
          : `${formDescriptionId} ${formMessageId}`
      }
      aria-invalid={!!error}
      {...props}
    />
  )
})
FormControl.displayName = "FormControl"

const FormDescription = React.forwardRef<
  HTMLParagraphElement,
  React.HTMLAttributes<HTMLParagraphElement>
>(({ className, ...props }, ref) => {
  const { formDescriptionId } = useFormField()

  return (
    <p
      ref={ref}
      id={formDescriptionId}
      className={cn("text-sm text-muted-foreground", className)}
      {...props}
    />
  )
})
FormDescription.displayName = "FormDescription"

const FormMessage = React.forwardRef<
  HTMLParagraphElement,
  React.HTMLAttributes<HTMLParagraphElement>
>(({ className, children, ...props }, ref) => {
  const { error, formMessageId } = useFormField()
  const body = error ? String(error?.message ?? "") : children

  if (!body) {
    return null
  }

  return (
    <p
      ref={ref}
      id={formMessageId}
      className={cn("text-sm font-medium text-destructive", className)}
      {...props}
    >
      {body}
    </p>
  )
})
FormMessage.displayName = "FormMessage"

export {
  useFormField,
  Form,
  FormItem,
  FormLabel,
  FormControl,
  FormDescription,
  FormMessage,
  FormField,
}
</file>

<file path="src/components/ui/input.tsx">
import * as React from "react"

import { cn } from "@/lib/utils"

const Input = React.forwardRef<HTMLInputElement, React.ComponentProps<"input">>(
  ({ className, type, ...props }, ref) => {
    return (
      <input
        type={type}
        className={cn(
          "flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-base ring-offset-background file:border-0 file:bg-transparent file:text-sm file:font-medium file:text-foreground placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 md:text-sm",
          className
        )}
        ref={ref}
        {...props}
      />
    )
  }
)
Input.displayName = "Input"

export { Input }
</file>

<file path="src/components/ui/label.tsx">
"use client"

import * as React from "react"
import * as LabelPrimitive from "@radix-ui/react-label"
import { cva, type VariantProps } from "class-variance-authority"

import { cn } from "@/lib/utils"

const labelVariants = cva(
  "text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70"
)

const Label = React.forwardRef<
  React.ElementRef<typeof LabelPrimitive.Root>,
  React.ComponentPropsWithoutRef<typeof LabelPrimitive.Root> &
    VariantProps<typeof labelVariants>
>(({ className, ...props }, ref) => (
  <LabelPrimitive.Root
    ref={ref}
    className={cn(labelVariants(), className)}
    {...props}
  />
))
Label.displayName = LabelPrimitive.Root.displayName

export { Label }
</file>

<file path="src/components/ui/menubar.tsx">
"use client"

import * as React from "react"
import * as MenubarPrimitive from "@radix-ui/react-menubar"
import { Check, ChevronRight, Circle } from "lucide-react"

import { cn } from "@/lib/utils"

function MenubarMenu({
  ...props
}: React.ComponentProps<typeof MenubarPrimitive.Menu>) {
  return <MenubarPrimitive.Menu {...props} />
}

function MenubarGroup({
  ...props
}: React.ComponentProps<typeof MenubarPrimitive.Group>) {
  return <MenubarPrimitive.Group {...props} />
}

function MenubarPortal({
  ...props
}: React.ComponentProps<typeof MenubarPrimitive.Portal>) {
  return <MenubarPrimitive.Portal {...props} />
}

function MenubarRadioGroup({
  ...props
}: React.ComponentProps<typeof MenubarPrimitive.RadioGroup>) {
  return <MenubarPrimitive.RadioGroup {...props} />
}

function MenubarSub({
  ...props
}: React.ComponentProps<typeof MenubarPrimitive.Sub>) {
  return <MenubarPrimitive.Sub data-slot="menubar-sub" {...props} />
}

const Menubar = React.forwardRef<
  React.ElementRef<typeof MenubarPrimitive.Root>,
  React.ComponentPropsWithoutRef<typeof MenubarPrimitive.Root>
>(({ className, ...props }, ref) => (
  <MenubarPrimitive.Root
    ref={ref}
    className={cn(
      "flex h-10 items-center space-x-1 rounded-md border bg-background p-1",
      className
    )}
    {...props}
  />
))
Menubar.displayName = MenubarPrimitive.Root.displayName

const MenubarTrigger = React.forwardRef<
  React.ElementRef<typeof MenubarPrimitive.Trigger>,
  React.ComponentPropsWithoutRef<typeof MenubarPrimitive.Trigger>
>(({ className, ...props }, ref) => (
  <MenubarPrimitive.Trigger
    ref={ref}
    className={cn(
      "flex cursor-default select-none items-center rounded-sm px-3 py-1.5 text-sm font-medium outline-none focus:bg-accent focus:text-accent-foreground data-[state=open]:bg-accent data-[state=open]:text-accent-foreground",
      className
    )}
    {...props}
  />
))
MenubarTrigger.displayName = MenubarPrimitive.Trigger.displayName

const MenubarSubTrigger = React.forwardRef<
  React.ElementRef<typeof MenubarPrimitive.SubTrigger>,
  React.ComponentPropsWithoutRef<typeof MenubarPrimitive.SubTrigger> & {
    inset?: boolean
  }
>(({ className, inset, children, ...props }, ref) => (
  <MenubarPrimitive.SubTrigger
    ref={ref}
    className={cn(
      "flex cursor-default select-none items-center rounded-sm px-2 py-1.5 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[state=open]:bg-accent data-[state=open]:text-accent-foreground",
      inset && "pl-8",
      className
    )}
    {...props}
  >
    {children}
    <ChevronRight className="ml-auto h-4 w-4" />
  </MenubarPrimitive.SubTrigger>
))
MenubarSubTrigger.displayName = MenubarPrimitive.SubTrigger.displayName

const MenubarSubContent = React.forwardRef<
  React.ElementRef<typeof MenubarPrimitive.SubContent>,
  React.ComponentPropsWithoutRef<typeof MenubarPrimitive.SubContent>
>(({ className, ...props }, ref) => (
  <MenubarPrimitive.SubContent
    ref={ref}
    className={cn(
      "z-50 min-w-[8rem] overflow-hidden rounded-md border bg-popover p-1 text-popover-foreground data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",
      className
    )}
    {...props}
  />
))
MenubarSubContent.displayName = MenubarPrimitive.SubContent.displayName

const MenubarContent = React.forwardRef<
  React.ElementRef<typeof MenubarPrimitive.Content>,
  React.ComponentPropsWithoutRef<typeof MenubarPrimitive.Content>
>(
  (
    { className, align = "start", alignOffset = -4, sideOffset = 8, ...props },
    ref
  ) => (
    <MenubarPrimitive.Portal>
      <MenubarPrimitive.Content
        ref={ref}
        align={align}
        alignOffset={alignOffset}
        sideOffset={sideOffset}
        className={cn(
          "z-50 min-w-[12rem] overflow-hidden rounded-md border bg-popover p-1 text-popover-foreground shadow-md data-[state=open]:animate-in data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",
          className
        )}
        {...props}
      />
    </MenubarPrimitive.Portal>
  )
)
MenubarContent.displayName = MenubarPrimitive.Content.displayName

const MenubarItem = React.forwardRef<
  React.ElementRef<typeof MenubarPrimitive.Item>,
  React.ComponentPropsWithoutRef<typeof MenubarPrimitive.Item> & {
    inset?: boolean
  }
>(({ className, inset, ...props }, ref) => (
  <MenubarPrimitive.Item
    ref={ref}
    className={cn(
      "relative flex cursor-default select-none items-center rounded-sm px-2 py-1.5 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",
      inset && "pl-8",
      className
    )}
    {...props}
  />
))
MenubarItem.displayName = MenubarPrimitive.Item.displayName

const MenubarCheckboxItem = React.forwardRef<
  React.ElementRef<typeof MenubarPrimitive.CheckboxItem>,
  React.ComponentPropsWithoutRef<typeof MenubarPrimitive.CheckboxItem>
>(({ className, children, checked, ...props }, ref) => (
  <MenubarPrimitive.CheckboxItem
    ref={ref}
    className={cn(
      "relative flex cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",
      className
    )}
    checked={checked}
    {...props}
  >
    <span className="absolute left-2 flex h-3.5 w-3.5 items-center justify-center">
      <MenubarPrimitive.ItemIndicator>
        <Check className="h-4 w-4" />
      </MenubarPrimitive.ItemIndicator>
    </span>
    {children}
  </MenubarPrimitive.CheckboxItem>
))
MenubarCheckboxItem.displayName = MenubarPrimitive.CheckboxItem.displayName

const MenubarRadioItem = React.forwardRef<
  React.ElementRef<typeof MenubarPrimitive.RadioItem>,
  React.ComponentPropsWithoutRef<typeof MenubarPrimitive.RadioItem>
>(({ className, children, ...props }, ref) => (
  <MenubarPrimitive.RadioItem
    ref={ref}
    className={cn(
      "relative flex cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",
      className
    )}
    {...props}
  >
    <span className="absolute left-2 flex h-3.5 w-3.5 items-center justify-center">
      <MenubarPrimitive.ItemIndicator>
        <Circle className="h-2 w-2 fill-current" />
      </MenubarPrimitive.ItemIndicator>
    </span>
    {children}
  </MenubarPrimitive.RadioItem>
))
MenubarRadioItem.displayName = MenubarPrimitive.RadioItem.displayName

const MenubarLabel = React.forwardRef<
  React.ElementRef<typeof MenubarPrimitive.Label>,
  React.ComponentPropsWithoutRef<typeof MenubarPrimitive.Label> & {
    inset?: boolean
  }
>(({ className, inset, ...props }, ref) => (
  <MenubarPrimitive.Label
    ref={ref}
    className={cn(
      "px-2 py-1.5 text-sm font-semibold",
      inset && "pl-8",
      className
    )}
    {...props}
  />
))
MenubarLabel.displayName = MenubarPrimitive.Label.displayName

const MenubarSeparator = React.forwardRef<
  React.ElementRef<typeof MenubarPrimitive.Separator>,
  React.ComponentPropsWithoutRef<typeof MenubarPrimitive.Separator>
>(({ className, ...props }, ref) => (
  <MenubarPrimitive.Separator
    ref={ref}
    className={cn("-mx-1 my-1 h-px bg-muted", className)}
    {...props}
  />
))
MenubarSeparator.displayName = MenubarPrimitive.Separator.displayName

const MenubarShortcut = ({
  className,
  ...props
}: React.HTMLAttributes<HTMLSpanElement>) => {
  return (
    <span
      className={cn(
        "ml-auto text-xs tracking-widest text-muted-foreground",
        className
      )}
      {...props}
    />
  )
}
MenubarShortcut.displayname = "MenubarShortcut"

export {
  Menubar,
  MenubarMenu,
  MenubarTrigger,
  MenubarContent,
  MenubarItem,
  MenubarSeparator,
  MenubarLabel,
  MenubarCheckboxItem,
  MenubarRadioGroup,
  MenubarRadioItem,
  MenubarPortal,
  MenubarSubContent,
  MenubarSubTrigger,
  MenubarGroup,
  MenubarSub,
  MenubarShortcut,
}
</file>

<file path="src/components/ui/popover.tsx">
"use client"

import * as React from "react"
import * as PopoverPrimitive from "@radix-ui/react-popover"

import { cn } from "@/lib/utils"

const Popover = PopoverPrimitive.Root

const PopoverTrigger = PopoverPrimitive.Trigger

const PopoverContent = React.forwardRef<
  React.ElementRef<typeof PopoverPrimitive.Content>,
  React.ComponentPropsWithoutRef<typeof PopoverPrimitive.Content>
>(({ className, align = "center", sideOffset = 4, ...props }, ref) => (
  <PopoverPrimitive.Portal>
    <PopoverPrimitive.Content
      ref={ref}
      align={align}
      sideOffset={sideOffset}
      className={cn(
        "z-50 w-72 rounded-md border bg-popover p-4 text-popover-foreground shadow-md outline-none data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",
        className
      )}
      {...props}
    />
  </PopoverPrimitive.Portal>
))
PopoverContent.displayName = PopoverPrimitive.Content.displayName

export { Popover, PopoverTrigger, PopoverContent }
</file>

<file path="src/components/ui/progress.tsx">
"use client"

import * as React from "react"
import * as ProgressPrimitive from "@radix-ui/react-progress"

import { cn } from "@/lib/utils"

const Progress = React.forwardRef<
  React.ElementRef<typeof ProgressPrimitive.Root>,
  React.ComponentPropsWithoutRef<typeof ProgressPrimitive.Root>
>(({ className, value, ...props }, ref) => (
  <ProgressPrimitive.Root
    ref={ref}
    className={cn(
      "relative h-4 w-full overflow-hidden rounded-full bg-secondary",
      className
    )}
    {...props}
  >
    <ProgressPrimitive.Indicator
      className="h-full w-full flex-1 bg-primary transition-all"
      style={{ transform: `translateX(-${100 - (value || 0)}%)` }}
    />
  </ProgressPrimitive.Root>
))
Progress.displayName = ProgressPrimitive.Root.displayName

export { Progress }
</file>

<file path="src/components/ui/radio-group.tsx">
"use client"

import * as React from "react"
import * as RadioGroupPrimitive from "@radix-ui/react-radio-group"
import { Circle } from "lucide-react"

import { cn } from "@/lib/utils"

const RadioGroup = React.forwardRef<
  React.ElementRef<typeof RadioGroupPrimitive.Root>,
  React.ComponentPropsWithoutRef<typeof RadioGroupPrimitive.Root>
>(({ className, ...props }, ref) => {
  return (
    <RadioGroupPrimitive.Root
      className={cn("grid gap-2", className)}
      {...props}
      ref={ref}
    />
  )
})
RadioGroup.displayName = RadioGroupPrimitive.Root.displayName

const RadioGroupItem = React.forwardRef<
  React.ElementRef<typeof RadioGroupPrimitive.Item>,
  React.ComponentPropsWithoutRef<typeof RadioGroupPrimitive.Item>
>(({ className, ...props }, ref) => {
  return (
    <RadioGroupPrimitive.Item
      ref={ref}
      className={cn(
        "aspect-square h-4 w-4 rounded-full border border-primary text-primary ring-offset-background focus:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50",
        className
      )}
      {...props}
    >
      <RadioGroupPrimitive.Indicator className="flex items-center justify-center">
        <Circle className="h-2.5 w-2.5 fill-current text-current" />
      </RadioGroupPrimitive.Indicator>
    </RadioGroupPrimitive.Item>
  )
})
RadioGroupItem.displayName = RadioGroupPrimitive.Item.displayName

export { RadioGroup, RadioGroupItem }
</file>

<file path="src/components/ui/scroll-area.tsx">
"use client"

import * as React from "react"
import * as ScrollAreaPrimitive from "@radix-ui/react-scroll-area"

import { cn } from "@/lib/utils"

const ScrollArea = React.forwardRef<
  React.ElementRef<typeof ScrollAreaPrimitive.Root>,
  React.ComponentPropsWithoutRef<typeof ScrollAreaPrimitive.Root>
>(({ className, children, ...props }, ref) => (
  <ScrollAreaPrimitive.Root
    ref={ref}
    className={cn("relative overflow-hidden", className)}
    {...props}
  >
    <ScrollAreaPrimitive.Viewport className="h-full w-full rounded-[inherit]">
      {children}
    </ScrollAreaPrimitive.Viewport>
    <ScrollBar />
    <ScrollAreaPrimitive.Corner />
  </ScrollAreaPrimitive.Root>
))
ScrollArea.displayName = ScrollAreaPrimitive.Root.displayName

const ScrollBar = React.forwardRef<
  React.ElementRef<typeof ScrollAreaPrimitive.ScrollAreaScrollbar>,
  React.ComponentPropsWithoutRef<typeof ScrollAreaPrimitive.ScrollAreaScrollbar>
>(({ className, orientation = "vertical", ...props }, ref) => (
  <ScrollAreaPrimitive.ScrollAreaScrollbar
    ref={ref}
    orientation={orientation}
    className={cn(
      "flex touch-none select-none transition-colors",
      orientation === "vertical" &&
        "h-full w-2.5 border-l border-l-transparent p-[1px]",
      orientation === "horizontal" &&
        "h-2.5 flex-col border-t border-t-transparent p-[1px]",
      className
    )}
    {...props}
  >
    <ScrollAreaPrimitive.ScrollAreaThumb className="relative flex-1 rounded-full bg-border" />
  </ScrollAreaPrimitive.ScrollAreaScrollbar>
))
ScrollBar.displayName = ScrollAreaPrimitive.ScrollAreaScrollbar.displayName

export { ScrollArea, ScrollBar }
</file>

<file path="src/components/ui/select.tsx">
"use client"

import * as React from "react"
import * as SelectPrimitive from "@radix-ui/react-select"
import { Check, ChevronDown, ChevronUp } from "lucide-react"

import { cn } from "@/lib/utils"

const Select = SelectPrimitive.Root

const SelectGroup = SelectPrimitive.Group

const SelectValue = SelectPrimitive.Value

const SelectTrigger = React.forwardRef<
  React.ElementRef<typeof SelectPrimitive.Trigger>,
  React.ComponentPropsWithoutRef<typeof SelectPrimitive.Trigger>
>(({ className, children, ...props }, ref) => (
  <SelectPrimitive.Trigger
    ref={ref}
    className={cn(
      "flex h-10 w-full items-center justify-between rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background placeholder:text-muted-foreground focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 [&>span]:line-clamp-1",
      className
    )}
    {...props}
  >
    {children}
    <SelectPrimitive.Icon asChild>
      <ChevronDown className="h-4 w-4 opacity-50" />
    </SelectPrimitive.Icon>
  </SelectPrimitive.Trigger>
))
SelectTrigger.displayName = SelectPrimitive.Trigger.displayName

const SelectScrollUpButton = React.forwardRef<
  React.ElementRef<typeof SelectPrimitive.ScrollUpButton>,
  React.ComponentPropsWithoutRef<typeof SelectPrimitive.ScrollUpButton>
>(({ className, ...props }, ref) => (
  <SelectPrimitive.ScrollUpButton
    ref={ref}
    className={cn(
      "flex cursor-default items-center justify-center py-1",
      className
    )}
    {...props}
  >
    <ChevronUp className="h-4 w-4" />
  </SelectPrimitive.ScrollUpButton>
))
SelectScrollUpButton.displayName = SelectPrimitive.ScrollUpButton.displayName

const SelectScrollDownButton = React.forwardRef<
  React.ElementRef<typeof SelectPrimitive.ScrollDownButton>,
  React.ComponentPropsWithoutRef<typeof SelectPrimitive.ScrollDownButton>
>(({ className, ...props }, ref) => (
  <SelectPrimitive.ScrollDownButton
    ref={ref}
    className={cn(
      "flex cursor-default items-center justify-center py-1",
      className
    )}
    {...props}
  >
    <ChevronDown className="h-4 w-4" />
  </SelectPrimitive.ScrollDownButton>
))
SelectScrollDownButton.displayName =
  SelectPrimitive.ScrollDownButton.displayName

const SelectContent = React.forwardRef<
  React.ElementRef<typeof SelectPrimitive.Content>,
  React.ComponentPropsWithoutRef<typeof SelectPrimitive.Content>
>(({ className, children, position = "popper", ...props }, ref) => (
  <SelectPrimitive.Portal>
    <SelectPrimitive.Content
      ref={ref}
      className={cn(
        "relative z-50 max-h-96 min-w-[8rem] overflow-hidden rounded-md border bg-popover text-popover-foreground shadow-md data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",
        position === "popper" &&
          "data-[side=bottom]:translate-y-1 data-[side=left]:-translate-x-1 data-[side=right]:translate-x-1 data-[side=top]:-translate-y-1",
        className
      )}
      position={position}
      {...props}
    >
      <SelectScrollUpButton />
      <SelectPrimitive.Viewport
        className={cn(
          "p-1",
          position === "popper" &&
            "h-[var(--radix-select-trigger-height)] w-full min-w-[var(--radix-select-trigger-width)]"
        )}
      >
        {children}
      </SelectPrimitive.Viewport>
      <SelectScrollDownButton />
    </SelectPrimitive.Content>
  </SelectPrimitive.Portal>
))
SelectContent.displayName = SelectPrimitive.Content.displayName

const SelectLabel = React.forwardRef<
  React.ElementRef<typeof SelectPrimitive.Label>,
  React.ComponentPropsWithoutRef<typeof SelectPrimitive.Label>
>(({ className, ...props }, ref) => (
  <SelectPrimitive.Label
    ref={ref}
    className={cn("py-1.5 pl-8 pr-2 text-sm font-semibold", className)}
    {...props}
  />
))
SelectLabel.displayName = SelectPrimitive.Label.displayName

const SelectItem = React.forwardRef<
  React.ElementRef<typeof SelectPrimitive.Item>,
  React.ComponentPropsWithoutRef<typeof SelectPrimitive.Item>
>(({ className, children, ...props }, ref) => (
  <SelectPrimitive.Item
    ref={ref}
    className={cn(
      "relative flex w-full cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",
      className
    )}
    {...props}
  >
    <span className="absolute left-2 flex h-3.5 w-3.5 items-center justify-center">
      <SelectPrimitive.ItemIndicator>
        <Check className="h-4 w-4" />
      </SelectPrimitive.ItemIndicator>
    </span>

    <SelectPrimitive.ItemText>{children}</SelectPrimitive.ItemText>
  </SelectPrimitive.Item>
))
SelectItem.displayName = SelectPrimitive.Item.displayName

const SelectSeparator = React.forwardRef<
  React.ElementRef<typeof SelectPrimitive.Separator>,
  React.ComponentPropsWithoutRef<typeof SelectPrimitive.Separator>
>(({ className, ...props }, ref) => (
  <SelectPrimitive.Separator
    ref={ref}
    className={cn("-mx-1 my-1 h-px bg-muted", className)}
    {...props}
  />
))
SelectSeparator.displayName = SelectPrimitive.Separator.displayName

export {
  Select,
  SelectGroup,
  SelectValue,
  SelectTrigger,
  SelectContent,
  SelectLabel,
  SelectItem,
  SelectSeparator,
  SelectScrollUpButton,
  SelectScrollDownButton,
}
</file>

<file path="src/components/ui/separator.tsx">
"use client"

import * as React from "react"
import * as SeparatorPrimitive from "@radix-ui/react-separator"

import { cn } from "@/lib/utils"

const Separator = React.forwardRef<
  React.ElementRef<typeof SeparatorPrimitive.Root>,
  React.ComponentPropsWithoutRef<typeof SeparatorPrimitive.Root>
>(
  (
    { className, orientation = "horizontal", decorative = true, ...props },
    ref
  ) => (
    <SeparatorPrimitive.Root
      ref={ref}
      decorative={decorative}
      orientation={orientation}
      className={cn(
        "shrink-0 bg-border",
        orientation === "horizontal" ? "h-[1px] w-full" : "h-full w-[1px]",
        className
      )}
      {...props}
    />
  )
)
Separator.displayName = SeparatorPrimitive.Root.displayName

export { Separator }
</file>

<file path="src/components/ui/sheet.tsx">
"use client"

import * as React from "react"
import * as SheetPrimitive from "@radix-ui/react-dialog"
import { cva, type VariantProps } from "class-variance-authority"
import { X } from "lucide-react"

import { cn } from "@/lib/utils"

const Sheet = SheetPrimitive.Root

const SheetTrigger = SheetPrimitive.Trigger

const SheetClose = SheetPrimitive.Close

const SheetPortal = SheetPrimitive.Portal

const SheetOverlay = React.forwardRef<
  React.ElementRef<typeof SheetPrimitive.Overlay>,
  React.ComponentPropsWithoutRef<typeof SheetPrimitive.Overlay>
>(({ className, ...props }, ref) => (
  <SheetPrimitive.Overlay
    className={cn(
      "fixed inset-0 z-50 bg-black/80  data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0",
      className
    )}
    {...props}
    ref={ref}
  />
))
SheetOverlay.displayName = SheetPrimitive.Overlay.displayName

const sheetVariants = cva(
  "fixed z-50 gap-4 bg-background p-6 shadow-lg transition ease-in-out data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:duration-300 data-[state=open]:duration-500",
  {
    variants: {
      side: {
        top: "inset-x-0 top-0 border-b data-[state=closed]:slide-out-to-top data-[state=open]:slide-in-from-top",
        bottom:
          "inset-x-0 bottom-0 border-t data-[state=closed]:slide-out-to-bottom data-[state=open]:slide-in-from-bottom",
        left: "inset-y-0 left-0 h-full w-3/4 border-r data-[state=closed]:slide-out-to-left data-[state=open]:slide-in-from-left sm:max-w-sm",
        right:
          "inset-y-0 right-0 h-full w-3/4  border-l data-[state=closed]:slide-out-to-right data-[state=open]:slide-in-from-right sm:max-w-sm",
      },
    },
    defaultVariants: {
      side: "right",
    },
  }
)

interface SheetContentProps
  extends React.ComponentPropsWithoutRef<typeof SheetPrimitive.Content>,
    VariantProps<typeof sheetVariants> {}

const SheetContent = React.forwardRef<
  React.ElementRef<typeof SheetPrimitive.Content>,
  SheetContentProps
>(({ side = "right", className, children, ...props }, ref) => (
  <SheetPortal>
    <SheetOverlay />
    <SheetPrimitive.Content
      ref={ref}
      className={cn(sheetVariants({ side }), className)}
      {...props}
    >
      {children}
      <SheetPrimitive.Close className="absolute right-4 top-4 rounded-sm opacity-70 ring-offset-background transition-opacity hover:opacity-100 focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none data-[state=open]:bg-secondary">
        <X className="h-4 w-4" />
        <span className="sr-only">Close</span>
      </SheetPrimitive.Close>
    </SheetPrimitive.Content>
  </SheetPortal>
))
SheetContent.displayName = SheetPrimitive.Content.displayName

const SheetHeader = ({
  className,
  ...props
}: React.HTMLAttributes<HTMLDivElement>) => (
  <div
    className={cn(
      "flex flex-col space-y-2 text-center sm:text-left",
      className
    )}
    {...props}
  />
)
SheetHeader.displayName = "SheetHeader"

const SheetFooter = ({
  className,
  ...props
}: React.HTMLAttributes<HTMLDivElement>) => (
  <div
    className={cn(
      "flex flex-col-reverse sm:flex-row sm:justify-end sm:space-x-2",
      className
    )}
    {...props}
  />
)
SheetFooter.displayName = "SheetFooter"

const SheetTitle = React.forwardRef<
  React.ElementRef<typeof SheetPrimitive.Title>,
  React.ComponentPropsWithoutRef<typeof SheetPrimitive.Title>
>(({ className, ...props }, ref) => (
  <SheetPrimitive.Title
    ref={ref}
    className={cn("text-lg font-semibold text-foreground", className)}
    {...props}
  />
))
SheetTitle.displayName = SheetPrimitive.Title.displayName

const SheetDescription = React.forwardRef<
  React.ElementRef<typeof SheetPrimitive.Description>,
  React.ComponentPropsWithoutRef<typeof SheetPrimitive.Description>
>(({ className, ...props }, ref) => (
  <SheetPrimitive.Description
    ref={ref}
    className={cn("text-sm text-muted-foreground", className)}
    {...props}
  />
))
SheetDescription.displayName = SheetPrimitive.Description.displayName

export {
  Sheet,
  SheetPortal,
  SheetOverlay,
  SheetTrigger,
  SheetClose,
  SheetContent,
  SheetHeader,
  SheetFooter,
  SheetTitle,
  SheetDescription,
}
</file>

<file path="src/components/ui/sidebar.tsx">
"use client"

import * as React from "react"
import { Slot } from "@radix-ui/react-slot"
import { VariantProps, cva } from "class-variance-authority"
import { PanelLeft } from "lucide-react"

import { useIsMobile } from "@/hooks/use-mobile"
import { cn } from "@/lib/utils"
import { Button } from "@/components/ui/button"
import { Input } from "@/components/ui/input"
import { Separator } from "@/components/ui/separator"
import {
  Sheet,
  SheetContent,
  SheetHeader,
  SheetTitle,
  SheetDescription,
} from "@/components/ui/sheet"
import { Skeleton } from "@/components/ui/skeleton"
import {
  Tooltip,
  TooltipContent,
  TooltipProvider,
  TooltipTrigger,
} from "@/components/ui/tooltip"

const SIDEBAR_COOKIE_NAME = "sidebar_state"
const SIDEBAR_COOKIE_MAX_AGE = 60 * 60 * 24 * 7
const SIDEBAR_WIDTH = "16rem"
const SIDEBAR_WIDTH_MOBILE = "18rem"
const SIDEBAR_WIDTH_ICON = "3rem"
const SIDEBAR_KEYBOARD_SHORTCUT = "b"

type SidebarContext = {
  state: "expanded" | "collapsed"
  open: boolean
  setOpen: (open: boolean) => void
  openMobile: boolean
  setOpenMobile: (open: boolean) => void
  isMobile: boolean
  toggleSidebar: () => void
}

const SidebarContext = React.createContext<SidebarContext | null>(null)

function useSidebar() {
  const context = React.useContext(SidebarContext)
  if (!context) {
    throw new Error("useSidebar must be used within a SidebarProvider.")
  }

  return context
}

const SidebarProvider = React.forwardRef<
  HTMLDivElement,
  React.ComponentProps<"div"> & {
    defaultOpen?: boolean
    open?: boolean
    onOpenChange?: (open: boolean) => void
  }
>(
  (
    {
      defaultOpen = true,
      open: openProp,
      onOpenChange: setOpenProp,
      className,
      style,
      children,
      ...props
    },
    ref
  ) => {
    const isMobile = useIsMobile()
    const [openMobile, setOpenMobile] = React.useState(false)

    // This is the internal state of the sidebar.
    // We use openProp and setOpenProp for control from outside the component.
    const [_open, _setOpen] = React.useState(defaultOpen)
    const open = openProp ?? _open
    const setOpen = React.useCallback(
      (value: boolean | ((value: boolean) => boolean)) => {
        const openState = typeof value === "function" ? value(open) : value
        if (setOpenProp) {
          setOpenProp(openState)
        } else {
          _setOpen(openState)
        }

        // This sets the cookie to keep the sidebar state.
        document.cookie = `${SIDEBAR_COOKIE_NAME}=${openState}; path=/; max-age=${SIDEBAR_COOKIE_MAX_AGE}`
      },
      [setOpenProp, open]
    )

    // Helper to toggle the sidebar.
    const toggleSidebar = React.useCallback(() => {
      return isMobile
        ? setOpenMobile((open) => !open)
        : setOpen((open) => !open)
    }, [isMobile, setOpen, setOpenMobile])

    // Adds a keyboard shortcut to toggle the sidebar.
    React.useEffect(() => {
      const handleKeyDown = (event: KeyboardEvent) => {
        if (
          event.key === SIDEBAR_KEYBOARD_SHORTCUT &&
          (event.metaKey || event.ctrlKey)
        ) {
          event.preventDefault()
          toggleSidebar()
        }
      }

      window.addEventListener("keydown", handleKeyDown)
      return () => window.removeEventListener("keydown", handleKeyDown)
    }, [toggleSidebar])

    // We add a state so that we can do data-state="expanded" or "collapsed".
    // This makes it easier to style the sidebar with Tailwind classes.
    const state = open ? "expanded" : "collapsed"

    const contextValue = React.useMemo<SidebarContext>(
      () => ({
        state,
        open,
        setOpen,
        isMobile,
        openMobile,
        setOpenMobile,
        toggleSidebar,
      }),
      [state, open, setOpen, isMobile, openMobile, setOpenMobile, toggleSidebar]
    )

    return (
      <SidebarContext.Provider value={contextValue}>
        <TooltipProvider delayDuration={0}>
          <div
            style={
              {
                "--sidebar-width": SIDEBAR_WIDTH,
                "--sidebar-width-icon": SIDEBAR_WIDTH_ICON,
                ...style,
              } as React.CSSProperties
            }
            className={cn(
              "group/sidebar-wrapper flex min-h-svh w-full has-[[data-variant=inset]]:bg-sidebar",
              className
            )}
            ref={ref}
            {...props}
          >
            {children}
          </div>
        </TooltipProvider>
      </SidebarContext.Provider>
    )
  }
)
SidebarProvider.displayName = "SidebarProvider"

const Sidebar = React.forwardRef<
  HTMLDivElement,
  React.ComponentProps<"div"> & {
    side?: "left" | "right"
    variant?: "sidebar" | "floating" | "inset"
    collapsible?: "offcanvas" | "icon" | "none"
  }
>(
  (
    {
      side = "left",
      variant = "sidebar",
      collapsible = "offcanvas",
      className,
      children,
      ...props
    },
    ref
  ) => {
    const { isMobile, state, openMobile, setOpenMobile } = useSidebar()

    if (collapsible === "none") {
      return (
        <div
          className={cn(
            "flex h-full w-[--sidebar-width] flex-col bg-sidebar text-sidebar-foreground",
            className
          )}
          ref={ref}
          {...props}
        >
          {children}
        </div>
      )
    }

    if (isMobile) {
      return (
        <Sheet open={openMobile} onOpenChange={setOpenMobile} {...props}>
          <SheetContent
            data-sidebar="sidebar"
            data-mobile="true"
            className="w-[--sidebar-width] bg-sidebar p-0 text-sidebar-foreground [&>button]:hidden"
            style={
              {
                "--sidebar-width": SIDEBAR_WIDTH_MOBILE,
              } as React.CSSProperties
            }
            side={side}
          >
            <SheetHeader className="sr-only">
              <SheetTitle>Sidebar Menu</SheetTitle>
              <SheetDescription>
                Navigation links for the admin panel.
              </SheetDescription>
            </SheetHeader>
            <div className="flex h-full w-full flex-col">{children}</div>
          </SheetContent>
        </Sheet>
      )
    }

    return (
      <div
        ref={ref}
        className="group peer hidden md:block text-sidebar-foreground"
        data-state={state}
        data-collapsible={state === "collapsed" ? collapsible : ""}
        data-variant={variant}
        data-side={side}
      >
        {/* This is what handles the sidebar gap on desktop */}
        <div
          className={cn(
            "duration-200 relative h-svh w-[--sidebar-width] bg-transparent transition-[width] ease-linear",
            "group-data-[collapsible=offcanvas]:w-0",
            "group-data-[side=right]:rotate-180",
            variant === "floating" || variant === "inset"
              ? "group-data-[collapsible=icon]:w-[calc(var(--sidebar-width-icon)_+_theme(spacing.4))]"
              : "group-data-[collapsible=icon]:w-[--sidebar-width-icon]"
          )}
        />
        <div
          className={cn(
            "duration-200 fixed inset-y-0 z-10 hidden h-svh w-[--sidebar-width] transition-[left,right,width] ease-linear md:flex",
            side === "left"
              ? "left-0 group-data-[collapsible=offcanvas]:left-[calc(var(--sidebar-width)*-1)]"
              : "right-0 group-data-[collapsible=offcanvas]:right-[calc(var(--sidebar-width)*-1)]",
            // Adjust the padding for floating and inset variants.
            variant === "floating" || variant === "inset"
              ? "p-2 group-data-[collapsible=icon]:w-[calc(var(--sidebar-width-icon)_+_theme(spacing.4)_+2px)]"
              : "group-data-[collapsible=icon]:w-[--sidebar-width-icon] group-data-[side=left]:border-r group-data-[side=right]:border-l",
            className
          )}
          {...props}
        >
          <div
            data-sidebar="sidebar"
            className="flex h-full w-full flex-col bg-sidebar group-data-[variant=floating]:rounded-lg group-data-[variant=floating]:border group-data-[variant=floating]:border-sidebar-border group-data-[variant=floating]:shadow"
          >
            {children}
          </div>
        </div>
      </div>
    )
  }
)
Sidebar.displayName = "Sidebar"

const SidebarTrigger = React.forwardRef<
  React.ElementRef<typeof Button>,
  React.ComponentProps<typeof Button>
>(({ className, onClick, ...props }, ref) => {
  const { toggleSidebar } = useSidebar()

  return (
    <Button
      ref={ref}
      data-sidebar="trigger"
      variant="ghost"
      size="icon"
      className={cn("h-7 w-7", className)}
      onClick={(event) => {
        onClick?.(event)
        toggleSidebar()
      }}
      {...props}
    >
      <PanelLeft />
      <span className="sr-only">Toggle Sidebar</span>
    </Button>
  )
})
SidebarTrigger.displayName = "SidebarTrigger"

const SidebarRail = React.forwardRef<
  HTMLButtonElement,
  React.ComponentProps<"button">
>(({ className, ...props }, ref) => {
  const { toggleSidebar } = useSidebar()

  return (
    <button
      ref={ref}
      data-sidebar="rail"
      aria-label="Toggle Sidebar"
      tabIndex={-1}
      onClick={toggleSidebar}
      title="Toggle Sidebar"
      className={cn(
        "absolute inset-y-0 z-20 hidden w-4 -translate-x-1/2 transition-all ease-linear after:absolute after:inset-y-0 after:left-1/2 after:w-[2px] hover:after:bg-sidebar-border group-data-[side=left]:-right-4 group-data-[side=right]:left-0 sm:flex",
        "[[data-side=left]_&]:cursor-w-resize [[data-side=right]_&]:cursor-e-resize",
        "[[data-side=left][data-state=collapsed]_&]:cursor-e-resize [[data-side=right][data-state=collapsed]_&]:cursor-w-resize",
        "group-data-[collapsible=offcanvas]:translate-x-0 group-data-[collapsible=offcanvas]:after:left-full group-data-[collapsible=offcanvas]:hover:bg-sidebar",
        "[[data-side=left][data-collapsible=offcanvas]_&]:-right-2",
        "[[data-side=right][data-collapsible=offcanvas]_&]:-left-2",
        className
      )}
      {...props}
    />
  )
})
SidebarRail.displayName = "SidebarRail"

const SidebarInset = React.forwardRef<
  HTMLDivElement,
  React.ComponentProps<"main">
>(({ className, ...props }, ref) => {
  return (
    <main
      ref={ref}
      className={cn(
        "relative flex min-h-svh flex-1 flex-col bg-background",
        "peer-data-[variant=inset]:min-h-[calc(100svh-theme(spacing.4))] md:peer-data-[variant=inset]:m-2 md:peer-data-[state=collapsed]:peer-data-[variant=inset]:ml-2 md:peer-data-[variant=inset]:ml-0 md:peer-data-[variant=inset]:rounded-xl md:peer-data-[variant=inset]:shadow",
        className
      )}
      {...props}
    />
  )
})
SidebarInset.displayName = "SidebarInset"

const SidebarInput = React.forwardRef<
  React.ElementRef<typeof Input>,
  React.ComponentProps<typeof Input>
>(({ className, ...props }, ref) => {
  return (
    <Input
      ref={ref}
      data-sidebar="input"
      className={cn(
        "h-8 w-full bg-background shadow-none focus-visible:ring-2 focus-visible:ring-sidebar-ring",
        className
      )}
      {...props}
    />
  )
})
SidebarInput.displayName = "SidebarInput"

const SidebarHeader = React.forwardRef<
  HTMLDivElement,
  React.ComponentProps<"div">
>(({ className, ...props }, ref) => {
  return (
    <div
      ref={ref}
      data-sidebar="header"
      className={cn("flex flex-col gap-2 p-2", className)}
      {...props}
    />
  )
})
SidebarHeader.displayName = "SidebarHeader"

const SidebarFooter = React.forwardRef<
  HTMLDivElement,
  React.ComponentProps<"div">
>(({ className, ...props }, ref) => {
  return (
    <div
      ref={ref}
      data-sidebar="footer"
      className={cn("flex flex-col gap-2 p-2", className)}
      {...props}
    />
  )
})
SidebarFooter.displayName = "SidebarFooter"

const SidebarSeparator = React.forwardRef<
  React.ElementRef<typeof Separator>,
  React.ComponentProps<typeof Separator>
>(({ className, ...props }, ref) => {
  return (
    <Separator
      ref={ref}
      data-sidebar="separator"
      className={cn("mx-2 w-auto bg-sidebar-border", className)}
      {...props}
    />
  )
})
SidebarSeparator.displayName = "SidebarSeparator"

const SidebarContent = React.forwardRef<
  HTMLDivElement,
  React.ComponentProps<"div">
>(({ className, ...props }, ref) => {
  return (
    <div
      ref={ref}
      data-sidebar="content"
      className={cn(
        "flex min-h-0 flex-1 flex-col gap-2 overflow-auto group-data-[collapsible=icon]:overflow-hidden",
        className
      )}
      {...props}
    />
  )
})
SidebarContent.displayName = "SidebarContent"

const SidebarGroup = React.forwardRef<
  HTMLDivElement,
  React.ComponentProps<"div">
>(({ className, ...props }, ref) => {
  return (
    <div
      ref={ref}
      data-sidebar="group"
      className={cn("relative flex w-full min-w-0 flex-col p-2", className)}
      {...props}
    />
  )
})
SidebarGroup.displayName = "SidebarGroup"

const SidebarGroupLabel = React.forwardRef<
  HTMLDivElement,
  React.ComponentProps<"div"> & { asChild?: boolean }
>(({ className, asChild = false, ...props }, ref) => {
  const Comp = asChild ? Slot : "div"

  return (
    <Comp
      ref={ref}
      data-sidebar="group-label"
      className={cn(
        "duration-200 flex h-8 shrink-0 items-center rounded-md px-2 text-xs font-medium text-sidebar-foreground/70 outline-none ring-sidebar-ring transition-[margin,opa] ease-linear focus-visible:ring-2 [&>svg]:size-4 [&>svg]:shrink-0",
        "group-data-[collapsible=icon]:-mt-8 group-data-[collapsible=icon]:opacity-0",
        className
      )}
      {...props}
    />
  )
})
SidebarGroupLabel.displayName = "SidebarGroupLabel"

const SidebarGroupAction = React.forwardRef<
  HTMLButtonElement,
  React.ComponentProps<"button"> & { asChild?: boolean }
>(({ className, asChild = false, ...props }, ref) => {
  const Comp = asChild ? Slot : "button"

  return (
    <Comp
      ref={ref}
      data-sidebar="group-action"
      className={cn(
        "absolute right-3 top-3.5 flex aspect-square w-5 items-center justify-center rounded-md p-0 text-sidebar-foreground outline-none ring-sidebar-ring transition-transform hover:bg-sidebar-accent hover:text-sidebar-accent-foreground focus-visible:ring-2 [&>svg]:size-4 [&>svg]:shrink-0",
        // Increases the hit area of the button on mobile.
        "after:absolute after:-inset-2 after:md:hidden",
        "group-data-[collapsible=icon]:hidden",
        className
      )}
      {...props}
    />
  )
})
SidebarGroupAction.displayName = "SidebarGroupAction"

const SidebarGroupContent = React.forwardRef<
  HTMLDivElement,
  React.ComponentProps<"div">
>(({ className, ...props }, ref) => (
  <div
    ref={ref}
    data-sidebar="group-content"
    className={cn("w-full text-sm", className)}
    {...props}
  />
))
SidebarGroupContent.displayName = "SidebarGroupContent"

const SidebarMenu = React.forwardRef<
  HTMLUListElement,
  React.ComponentProps<"ul">
>(({ className, ...props }, ref) => (
  <ul
    ref={ref}
    data-sidebar="menu"
    className={cn("flex w-full min-w-0 flex-col gap-1", className)}
    {...props}
  />
))
SidebarMenu.displayName = "SidebarMenu"

const SidebarMenuItem = React.forwardRef<
  HTMLLIElement,
  React.ComponentProps<"li">
>(({ className, ...props }, ref) => (
  <li
    ref={ref}
    data-sidebar="menu-item"
    className={cn("group/menu-item relative", className)}
    {...props}
  />
))
SidebarMenuItem.displayName = "SidebarMenuItem"

const sidebarMenuButtonVariants = cva(
  "peer/menu-button flex w-full items-center gap-2 overflow-hidden rounded-md p-2 text-left text-sm outline-none ring-sidebar-ring transition-[width,height,padding] hover:bg-sidebar-accent hover:text-sidebar-accent-foreground focus-visible:ring-2 active:bg-sidebar-accent active:text-sidebar-accent-foreground disabled:pointer-events-none disabled:opacity-50 group-has-[[data-sidebar=menu-action]]/menu-item:pr-8 aria-disabled:pointer-events-none aria-disabled:opacity-50 data-[active=true]:bg-sidebar-accent data-[active=true]:font-medium data-[active=true]:text-sidebar-accent-foreground data-[state=open]:hover:bg-sidebar-accent data-[state=open]:hover:text-sidebar-accent-foreground group-data-[collapsible=icon]:!size-8 group-data-[collapsible=icon]:!p-2 [&>span:last-child]:truncate [&>svg]:size-4 [&>svg]:shrink-0",
  {
    variants: {
      variant: {
        default: "hover:bg-sidebar-accent hover:text-sidebar-accent-foreground",
        outline:
          "bg-background shadow-[0_0_0_1px_hsl(var(--sidebar-border))] hover:bg-sidebar-accent hover:text-sidebar-accent-foreground hover:shadow-[0_0_0_1px_hsl(var(--sidebar-accent))]",
      },
      size: {
        default: "h-8 text-sm",
        sm: "h-7 text-xs",
        lg: "h-12 text-sm group-data-[collapsible=icon]:!p-0",
      },
    },
    defaultVariants: {
      variant: "default",
      size: "default",
    },
  }
)

const SidebarMenuButton = React.forwardRef<
  HTMLButtonElement,
  React.ComponentProps<"button"> & {
    asChild?: boolean
    isActive?: boolean
    tooltip?: string | React.ComponentProps<typeof TooltipContent>
  } & VariantProps<typeof sidebarMenuButtonVariants>
>(
  (
    {
      asChild = false,
      isActive = false,
      variant = "default",
      size = "default",
      tooltip,
      className,
      ...props
    },
    ref
  ) => {
    const Comp = asChild ? Slot : "button"
    const { isMobile, state } = useSidebar()

    const button = (
      <Comp
        ref={ref}
        data-sidebar="menu-button"
        data-size={size}
        data-active={isActive}
        className={cn(sidebarMenuButtonVariants({ variant, size }), className)}
        {...props}
      />
    )

    if (!tooltip) {
      return button
    }

    if (typeof tooltip === "string") {
      tooltip = {
        children: tooltip,
      }
    }

    return (
      <Tooltip>
        <TooltipTrigger asChild>{button}</TooltipTrigger>
        <TooltipContent
          side="right"
          align="center"
          hidden={state !== "collapsed" || isMobile}
          {...tooltip}
        />
      </Tooltip>
    )
  }
)
SidebarMenuButton.displayName = "SidebarMenuButton"

const SidebarMenuAction = React.forwardRef<
  HTMLButtonElement,
  React.ComponentProps<"button"> & {
    asChild?: boolean
    showOnHover?: boolean
  }
>(({ className, asChild = false, showOnHover = false, ...props }, ref) => {
  const Comp = asChild ? Slot : "button"

  return (
    <Comp
      ref={ref}
      data-sidebar="menu-action"
      className={cn(
        "absolute right-1 top-1.5 flex aspect-square w-5 items-center justify-center rounded-md p-0 text-sidebar-foreground outline-none ring-sidebar-ring transition-transform hover:bg-sidebar-accent hover:text-sidebar-accent-foreground focus-visible:ring-2 peer-hover/menu-button:text-sidebar-accent-foreground [&>svg]:size-4 [&>svg]:shrink-0",
        // Increases the hit area of the button on mobile.
        "after:absolute after:-inset-2 after:md:hidden",
        "peer-data-[size=sm]/menu-button:top-1",
        "peer-data-[size=default]/menu-button:top-1.5",
        "peer-data-[size=lg]/menu-button:top-2.5",
        "group-data-[collapsible=icon]:hidden",
        showOnHover &&
          "group-focus-within/menu-item:opacity-100 group-hover/menu-item:opacity-100 data-[state=open]:opacity-100 peer-data-[active=true]/menu-button:text-sidebar-accent-foreground md:opacity-0",
        className
      )}
      {...props}
    />
  )
})
SidebarMenuAction.displayName = "SidebarMenuAction"

const SidebarMenuBadge = React.forwardRef<
  HTMLDivElement,
  React.ComponentProps<"div">
>(({ className, ...props }, ref) => (
  <div
    ref={ref}
    data-sidebar="menu-badge"
    className={cn(
      "absolute right-1 flex h-5 min-w-5 items-center justify-center rounded-md px-1 text-xs font-medium tabular-nums text-sidebar-foreground select-none pointer-events-none",
      "peer-hover/menu-button:text-sidebar-accent-foreground peer-data-[active=true]/menu-button:text-sidebar-accent-foreground",
      "peer-data-[size=sm]/menu-button:top-1",
      "peer-data-[size=default]/menu-button:top-1.5",
      "peer-data-[size=lg]/menu-button:top-2.5",
      "group-data-[collapsible=icon]:hidden",
      className
    )}
    {...props}
  />
))
SidebarMenuBadge.displayName = "SidebarMenuBadge"

const SidebarMenuSkeleton = React.forwardRef<
  HTMLDivElement,
  React.ComponentProps<"div"> & {
    showIcon?: boolean
  }
>(({ className, showIcon = false, ...props }, ref) => {
  // Random width between 50 to 90%.
  const width = React.useMemo(() => {
    return `${Math.floor(Math.random() * 40) + 50}%`
  }, [])

  return (
    <div
      ref={ref}
      data-sidebar="menu-skeleton"
      className={cn("rounded-md h-8 flex gap-2 px-2 items-center", className)}
      {...props}
    >
      {showIcon && (
        <Skeleton
          className="size-4 rounded-md"
          data-sidebar="menu-skeleton-icon"
        />
      )}
      <Skeleton
        className="h-4 flex-1 max-w-[--skeleton-width]"
        data-sidebar="menu-skeleton-text"
        style={
          {
            "--skeleton-width": width,
          } as React.CSSProperties
        }
      />
    </div>
  )
})
SidebarMenuSkeleton.displayName = "SidebarMenuSkeleton"

const SidebarMenuSub = React.forwardRef<
  HTMLUListElement,
  React.ComponentProps<"ul">
>(({ className, ...props }, ref) => (
  <ul
    ref={ref}
    data-sidebar="menu-sub"
    className={cn(
      "mx-3.5 flex min-w-0 translate-x-px flex-col gap-1 border-l border-sidebar-border px-2.5 py-0.5",
      "group-data-[collapsible=icon]:hidden",
      className
    )}
    {...props}
  />
))
SidebarMenuSub.displayName = "SidebarMenuSub"

const SidebarMenuSubItem = React.forwardRef<
  HTMLLIElement,
  React.ComponentProps<"li">
>(({ ...props }, ref) => <li ref={ref} {...props} />)
SidebarMenuSubItem.displayName = "SidebarMenuSubItem"

const SidebarMenuSubButton = React.forwardRef<
  HTMLAnchorElement,
  React.ComponentProps<"a"> & {
    asChild?: boolean
    size?: "sm" | "md"
    isActive?: boolean
  }
>(({ asChild = false, size = "md", isActive, className, ...props }, ref) => {
  const Comp = asChild ? Slot : "a"

  return (
    <Comp
      ref={ref}
      data-sidebar="menu-sub-button"
      data-size={size}
      data-active={isActive}
      className={cn(
        "flex h-7 min-w-0 -translate-x-px items-center gap-2 overflow-hidden rounded-md px-2 text-sidebar-foreground outline-none ring-sidebar-ring hover:bg-sidebar-accent hover:text-sidebar-accent-foreground focus-visible:ring-2 active:bg-sidebar-accent active:text-sidebar-accent-foreground disabled:pointer-events-none disabled:opacity-50 aria-disabled:pointer-events-none aria-disabled:opacity-50 [&>span:last-child]:truncate [&>svg]:size-4 [&>svg]:shrink-0 [&>svg]:text-sidebar-accent-foreground",
        "data-[active=true]:bg-sidebar-accent data-[active=true]:text-sidebar-accent-foreground",
        size === "sm" && "text-xs",
        size === "md" && "text-sm",
        "group-data-[collapsible=icon]:hidden",
        className
      )}
      {...props}
    />
  )
})
SidebarMenuSubButton.displayName = "SidebarMenuSubButton"

export {
  Sidebar,
  SidebarContent,
  SidebarFooter,
  SidebarGroup,
  SidebarGroupAction,
  SidebarGroupContent,
  SidebarGroupLabel,
  SidebarHeader,
  SidebarInput,
  SidebarInset,
  SidebarMenu,
  SidebarMenuAction,
  SidebarMenuBadge,
  SidebarMenuButton,
  SidebarMenuItem,
  SidebarMenuSkeleton,
  SidebarMenuSub,
  SidebarMenuSubButton,
  SidebarMenuSubItem,
  SidebarProvider,
  SidebarRail,
  SidebarSeparator,
  SidebarTrigger,
  useSidebar,
}
</file>

<file path="src/components/ui/skeleton.tsx">
import { cn } from "@/lib/utils"

function Skeleton({
  className,
  ...props
}: React.HTMLAttributes<HTMLDivElement>) {
  return (
    <div
      className={cn("animate-pulse rounded-md bg-muted", className)}
      {...props}
    />
  )
}

export { Skeleton }
</file>

<file path="src/components/ui/slider.tsx">
"use client"

import * as React from "react"
import * as SliderPrimitive from "@radix-ui/react-slider"

import { cn } from "@/lib/utils"

const Slider = React.forwardRef<
  React.ElementRef<typeof SliderPrimitive.Root>,
  React.ComponentPropsWithoutRef<typeof SliderPrimitive.Root>
>(({ className, ...props }, ref) => (
  <SliderPrimitive.Root
    ref={ref}
    className={cn(
      "relative flex w-full touch-none select-none items-center",
      className
    )}
    {...props}
  >
    <SliderPrimitive.Track className="relative h-2 w-full grow overflow-hidden rounded-full bg-secondary">
      <SliderPrimitive.Range className="absolute h-full bg-primary" />
    </SliderPrimitive.Track>
    <SliderPrimitive.Thumb className="block h-5 w-5 rounded-full border-2 border-primary bg-background ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50" />
  </SliderPrimitive.Root>
))
Slider.displayName = SliderPrimitive.Root.displayName

export { Slider }
</file>

<file path="src/components/ui/switch.tsx">
"use client"

import * as React from "react"
import * as SwitchPrimitives from "@radix-ui/react-switch"

import { cn } from "@/lib/utils"

const Switch = React.forwardRef<
  React.ElementRef<typeof SwitchPrimitives.Root>,
  React.ComponentPropsWithoutRef<typeof SwitchPrimitives.Root>
>(({ className, ...props }, ref) => (
  <SwitchPrimitives.Root
    className={cn(
      "peer inline-flex h-6 w-11 shrink-0 cursor-pointer items-center rounded-full border-2 border-transparent transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 focus-visible:ring-offset-background disabled:cursor-not-allowed disabled:opacity-50 data-[state=checked]:bg-primary data-[state=unchecked]:bg-input",
      className
    )}
    {...props}
    ref={ref}
  >
    <SwitchPrimitives.Thumb
      className={cn(
        "pointer-events-none block h-5 w-5 rounded-full bg-background shadow-lg ring-0 transition-transform data-[state=checked]:translate-x-5 data-[state=unchecked]:translate-x-0"
      )}
    />
  </SwitchPrimitives.Root>
))
Switch.displayName = SwitchPrimitives.Root.displayName

export { Switch }
</file>

<file path="src/components/ui/table.tsx">
import * as React from "react"

import { cn } from "@/lib/utils"

const Table = React.forwardRef<
  HTMLTableElement,
  React.HTMLAttributes<HTMLTableElement>
>(({ className, ...props }, ref) => (
  <div className="relative w-full overflow-auto">
    <table
      ref={ref}
      className={cn("w-full caption-bottom text-sm", className)}
      {...props}
    />
  </div>
))
Table.displayName = "Table"

const TableHeader = React.forwardRef<
  HTMLTableSectionElement,
  React.HTMLAttributes<HTMLTableSectionElement>
>(({ className, ...props }, ref) => (
  <thead ref={ref} className={cn("[&_tr]:border-b", className)} {...props} />
))
TableHeader.displayName = "TableHeader"

const TableBody = React.forwardRef<
  HTMLTableSectionElement,
  React.HTMLAttributes<HTMLTableSectionElement>
>(({ className, ...props }, ref) => (
  <tbody
    ref={ref}
    className={cn("[&_tr:last-child]:border-0", className)}
    {...props}
  />
))
TableBody.displayName = "TableBody"

const TableFooter = React.forwardRef<
  HTMLTableSectionElement,
  React.HTMLAttributes<HTMLTableSectionElement>
>(({ className, ...props }, ref) => (
  <tfoot
    ref={ref}
    className={cn(
      "border-t bg-muted/50 font-medium [&>tr]:last:border-b-0",
      className
    )}
    {...props}
  />
))
TableFooter.displayName = "TableFooter"

const TableRow = React.forwardRef<
  HTMLTableRowElement,
  React.HTMLAttributes<HTMLTableRowElement>
>(({ className, ...props }, ref) => (
  <tr
    ref={ref}
    className={cn(
      "border-b transition-colors hover:bg-muted/50 data-[state=selected]:bg-muted",
      className
    )}
    {...props}
  />
))
TableRow.displayName = "TableRow"

const TableHead = React.forwardRef<
  HTMLTableCellElement,
  React.ThHTMLAttributes<HTMLTableCellElement>
>(({ className, ...props }, ref) => (
  <th
    ref={ref}
    className={cn(
      "h-12 px-4 text-left align-middle font-medium text-muted-foreground [&:has([role=checkbox])]:pr-0",
      className
    )}
    {...props}
  />
))
TableHead.displayName = "TableHead"

const TableCell = React.forwardRef<
  HTMLTableCellElement,
  React.TdHTMLAttributes<HTMLTableCellElement>
>(({ className, ...props }, ref) => (
  <td
    ref={ref}
    className={cn("p-4 align-middle [&:has([role=checkbox])]:pr-0", className)}
    {...props}
  />
))
TableCell.displayName = "TableCell"

const TableCaption = React.forwardRef<
  HTMLTableCaptionElement,
  React.HTMLAttributes<HTMLTableCaptionElement>
>(({ className, ...props }, ref) => (
  <caption
    ref={ref}
    className={cn("mt-4 text-sm text-muted-foreground", className)}
    {...props}
  />
))
TableCaption.displayName = "TableCaption"

export {
  Table,
  TableHeader,
  TableBody,
  TableFooter,
  TableHead,
  TableRow,
  TableCell,
  TableCaption,
}
</file>

<file path="src/components/ui/tabs.tsx">
"use client"

import * as React from "react"
import * as TabsPrimitive from "@radix-ui/react-tabs"

import { cn } from "@/lib/utils"

const Tabs = TabsPrimitive.Root

const TabsList = React.forwardRef<
  React.ElementRef<typeof TabsPrimitive.List>,
  React.ComponentPropsWithoutRef<typeof TabsPrimitive.List>
>(({ className, ...props }, ref) => (
  <TabsPrimitive.List
    ref={ref}
    className={cn(
      "inline-flex h-10 items-center justify-center rounded-md bg-muted p-1 text-muted-foreground",
      className
    )}
    {...props}
  />
))
TabsList.displayName = TabsPrimitive.List.displayName

const TabsTrigger = React.forwardRef<
  React.ElementRef<typeof TabsPrimitive.Trigger>,
  React.ComponentPropsWithoutRef<typeof TabsPrimitive.Trigger>
>(({ className, ...props }, ref) => (
  <TabsPrimitive.Trigger
    ref={ref}
    className={cn(
      "inline-flex items-center justify-center whitespace-nowrap rounded-sm px-3 py-1.5 text-sm font-medium ring-offset-background transition-all focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 data-[state=active]:bg-background data-[state=active]:text-foreground data-[state=active]:shadow-sm",
      className
    )}
    {...props}
  />
))
TabsTrigger.displayName = TabsPrimitive.Trigger.displayName

const TabsContent = React.forwardRef<
  React.ElementRef<typeof TabsPrimitive.Content>,
  React.ComponentPropsWithoutRef<typeof TabsPrimitive.Content>
>(({ className, ...props }, ref) => (
  <TabsPrimitive.Content
    ref={ref}
    className={cn(
      "mt-2 ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2",
      className
    )}
    {...props}
  />
))
TabsContent.displayName = TabsPrimitive.Content.displayName

export { Tabs, TabsList, TabsTrigger, TabsContent }
</file>

<file path="src/components/ui/textarea.tsx">
import * as React from 'react';

import {cn} from '@/lib/utils';

const Textarea = React.forwardRef<HTMLTextAreaElement, React.ComponentProps<'textarea'>>(
  ({className, ...props}, ref) => {
    return (
      <textarea
        className={cn(
          'flex min-h-[80px] w-full rounded-md border border-input bg-background px-3 py-2 text-base ring-offset-background placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 md:text-sm',
          className
        )}
        ref={ref}
        {...props}
      />
    );
  }
);
Textarea.displayName = 'Textarea';

export {Textarea};
</file>

<file path="src/components/ui/toast.tsx">
"use client"

import * as React from "react"
import * as ToastPrimitives from "@radix-ui/react-toast"
import { cva, type VariantProps } from "class-variance-authority"
import { X } from "lucide-react"

import { cn } from "@/lib/utils"

const ToastProvider = ToastPrimitives.Provider

const ToastViewport = React.forwardRef<
  React.ElementRef<typeof ToastPrimitives.Viewport>,
  React.ComponentPropsWithoutRef<typeof ToastPrimitives.Viewport>
>(({ className, ...props }, ref) => (
  <ToastPrimitives.Viewport
    ref={ref}
    className={cn(
      "fixed top-0 z-[100] flex max-h-screen w-full flex-col-reverse p-4 sm:bottom-0 sm:right-0 sm:top-auto sm:flex-col md:max-w-[420px]",
      className
    )}
    {...props}
  />
))
ToastViewport.displayName = ToastPrimitives.Viewport.displayName

const toastVariants = cva(
  "group pointer-events-auto relative flex w-full items-center justify-between space-x-4 overflow-hidden rounded-md border p-6 pr-8 shadow-lg transition-all data-[swipe=cancel]:translate-x-0 data-[swipe=end]:translate-x-[var(--radix-toast-swipe-end-x)] data-[swipe=move]:translate-x-[var(--radix-toast-swipe-move-x)] data-[swipe=move]:transition-none data-[state=open]:animate-in data-[state=closed]:animate-out data-[swipe=end]:animate-out data-[state=closed]:fade-out-80 data-[state=closed]:slide-out-to-right-full data-[state=open]:slide-in-from-top-full data-[state=open]:sm:slide-in-from-bottom-full",
  {
    variants: {
      variant: {
        default: "border bg-background text-foreground",
        destructive:
          "destructive group border-destructive bg-destructive text-destructive-foreground",
      },
    },
    defaultVariants: {
      variant: "default",
    },
  }
)

const Toast = React.forwardRef<
  React.ElementRef<typeof ToastPrimitives.Root>,
  React.ComponentPropsWithoutRef<typeof ToastPrimitives.Root> &
    VariantProps<typeof toastVariants>
>(({ className, variant, ...props }, ref) => {
  return (
    <ToastPrimitives.Root
      ref={ref}
      className={cn(toastVariants({ variant }), className)}
      {...props}
    />
  )
})
Toast.displayName = ToastPrimitives.Root.displayName

const ToastAction = React.forwardRef<
  React.ElementRef<typeof ToastPrimitives.Action>,
  React.ComponentPropsWithoutRef<typeof ToastPrimitives.Action>
>(({ className, ...props }, ref) => (
  <ToastPrimitives.Action
    ref={ref}
    className={cn(
      "inline-flex h-8 shrink-0 items-center justify-center rounded-md border bg-transparent px-3 text-sm font-medium ring-offset-background transition-colors hover:bg-secondary focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 group-[.destructive]:border-muted/40 group-[.destructive]:hover:border-destructive/30 group-[.destructive]:hover:bg-destructive group-[.destructive]:hover:text-destructive-foreground group-[.destructive]:focus:ring-destructive",
      className
    )}
    {...props}
  />
))
ToastAction.displayName = ToastPrimitives.Action.displayName

const ToastClose = React.forwardRef<
  React.ElementRef<typeof ToastPrimitives.Close>,
  React.ComponentPropsWithoutRef<typeof ToastPrimitives.Close>
>(({ className, ...props }, ref) => (
  <ToastPrimitives.Close
    ref={ref}
    className={cn(
      "absolute right-2 top-2 rounded-md p-1 text-foreground/50 opacity-0 transition-opacity hover:text-foreground focus:opacity-100 focus:outline-none focus:ring-2 group-hover:opacity-100 group-[.destructive]:text-red-300 group-[.destructive]:hover:text-red-50 group-[.destructive]:focus:ring-red-400 group-[.destructive]:focus:ring-offset-red-600",
      className
    )}
    toast-close=""
    {...props}
  >
    <X className="h-4 w-4" />
  </ToastPrimitives.Close>
))
ToastClose.displayName = ToastPrimitives.Close.displayName

const ToastTitle = React.forwardRef<
  React.ElementRef<typeof ToastPrimitives.Title>,
  React.ComponentPropsWithoutRef<typeof ToastPrimitives.Title>
>(({ className, ...props }, ref) => (
  <ToastPrimitives.Title
    ref={ref}
    className={cn("text-sm font-semibold", className)}
    {...props}
  />
))
ToastTitle.displayName = ToastPrimitives.Title.displayName

const ToastDescription = React.forwardRef<
  React.ElementRef<typeof ToastPrimitives.Description>,
  React.ComponentPropsWithoutRef<typeof ToastPrimitives.Description>
>(({ className, ...props }, ref) => (
  <ToastPrimitives.Description
    ref={ref}
    className={cn("text-sm opacity-90", className)}
    {...props}
  />
))
ToastDescription.displayName = ToastPrimitives.Description.displayName

type ToastProps = React.ComponentPropsWithoutRef<typeof Toast>

type ToastActionElement = React.ReactElement<typeof ToastAction>

export {
  type ToastProps,
  type ToastActionElement,
  ToastProvider,
  ToastViewport,
  Toast,
  ToastTitle,
  ToastDescription,
  ToastClose,
  ToastAction,
}
</file>

<file path="src/components/ui/toaster.tsx">
"use client"

import { useToast } from "@/hooks/use-toast"
import {
  Toast,
  ToastClose,
  ToastDescription,
  ToastProvider,
  ToastTitle,
  ToastViewport,
} from "@/components/ui/toast"

export function Toaster() {
  const { toasts } = useToast()

  return (
    <ToastProvider>
      {toasts.map(function ({ id, title, description, action, ...props }) {
        return (
          <Toast key={id} {...props}>
            <div className="grid gap-1">
              {title && <ToastTitle>{title}</ToastTitle>}
              {description && (
                <ToastDescription>{description}</ToastDescription>
              )}
            </div>
            {action}
            <ToastClose />
          </Toast>
        )
      })}
      <ToastViewport />
    </ToastProvider>
  )
}
</file>

<file path="src/components/ui/tooltip.tsx">
"use client"

import * as React from "react"
import * as TooltipPrimitive from "@radix-ui/react-tooltip"

import { cn } from "@/lib/utils"

const TooltipProvider = TooltipPrimitive.Provider

const Tooltip = TooltipPrimitive.Root

const TooltipTrigger = TooltipPrimitive.Trigger

const TooltipContent = React.forwardRef<
  React.ElementRef<typeof TooltipPrimitive.Content>,
  React.ComponentPropsWithoutRef<typeof TooltipPrimitive.Content>
>(({ className, sideOffset = 4, ...props }, ref) => (
  <TooltipPrimitive.Content
    ref={ref}
    sideOffset={sideOffset}
    className={cn(
      "z-50 overflow-hidden rounded-md border bg-popover px-3 py-1.5 text-sm text-popover-foreground shadow-md animate-in fade-in-0 zoom-in-95 data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=closed]:zoom-out-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",
      className
    )}
    {...props}
  />
))
TooltipContent.displayName = TooltipPrimitive.Content.displayName

export { Tooltip, TooltipTrigger, TooltipContent, TooltipProvider }
</file>

<file path="src/components/FacebookSDKInitializer.tsx">
'use client';

import Script from 'next/script';

export default function FacebookSDKInitializer() {
  return (
    <>
      <div id="fb-root"></div>
      <Script
        id="facebook-sdk"
        strategy="afterInteractive"
        src="https://connect.facebook.net/en_US/sdk.js#xfbml=1&version=v19.0"
        onLoad={() => {
          if ((window as any).FB) {
            (window as any).FB.init({
              xfbml: true,
              version: 'v19.0',
            });
          }
        }}
      />
    </>
  );
}
</file>

<file path="src/components/icons.tsx">
import type { SVGProps } from 'react';

export const Logo = (props: SVGProps<SVGSVGElement>) => (
  <svg
    xmlns="http://www.w3.org/2000/svg"
    viewBox="0 0 24 24"
    fill="none"
    stroke="currentColor"
    strokeWidth="2"
    strokeLinecap="round"
    strokeLinejoin="round"
    {...props}
  >
    <path d="M12 2L2 7l10 5 10-5-10-5z" />
    <path d="M2 17l10 5 10-5" />
    <path d="M2 12l10 5 10-5" />
  </svg>
);
</file>

<file path="src/hooks/use-mobile.tsx">
import * as React from "react"

const MOBILE_BREAKPOINT = 768

export function useIsMobile() {
  const [isMobile, setIsMobile] = React.useState<boolean | undefined>(undefined)

  React.useEffect(() => {
    const mql = window.matchMedia(`(max-width: ${MOBILE_BREAKPOINT - 1}px)`)
    const onChange = () => {
      setIsMobile(window.innerWidth < MOBILE_BREAKPOINT)
    }
    mql.addEventListener("change", onChange)
    setIsMobile(window.innerWidth < MOBILE_BREAKPOINT)
    return () => mql.removeEventListener("change", onChange)
  }, [])

  return !!isMobile
}
</file>

<file path="src/hooks/use-toast.ts">
"use client"

// Inspired by react-hot-toast library
import * as React from "react"

import type {
  ToastActionElement,
  ToastProps,
} from "@/components/ui/toast"

const TOAST_LIMIT = 1
const TOAST_REMOVE_DELAY = 1000000

type ToasterToast = ToastProps & {
  id: string
  title?: React.ReactNode
  description?: React.ReactNode
  action?: ToastActionElement
}

const actionTypes = {
  ADD_TOAST: "ADD_TOAST",
  UPDATE_TOAST: "UPDATE_TOAST",
  DISMISS_TOAST: "DISMISS_TOAST",
  REMOVE_TOAST: "REMOVE_TOAST",
} as const

let count = 0

function genId() {
  count = (count + 1) % Number.MAX_SAFE_INTEGER
  return count.toString()
}

type ActionType = typeof actionTypes

type Action =
  | {
      type: ActionType["ADD_TOAST"]
      toast: ToasterToast
    }
  | {
      type: ActionType["UPDATE_TOAST"]
      toast: Partial<ToasterToast>
    }
  | {
      type: ActionType["DISMISS_TOAST"]
      toastId?: ToasterToast["id"]
    }
  | {
      type: ActionType["REMOVE_TOAST"]
      toastId?: ToasterToast["id"]
    }

interface State {
  toasts: ToasterToast[]
}

const toastTimeouts = new Map<string, ReturnType<typeof setTimeout>>()

const addToRemoveQueue = (toastId: string) => {
  if (toastTimeouts.has(toastId)) {
    return
  }

  const timeout = setTimeout(() => {
    toastTimeouts.delete(toastId)
    dispatch({
      type: "REMOVE_TOAST",
      toastId: toastId,
    })
  }, TOAST_REMOVE_DELAY)

  toastTimeouts.set(toastId, timeout)
}

export const reducer = (state: State, action: Action): State => {
  switch (action.type) {
    case "ADD_TOAST":
      return {
        ...state,
        toasts: [action.toast, ...state.toasts].slice(0, TOAST_LIMIT),
      }

    case "UPDATE_TOAST":
      return {
        ...state,
        toasts: state.toasts.map((t) =>
          t.id === action.toast.id ? { ...t, ...action.toast } : t
        ),
      }

    case "DISMISS_TOAST": {
      const { toastId } = action

      // ! Side effects ! - This could be extracted into a dismissToast() action,
      // but I'll keep it here for simplicity
      if (toastId) {
        addToRemoveQueue(toastId)
      } else {
        state.toasts.forEach((toast) => {
          addToRemoveQueue(toast.id)
        })
      }

      return {
        ...state,
        toasts: state.toasts.map((t) =>
          t.id === toastId || toastId === undefined
            ? {
                ...t,
                open: false,
              }
            : t
        ),
      }
    }
    case "REMOVE_TOAST":
      if (action.toastId === undefined) {
        return {
          ...state,
          toasts: [],
        }
      }
      return {
        ...state,
        toasts: state.toasts.filter((t) => t.id !== action.toastId),
      }
  }
}

const listeners: Array<(state: State) => void> = []

let memoryState: State = { toasts: [] }

function dispatch(action: Action) {
  memoryState = reducer(memoryState, action)
  listeners.forEach((listener) => {
    listener(memoryState)
  })
}

type Toast = Omit<ToasterToast, "id">

function toast({ ...props }: Toast) {
  const id = genId()

  const update = (props: ToasterToast) =>
    dispatch({
      type: "UPDATE_TOAST",
      toast: { ...props, id },
    })
  const dismiss = () => dispatch({ type: "DISMISS_TOAST", toastId: id })

  dispatch({
    type: "ADD_TOAST",
    toast: {
      ...props,
      id,
      open: true,
      onOpenChange: (open) => {
        if (!open) dismiss()
      },
    },
  })

  return {
    id: id,
    dismiss,
    update,
  }
}

function useToast() {
  const [state, setState] = React.useState<State>(memoryState)

  React.useEffect(() => {
    listeners.push(setState)
    return () => {
      const index = listeners.indexOf(setState)
      if (index > -1) {
        listeners.splice(index, 1)
      }
    }
  }, [state])

  return {
    ...state,
    toast,
    dismiss: (toastId?: string) => dispatch({ type: "DISMISS_TOAST", toastId }),
  }
}

export { useToast, toast }
</file>

<file path="src/hooks/useSubmissions.ts">
'use client';

import { useState, useEffect } from 'react';
import type { Submission } from '@/lib/types';
import { supabase, isSupabaseConfigured } from '@/lib/supabase/supabase';

export function useSubmissions() {
  const [submissions, setSubmissions] = useState<Submission[]>([]);
  const [loading, setLoading] = useState(true);
  const [error, setError] = useState<Error | null>(null);

  useEffect(() => {
    if (!isSupabaseConfigured) {
        setLoading(false);
        return;
    }
      
    const fetchSubmissions = async () => {
      setLoading(true);
      const { data, error } = await supabase
        .from('form_submissions')
        .select('*')
        .order('created_at', { ascending: false });

      if (error) {
        setError(error);
        setSubmissions([]);
      } else {
        const mappedData = data.map(item => ({
            id: item.id,
            formType: item.form_type,
            status: item.status,
            serviceId: item.service_id,
            serviceName: item.service_name,
            fullName: item.full_name,
            email: item.email,
            phone: item.phone,
            company: item.company,
            industry: item.industry,
            details: item.details,
            internalNotes: item.internal_notes,
            assignedTo: item.assigned_to,
            createdAt: item.created_at,
            updatedAt: item.updated_at,
            completedAt: item.completed_at,
        })) as Submission[];

        setSubmissions(mappedData);
        setError(null);
      }
      setLoading(false);
    };

    fetchSubmissions();

    const channel = supabase
      .channel('form_submissions')
      .on(
        'postgres_changes',
        { event: '*', schema: 'public', table: 'form_submissions' },
        (payload) => {
          // Just refetch all for simplicity
          fetchSubmissions();
        }
      )
      .subscribe();

    return () => {
      supabase.removeChannel(channel);
    };
  }, []);

  return { submissions, loading, error };
}
</file>

<file path="src/hooks/useTestimonials.ts">
'use client';

import { useState, useEffect } from 'react';
import type { Testimonial } from '@/lib/types';
import { supabase, isSupabaseConfigured } from '@/lib/supabase/supabase';

export function useTestimonials() {
  const [testimonials, setTestimonials] = useState<Testimonial[]>([]);
  const [loading, setLoading] = useState(true);
  const [error, setError] = useState<Error | null>(null);

  useEffect(() => {
    if (!isSupabaseConfigured) {
        setLoading(false);
        return;
    }
      
    const fetchTestimonials = async () => {
      setLoading(true);
      const { data, error } = await supabase
        .from('testimonials')
        .select('*')
        .order('created_at', { ascending: false });

      if (error) {
        setError(error);
        setTestimonials([]);
      } else {
        const mappedData = data.map(item => ({
            id: item.id,
            postUrl: item.post_url,
            createdAt: item.created_at,
        })) as Testimonial[];

        setTestimonials(mappedData);
        setError(null);
      }
      setLoading(false);
    };

    fetchTestimonials();

    const channel = supabase
      .channel('testimonials-realtime')
      .on(
        'postgres_changes',
        { event: '*', schema: 'public', table: 'testimonials' },
        (payload) => {
          fetchTestimonials();
        }
      )
      .subscribe();

    return () => {
      supabase.removeChannel(channel);
    };
  }, []);

  return { testimonials, loading, error };
}
</file>

<file path="src/hooks/useUser.ts">
'use client';

import { useEffect, useState } from 'react';
import type { User } from '@supabase/supabase-js';
import { supabase, isSupabaseConfigured } from '@/lib/supabase/supabase';

export function useUser() {
  const [user, setUser] = useState<User | null>(null);
  const [loading, setLoading] = useState(true);
  
  useEffect(() => {
    if (!isSupabaseConfigured) {
      setLoading(false);
      return;
    }

    const {
      data: { subscription },
    } = supabase.auth.onAuthStateChange((event, session) => {
      setUser(session?.user ?? null);
      setLoading(false);
    });

    // Initial load
    supabase.auth.getSession().then(({ data: { session } }) => {
        setUser(session?.user ?? null);
        setLoading(false);
    });

    return () => {
      subscription?.unsubscribe();
    };
  }, []);

  return { user, loading, error: null };
}
</file>

<file path="src/lib/supabase/SQL/rls_policies.sql">
-- RLS Policies for Bilacert App

-- Enable RLS for all relevant tables
ALTER TABLE public.services ENABLE ROW LEVEL SECURITY;
ALTER TABLE public.blog_posts ENABLE ROW LEVEL SECURITY;
ALTER TABLE public.testimonials ENABLE ROW LEVEL SECURITY;
ALTER TABLE public.contacts ENABLE ROW LEVEL SECURITY;
ALTER TABLE public.form_submissions ENABLE ROW LEVEL SECURITY;
ALTER TABLE public.users ENABLE ROW LEVEL SECURITY;

-- Drop existing policies to avoid conflicts
DROP POLICY IF EXISTS "Public can read services" ON public.services;
DROP POLICY IF EXISTS "Admins can manage services" ON public.services;

DROP POLICY IF EXISTS "Public can read blog posts" ON public.blog_posts;
DROP POLICY IF EXISTS "Admins can manage blog posts" ON public.blog_posts;

DROP POLICY IF EXISTS "Public can read testimonials" ON public.testimonials;
DROP POLICY IF EXISTS "Admins can manage testimonials" ON public.testimonials;

DROP POLICY IF EXISTS "Admins can manage contacts" ON public.contacts;

DROP POLICY IF EXISTS "Allow public form submissions" ON public.form_submissions;
DROP POLICY IF EXISTS "Admins can manage form submissions" ON public.form_submissions;

DROP POLICY IF EXISTS "Users can view their own profile" ON public.users;
DROP POLICY IF EXISTS "Admins can manage all user profiles" ON public.users;


-- Helper function to check for admin role
CREATE OR REPLACE FUNCTION is_admin()
RETURNS boolean AS $$
DECLARE
  user_role TEXT;
BEGIN
  IF auth.uid() IS NULL THEN
    RETURN FALSE;
  END IF;
  SELECT role INTO user_role FROM public.users WHERE id = auth.uid();
  RETURN user_role = 'admin';
END;
$$ LANGUAGE plpgsql SECURITY DEFINER;


-- Policies for 'services' table
CREATE POLICY "Public can read services" ON public.services
  FOR SELECT USING (published = true);

CREATE POLICY "Admins can manage services" ON public.services
  FOR ALL USING (is_admin()) WITH CHECK (is_admin());


-- Policies for 'blog_posts' table
CREATE POLICY "Public can read blog posts" ON public.blog_posts
  FOR SELECT USING (published = true);

CREATE POLICY "Admins can manage blog posts" ON public.blog_posts
  FOR ALL USING (is_admin()) WITH CHECK (is_admin());


-- Policies for 'testimonials' table
CREATE POLICY "Public can read testimonials" ON public.testimonials
  FOR SELECT USING (true);

CREATE POLICY "Admins can manage testimonials" ON public.testimonials
  FOR ALL USING (is_admin()) WITH CHECK (is_admin());


-- Policies for 'contacts' table
CREATE POLICY "Admins can manage contacts" ON public.contacts
  FOR ALL USING (is_admin()) WITH CHECK (is_admin());


-- Policies for 'form_submissions' table
CREATE POLICY "Allow public form submissions" ON public.form_submissions
  FOR INSERT WITH CHECK (true);

CREATE POLICY "Admins can manage form submissions" ON public.form_submissions
  FOR ALL USING (is_admin()) WITH CHECK (is_admin());
  

-- Policies for 'users' table
CREATE POLICY "Users can view their own profile" ON public.users
  FOR SELECT USING (auth.uid() = id);
  
CREATE POLICY "Admins can manage all user profiles" ON public.users
  FOR ALL USING (is_admin()) WITH CHECK (is_admin());
</file>

<file path="src/lib/supabase/SQL/storage_policies.sql">
-- ===============================================================================================
-- SUPABASE STORAGE POLICIES
-- ===============================================================================================
-- This file defines the Row Level Security (RLS) policies for the Supabase Storage buckets.
-- Buckets: 'blogs', 'services'
--
-- Policies:
-- 1. Public Read Access: Allows anyone to view images in the buckets. This is necessary for
--    displaying images on the public-facing website.
-- 2. Authenticated Write Access: Allows only authenticated users (i.e., logged-in admins)
--    to upload, update, and delete images. This secures your storage from public writes.
--
-- To Apply: Copy the content of this file and run it in the Supabase SQL Editor for your project.
-- ===============================================================================================


-- -----------------------------------------------------------------------------------------------
-- Policies for 'blogs' bucket
-- -----------------------------------------------------------------------------------------------

-- 1. Allow public read access to all files in the 'blogs' bucket.
CREATE POLICY "Public read access for blog images"
ON storage.objects FOR SELECT
USING ( bucket_id = 'blogs' );

-- 2. Allow authenticated users to upload files to the 'blogs' bucket.
CREATE POLICY "Authenticated users can upload blog images"
ON storage.objects FOR INSERT
TO authenticated
WITH CHECK ( bucket_id = 'blogs' );

-- 3. Allow authenticated users to update files in the 'blogs' bucket.
CREATE POLICY "Authenticated users can update blog images"
ON storage.objects FOR UPDATE
TO authenticated
USING ( bucket_id = 'blogs' );

-- 4. Allow authenticated users to delete files in the 'blogs' bucket.
CREATE POLICY "Authenticated users can delete blog images"
ON storage.objects FOR DELETE
TO authenticated
USING ( bucket_id = 'blogs' );


-- -----------------------------------------------------------------------------------------------
-- Policies for 'services' bucket
-- -----------------------------------------------------------------------------------------------

-- 1. Allow public read access to all files in the 'services' bucket.
CREATE POLICY "Public read access for service images"
ON storage.objects FOR SELECT
USING ( bucket_id = 'services' );

-- 2. Allow authenticated users to upload files to the 'services' bucket.
CREATE POLICY "Authenticated users can upload service images"
ON storage.objects FOR INSERT
TO authenticated
WITH CHECK ( bucket_id = 'services' );

-- 3. Allow authenticated users to update files in the 'services' bucket.
CREATE POLICY "Authenticated users can update service images"
ON storage.objects FOR UPDATE
TO authenticated
USING ( bucket_id = 'services' );

-- 4. Allow authenticated users to delete files in the 'services' bucket.
CREATE POLICY "Authenticated users can delete service images"
ON storage.objects FOR DELETE
TO authenticated
USING ( bucket_id = 'services' );
</file>

<file path="src/lib/supabase/SQL/supa_migration.sql">
-- Drop tables in reverse order of dependency to avoid foreign key constraint issues
DROP TABLE IF EXISTS "services" CASCADE;
DROP TABLE IF EXISTS "blog_posts" CASCADE;
DROP TABLE IF EXISTS "testimonials" CASCADE;

-- Create services table
CREATE TABLE IF NOT EXISTS services (
  id UUID DEFAULT gen_random_uuid() PRIMARY KEY,
  title TEXT NOT NULL,
  slug TEXT NOT NULL UNIQUE,
  href TEXT NOT NULL UNIQUE,
  category TEXT,
  description TEXT,
  short_description TEXT,
  icon TEXT,
  order_index INT,
  content TEXT,
  features TEXT[],
  requirements TEXT[],
  includes TEXT[],
  published BOOLEAN DEFAULT TRUE,
  featured BOOLEAN DEFAULT FALSE,
  created_at TIMESTAMPTZ DEFAULT NOW(),
  processing_time TEXT,
  pricing NUMERIC,
  image TEXT,
  thumbnail TEXT,
  seo_title TEXT,
  seo_description TEXT,
  seo_keywords TEXT,
  pricing_plans JSONB,
  process_steps JSONB,
  success_story JSONB
);

-- Create blog_posts table
CREATE TABLE IF NOT EXISTS blog_posts (
    id UUID DEFAULT gen_random_uuid() PRIMARY KEY,
    slug TEXT NOT NULL UNIQUE,
    title TEXT NOT NULL,
    excerpt TEXT,
    content TEXT,
    author TEXT,
    read_time TEXT,
    category TEXT,
    published BOOLEAN DEFAULT FALSE,
    created_at TIMESTAMPTZ DEFAULT now(),
    image TEXT
);

-- Create testimonials table
CREATE TABLE IF NOT EXISTS testimonials (
  id UUID DEFAULT gen_random_uuid() PRIMARY KEY,
  post_url TEXT NOT NULL,
  created_at TIMESTAMPTZ DEFAULT NOW()
);


-- Seed Services Data
-- Data is derived from the bilacert.xml and services-config.ts to match the application's structure.

INSERT INTO services (
  title, slug, href, category, description, short_description, icon, published, featured, processing_time, pricing, image, seo_title, seo_description, seo_keywords, features, requirements, includes, content, pricing_plans, process_steps, success_story
) VALUES
(
  'ICASA Type Approvals',
  'icasa-type-approvals',
  '/services/icasa-type-approvals',
  'Compliance',
  'Expert guidance for ICASA type approval applications. We handle Standard, Simplified, Tested, and Untested approvals with a proven track record of success.',
  'Streamlined approval process for telecommunications and radio frequency devices.',
  'Award',
  TRUE,
  TRUE,
  '30 Working Days',
  4500,
  '/herosetion/Type-Approval.jpg',
  'ICASA Type Approvals',
  'Expert ICASA type approval services for South African businesses. We handle Standard, Simplified, Tested, and Untested approvals with fast processing and comprehensive support.',
  'ICASA type approval, ICASA certification, telecommunications approval, radio frequency approval, electronic device approval, ICASA compliance, type approval South Africa, ICASA testing',
  ARRAY['All telecommunications equipment', 'Radio frequency devices', 'Electronic communication products'],
  ARRAY['Completed application form', 'Technical documentation and specifications', 'Test reports from an accredited laboratory', 'Company registration documents'],
  ARRAY['Application filing','Documentation review','Regulatory liaison'],
  'ICASA (Independent Communications Authority of South Africa) requires all electronic communication equipment to be type-approved before being sold or used in South Africa. This ensures devices meet regulatory, technical, and safety standards. Our team simplifies this complex process, handling all documentation, testing coordination, and regulatory communications to ensure your products reach the market quickly and compliantly.',
  '[
    { "title": "Standard", "description": "For new equipment", "features": ["Comprehensive testing", "Full documentation", "Compliance review"], "price": "R5,000", "popular": false },
    { "title": "Simplified", "description": "For pre-approved equipment", "features": ["Streamlined process", "Reduced documentation", "Faster approval"], "price": "R4,500", "popular": true },
    { "title": "Tested & Untested", "description": "Guidance on the best path", "features": ["Expert guidance", "Risk assessment", "Optimal pathway selection"], "price": "R4,500", "popular": false }
  ]',
  '[
    { "step": "1", "title": "Pre-Assessment", "description": "We evaluate your product and determine the most efficient approval pathway." },
    { "step": "2", "title": "Documentation", "description": "We compile and review all required documentation for accuracy and completeness." },
    { "step": "3", "title": "Testing Coordination", "description": "We arrange laboratory testing with accredited facilities when required." },
    { "step": "4", "title": "Submission", "description": "We submit your application to ICASA and manage all communications." },
    { "step": "5", "title": "Approval", "description": "We track progress and ensure timely approval of your certification." }
  ]',
  '{
    "scenario": "A technology company wanted to import a new range of wireless routers into South Africa.",
    "challenge": "They needed ICASA type approval but were unfamiliar with the regulatory requirements and documentation process.",
    "solution": "Bilacert managed their ICASA type approval application from start to finish, ensuring compliance and timely market entry.",
    "result": "The company received approval 30% faster than industry average, allowing them to launch their products on schedule and capture market opportunities."
  }'
),
(
  'NRCS LOA Applications',
  'nrcs-loa-applications',
  '/services/nrcs-loa-applications',
  'Compliance',
  'Letter of Authority applications for electrical and electronic products requiring NRCS certification.',
  'Expert guidance for NRCS LOA applications, ensuring your products meet South African safety and quality standards.',
  'FileText',
  TRUE,
  FALSE,
  '120 Days',
  7000,
  '/NRCS.jpg',
  'NRCS LOA Applications',
  'Professional NRCS Letter of Authority (LOA) application services for South African businesses. Expert guidance for electrical and electronic product compliance.',
  'NRCS LOA, NRCS Letter of Authority, NRCS certification, electrical product approval, electronic product compliance, NRCS South Africa, LOA application, NRCS testing',
  ARRAY['Electrical and electronic products', 'Safety and quality standards compliance', 'Mandatory before importation or sale'],
  ARRAY['Completed application form', 'Valid test reports (not older than 3 years)', 'Product samples (if required)', 'Proof of payment of application fees'],
  ARRAY['Product eligibility assessment', 'Technical documentation preparation', 'Testing coordination', 'Renewals and amendments'],
  'The National Regulator for Compulsory Specifications (NRCS) mandates that certain electrical and electronic products must receive a Letter of Authority (LOA) before entering the South African market. This certification ensures products meet South African safety and quality standards. Our team streamlines the NRCS LOA application process, ensuring businesses obtain approvals efficiently while staying fully compliant with regulatory requirements.',
  '[
    { "title": "Basic", "description": "Eligibility Assessment & Document Review", "features": ["Product eligibility assessment", "Document review", "Basic guidance"], "price": "R3,500", "popular": false },
    { "title": "Standard", "description": "Full Application Submission & NRCS Liaison", "features": ["Full documentation preparation", "NRCS submission", "Liaison & tracking", "Testing coordination"], "price": "R7,000", "popular": true },
    { "title": "Premium", "description": "End-to-End Approval & Compliance Support", "features": ["Complete end-to-end service", "Testing coordination", "Ongoing compliance support", "Priority processing"], "price": "R10,500", "popular": false }
  ]',
  '[
    { "step": "1", "title": "Consultation & Product Review", "description": "We assess your product''''s technical specifications and determine LOA requirements." },
    { "step": "2", "title": "Documentation & Compliance Check", "description": "We compile and verify all necessary compliance documents before submission." },
    { "step": "3", "title": "Submission & NRCS Liaison", "description": "Bilacert submits the application and manages all communication with NRCS." },
    { "step": "4", "title": "Testing (If Required)", "description": "For products needing laboratory testing, we coordinate with accredited testing facilities." },
    { "step": "5", "title": "Approval & Certification", "description": "Once approved, we deliver your NRCS LOA certificate and provide ongoing compliance support." }
  ]',
  '{
    "scenario": "An electronics importer wanted to bring in a new range of LED lighting products but was unaware of NRCS LOA requirements.",
    "challenge": "They needed an LOA but lacked the technical knowledge and documentation required for NRCS compliance.",
    "solution": "Bilacert confirmed the LOA requirement, handled their submission, and ensured a smooth approval process.",
    "result": "The company received their NRCS LOA efficiently, allowing them to import and sell their LED products legally in South Africa without delays."
  }'
),
(
  'Radio Dealer Licensing',
  'radio-dealer-licensing',
  '/services/radio-dealer-licensing',
  'Licensing',
  'Complete licensing support for businesses selling or distributing radio communication equipment.',
  'We simplify the process of obtaining an ICASA Radio Dealer License, ensuring your business stays compliant.',
  'Headphones',
  TRUE,
  FALSE,
  '30 Days',
  3000,
  '/herosetion/Radio-Dealer.jpg',
  'Radio Dealer Licensing',
  'Complete Radio Dealer License services for South African businesses selling radio communication equipment. Expert ICASA licensing support and compliance guidance.',
  'radio dealer license, ICASA radio license, radio communication license, two-way radio license, radio equipment dealer, ICASA dealer license, radio licensing South Africa, communication equipment license',
  ARRAY['Required for radio equipment sales', 'Issued by ICASA', 'Mandatory for legal trading'],
  ARRAY['Business registration documents', 'Tax clearance certificate', 'Proof of address', 'Description of equipment to be sold'],
  ARRAY['Eligibility Assessment', 'Application Preparation', 'ICASA Liaison', 'Ongoing Compliance'],
  'Any business that sells, distributes, or supplies radio communication equipment in South Africa must hold a valid Radio Dealer License issued by ICASA. Without this license, trading in such equipment is illegal and can result in hefty fines or business disruptions. We simplify the licensing process, ensuring your business remains compliant while you focus on growth.',
  '[
    { "title": "Basic", "description": "Consultation & Application Review", "features": ["Eligibility assessment", "Application review", "Basic guidance"], "price": "R1,000", "popular": false },
    { "title": "Standard", "description": "Full Documentation Submission & Liaison", "features": ["Full documentation preparation", "ICASA submission", "Liaison & tracking", "Application management"], "price": "R3,000", "popular": true },
    { "title": "Premium", "description": "End-to-End Approval & Ongoing Support", "features": ["Complete end-to-end service", "Ongoing compliance support", "Priority processing", "Renewal management"], "price": "R4,000", "popular": false }
  ]',
  '[
    { "step": "1", "title": "Consultation & Eligibility Check", "description": "We assess whether your business requires a Radio Dealer License and identify necessary documentation." },
    { "step": "2", "title": "Application Preparation", "description": "Our experts compile, review, and prepare all required documents for complete and accurate submission." },
    { "step": "3", "title": "Submission & ICASA Liaison", "description": "We submit the application and manage all interactions with ICASA to streamline the approval process." },
    { "step": "4", "title": "License Approval & Issuance", "description": "Once approved, we ensure you receive your official Radio Dealer License." },
    { "step": "5", "title": "Post-License Compliance", "description": "We provide ongoing support for license renewals, amendments, and regulatory compliance updates." }
  ]',
  '{
    "scenario": "A two-way radio distributor was unaware of the ICASA licensing requirements and faced operational risks.",
    "challenge": "They needed a Radio Dealer License urgently to avoid business disruption and legal penalties.",
    "solution": "Bilacert swiftly secured their Radio Dealer License, ensuring they could continue trading legally.",
    "result": "The distributor now operates without disruptions, maintaining full compliance with ICASA regulations and avoiding costly penalties."
  }'
),
(
  'Class ECS/ECNS Licensing',
  'class-ecs-ecns-licensing',
  '/services/class-ecs-ecns-licensing',
  'Licensing',
  'Electronic Communications Service and Network Service licensing for telecom providers.',
  'Expert guidance for Class Electronic Communications Service (ECS) and Electronic Communications Network Service (ECNS) licensing.',
  'Shield',
  TRUE,
  FALSE,
  '30 working Days',
  7500,
  '/class-ens-ecns.jpg',
  'Class ECS/ECNS Licensing',
  'Professional ECS and ECNS licensing services for South African telecommunications providers. Expert guidance for Electronic Communications Service and Network Service licenses.',
  'ECS license, ECNS license, electronic communications service, electronic communications network service, telecommunications license, ICASA ECS ECNS, VoIP license, network service license',
  ARRAY['Required for electronic communication services', 'Issued by ICASA', 'Essential for legal operations'],
  ARRAY['Business plan', 'Technical plan', 'Financial statements', 'B-BBEE certificate'],
  ARRAY['Eligibility Assessment', 'Application Preparation', 'ICASA Liaison', 'Ongoing Compliance'],
  'Businesses providing electronic communications services or network infrastructure may require a Class Electronic Communications Service (ECS) or Electronic Communications Network Service (ECNS) license from ICASA. Without the appropriate license, your operations could be at risk of non-compliance, fines, or shutdowns. We simplify the licensing process, ensuring your business remains compliant while you focus on innovation and growth.',
  '[
    { "title": "Basic", "description": "Consultation & Application Review", "features": ["Eligibility assessment", "Application review", "Basic guidance"], "price": "R3,000", "popular": false },
    { "title": "Standard", "description": "Full Documentation Submission & Liaison", "features": ["Full documentation preparation", "ICASA submission", "Liaison & tracking", "Application management"], "price": "R7,500", "popular": true },
    { "title": "Premium", "description": "End-to-End Approval & Ongoing Support", "features": ["Complete end-to-end service", "Ongoing compliance support", "Priority processing", "Renewal management"], "price": "R9,500", "popular": false }
  ]',
  '[
    { "step": "1", "title": "Consultation & Eligibility Check", "description": "We assess whether your business requires a Class ECS or ECNS license and identify necessary documentation." },
    { "step": "2", "title": "Application Preparation", "description": "Our experts compile, review, and prepare all required documents for complete and accurate submission." },
    { "step": "3", "title": "Submission & ICASA Liaison", "description": "We submit the application and manage all interactions with ICASA to streamline the approval process." },
    { "step": "4", "title": "License Approval & Issuance", "description": "Once approved, we ensure you receive your official ICASA license." },
    { "step": "5", "title": "Post-License Compliance", "description": "We provide ongoing support for license renewals, amendments, and regulatory compliance updates." }
  ]',
  '{
    "scenario": "A startup launching a VoIP communication platform needed an ECS license to operate legally.",
    "challenge": "They were unfamiliar with ICASA''''s licensing requirements and needed guidance on the application process.",
    "solution": "Bilacert assessed their needs, filed their application, and ensured they met ICASA''''s operational requirements.",
    "result": "The startup received their ECS license efficiently, allowing them to launch their VoIP platform legally and focus on growing their business."
  }'
),
(
  'License Exemptions',
  'license-exemptions',
  '/services/license-exemptions',
  'Compliance',
  'Assessment and application support for businesses that may qualify for ICASA license exemptions.',
  'We help determine if your business qualifies for ECS/ECNS license exemptions and provide compliance documentation.',
  'Radio',
  TRUE,
  FALSE,
  '30 working Days',
  6800,
  '/ecs-ecns-licensing-explained.jpg',
  'License Exemptions',
  'Expert ECS/ECNS license exemption services for South African businesses. We help determine if your business qualifies for ICASA license exemptions and provide compliance documentation.',
  'license exemption, ECS exemption, ECNS exemption, ICASA exemption, license exemption South Africa, exemption verification, compliance exemption, regulatory exemption',
  ARRAY['Available for specific business models', 'Under ICASA''s exemption list', 'Avoids full licensing process'],
  ARRAY['Detailed business model description', 'Network diagrams (if applicable)', 'Service level agreements'],
  ARRAY['Eligibility Verification', 'Compliance Documentation', 'ICASA Confirmation', 'Ongoing Monitoring'],
  'Not all businesses providing electronic communications services or infrastructure require an ICASA ECS or ECNS license. Some may qualify for an ICASA License Exemption, allowing them to operate legally without the need for a full licensing process. However, determining whether your business qualifies for an exemption can be complex. We simplify the process, ensuring you have the right exemption in place to avoid unnecessary costs and compliance risks.',
  '[
    { "title": "Basic", "description": "Eligibility Assessment", "features": ["Business model assessment", "Exemption verification", "Basic guidance"], "price": "R2,500", "popular": false },
    { "title": "Standard", "description": "Full Documentation & ICASA Confirmation", "features": ["Full documentation preparation", "ICASA confirmation", "Compliance documentation", "Verification process"], "price": "R6,800", "popular": true },
    { "title": "Premium", "description": "End-to-End Exemption Processing", "features": ["Complete end-to-end service", "Ongoing compliance support", "Priority processing", "Annual compliance review"], "price": "R8,000", "popular": false }
  ]',
  '[
    { "step": "1", "title": "Consultation & Business Model Assessment", "description": "We review your business model to determine if an ECS/ECNS exemption applies." },
    { "step": "2", "title": "Documentation & Compliance Review", "description": "We compile the necessary paperwork to support your exemption claim." },
    { "step": "3", "title": "ICASA Confirmation (If Required)", "description": "For certain cases, we submit a request to ICASA for official exemption confirmation." },
    { "step": "4", "title": "Exemption Approval & Compliance Assurance", "description": "Once verified, we provide you with the necessary documentation to prove your exemption status." },
    { "step": "5", "title": "Ongoing Compliance Monitoring", "description": "We track regulatory changes to ensure your exemption remains valid and your business stays compliant." }
  ]',
  '{
    "scenario": "A software company offering cloud-based VoIP services assumed they needed an ECS license.",
    "challenge": "They were unsure about their licensing requirements and wanted to avoid unnecessary costs and regulatory hurdles.",
    "solution": "Bilacert assessed their operations and confirmed they qualified for an exemption, saving them licensing costs.",
    "result": "The company now operates legally under an exemption, avoiding unnecessary licensing fees while maintaining full compliance with ICASA regulations."
  }'
),
(
  'Ski Boat VHF Licensing',
  'ski-boat-vhf-licensing',
  '/services/ski-boat-vhf-licensing',
  'Licensing',
  'VHF radio licensing for marine vessels, including ski boats and recreational watercraft.',
  'Professional VHF radio licensing services for South African marine vessels including ski boats, yachts, and recreational watercraft.',
  'Ship',
  TRUE,
  FALSE,
  '30 working Days',
  3000,
  '/herosetion/Ski-Boat-VHF.jpg',
  'Ski Boat VHF Licensing',
  'Professional VHF radio licensing services for South African marine vessels including ski boats, yachts, and recreational watercraft. Expert ICASA maritime compliance support.',
  'VHF radio license, ski boat VHF, marine radio license, boat VHF license, yacht radio license, maritime radio license, ICASA VHF license, marine communication license',
  ARRAY['Required for marine VHF radio communication', 'Issued by ICASA', 'Essential for safe maritime operations'],
  ARRAY['Vessel registration documents', 'Radio operator certificate of competence', 'Radio equipment details'],
  ARRAY['Vessel Assessment', 'Application Preparation', 'Maritime Compliance', 'Fleet Licensing'],
  'In South Africa, ski boats and other vessels using VHF radios for marine communication are required to have a valid VHF Radio License from ICASA. This ensures that all maritime radio communication remains safe, legal, and interference-free. We simplify the process of obtaining your Ski Boat VHF License, ensuring compliance with ICASA regulations while allowing you to focus on your boating experience.',
  '[
    { "title": "Basic", "description": "Consultation & Application Review", "features": ["Vessel assessment", "Application review", "Basic guidance"], "price": "R1,800", "popular": false },
    { "title": "Standard", "description": "Full Documentation Submission & Liaison", "features": ["Full documentation preparation", "ICASA submission", "Liaison & tracking", "Application management"], "price": "R3,000", "popular": true },
    { "title": "Premium", "description": "End-to-End Approval & Ongoing Support", "features": ["Complete end-to-end service", "Ongoing compliance support", "Priority processing", "Fleet licensing"], "price": "R4,500", "popular": false }
  ]',
  '[
    { "step": "1", "title": "Consultation & Eligibility Check", "description": "We assess whether your ski boat or vessel requires a VHF license and identify necessary documentation." },
    { "step": "2", "title": "Application Preparation", "description": "Our experts compile, review, and prepare all required documents for complete and accurate submission." },
    { "step": "3", "title": "Submission & ICASA Liaison", "description": "We submit the application and manage all interactions with ICASA to streamline the approval process." },
    { "step": "4", "title": "License Approval & Issuance", "description": "Once approved, we ensure you receive your official ICASA VHF Radio License." },
    { "step": "5", "title": "Post-License Compliance", "description": "We provide ongoing support for license renewals, amendments, and regulatory compliance updates." }
  ]',
  '{
    "scenario": "A fishing charter company needed multiple VHF licenses for its fleet of boats.",
    "challenge": "They needed to ensure all vessels were legally compliant before peak season and were unfamiliar with the licensing process.",
    "solution": "Bilacert managed the entire process, ensuring all vessels were legally compliant with maritime regulations.",
    "result": "The charter company received all their VHF licenses efficiently, allowing them to operate legally during peak season without any compliance issues."
  }'
);


-- Seed Blog Posts Data
INSERT INTO blog_posts (slug, title, excerpt, content, category, published, image, author, read_time) VALUES
(
  'icasa-type-approval-requirements',
  'Understanding ICASA Type Approval Requirements',
  'A comprehensive guide to ICASA type approval requirements for South African businesses.',
  '<p>ICASA (Independent Communications Authority of South Africa) type approval is a mandatory certification process...</p>',
  'ICASA Approvals',
  TRUE,
  '/ICASA.png',
  'Bilacert Team',
  '5 min read'
),
(
  'nrcs-loa-guide',
  'NRCS LOA: What You Need to Know',
  'Everything you need to know about NRCS Letter of Authority applications.',
  '<p>The National Regulator for Compulsory Specifications (NRCS) Letter of Authority (LOA) is a critical certification...</p>',
  'NRCS Compliance',
  TRUE,
  '/NRCS.jpg',
  'Bilacert Team',
  '7 min read'
),
(
  'radio-dealer-licensing-guide',
  'Radio Dealer Licensing Made Simple',
  'Step-by-step guide to obtaining your Radio Dealer License from ICASA.',
  '<p>Operating as a radio dealer in South Africa requires proper licensing from ICASA...</p>',
  'Licensing',
  TRUE,
  '/radio-dealer-licensing-guide.jpg',
  'Bilacert Team',
  '6 min read'
);


-- Seed Testimonials Data
INSERT INTO testimonials (post_url) VALUES
('https://web.facebook.com/abram.nyathi.1/posts/pfbid02ko48NxyJV74fPKgKewogGyFURoAgsCKjp2gMB1suARU72Qm9g59SpxzHbe9fYxadl');
</file>

<file path="src/lib/supabase/supa_migration.sql">
-- Drop existing tables to start fresh
DROP TABLE IF EXISTS services;
DROP TABLE IF EXISTS blog_posts;
DROP TABLE IF EXISTS testimonials;

-- Create services table with all fields including JSONB for structured data
CREATE TABLE services (
  id UUID DEFAULT gen_random_uuid() PRIMARY KEY,
  title TEXT NOT NULL,
  slug TEXT NOT NULL UNIQUE,
  href TEXT NOT NULL UNIQUE,
  category TEXT,
  description TEXT,
  short_description TEXT,
  icon TEXT,
  order_index INTEGER,
  content TEXT,
  features TEXT[],
  requirements TEXT[],
  includes TEXT[],
  published BOOLEAN DEFAULT false,
  featured BOOLEAN DEFAULT false,
  created_at TIMESTAMPTZ DEFAULT NOW(),
  processing_time TEXT,
  pricing NUMERIC,
  image TEXT,
  thumbnail TEXT,
  seo_title TEXT,
  seo_description TEXT,
  seo_keywords TEXT,
  pricing_plans JSONB,
  process_steps JSONB,
  success_story JSONB
);

-- Create blog_posts table
CREATE TABLE blog_posts (
  id UUID DEFAULT gen_random_uuid() PRIMARY KEY,
  slug TEXT NOT NULL UNIQUE,
  title TEXT NOT NULL,
  excerpt TEXT,
  content TEXT,
  category TEXT,
  published BOOLEAN DEFAULT FALSE,
  created_at TIMESTAMPTZ DEFAULT NOW(),
  image TEXT
);

-- Create testimonials table
CREATE TABLE testimonials (
  id UUID DEFAULT gen_random_uuid() PRIMARY KEY,
  post_url TEXT NOT NULL,
  created_at TIMESTAMPTZ DEFAULT NOW()
);

-- Seed Services Data from bilacert.xml structure

-- 1. ICASA Type Approvals
INSERT INTO services (title, slug, href, category, description, short_description, icon, content, features, requirements, includes, published, featured, processing_time, pricing, image, thumbnail, seo_title, seo_description, seo_keywords, pricing_plans, process_steps, success_story)
VALUES (
  'ICASA Type Approvals',
  'icasa-type-approvals',
  '/services/icasa-type-approvals',
  'Compliance',
  'Expert guidance for ICASA type approval applications. We handle Standard, Simplified, Tested, and Untested approvals with a proven track record of success.',
  'Streamlined approval process for telecommunications and radio frequency devices.',
  'Award',
  'ICASA (Independent Communications Authority of South Africa) requires all electronic communication equipment to be type-approved before being sold or used in South Africa. This ensures devices meet regulatory, technical, and safety standards.\nOur team simplifies this complex process, handling all documentation, testing coordination, and regulatory communications to ensure your products reach the market quickly and compliantly.',
  ARRAY['All telecommunications equipment', 'Radio frequency devices', 'Electronic communication products'],
  ARRAY['Product technical specifications','EMC/RF test reports','User manual','Product photos'],
  ARRAY['Application filing','Documentation review','Regulatory liaison'],
  true,
  true,
  '30 Working Days',
  5000.00,
  '/herosetion/Type-Approval.jpg',
  '/herosetion/Type-Approval.jpg',
  'ICASA Type Approvals',
  'Expert ICASA type approval services for South African businesses. We handle Standard, Simplified, Tested, and Untested approvals with fast processing and comprehensive support.',
  'ICASA type approval, ICASA certification, telecommunications approval, radio frequency approval, electronic device approval, ICASA compliance, type approval South Africa, ICASA testing',
  '[{"title": "Standard Type Approval", "description": "Required for any equipment that has not been type approved before by the Authority", "features": ["Comprehensive testing", "Full documentation", "Complete compliance review"], "price": "From R5,000", "popular": false}, {"title": "Simplified Type Approval", "description": "Available for products that already obtained type Approval from Authority", "features": ["Streamlined process", "Reduced documentation", "Faster approval"], "price": "From R4,500", "popular": true}, {"title": "Tested & Untested Approvals", "description": "We guide you through the decision-making process for the right approval method.", "features": ["Expert guidance", "Risk assessment", "Optimal pathway selection"], "price": "From R4,500", "popular": false}]',
  '[{"step": "1", "title": "Pre-Assessment", "description": "We evaluate your product and determine the most efficient approval pathway."}, {"step": "2", "title": "Documentation", "description": "We compile and review all required documentation for accuracy and completeness."}, {"step": "3", "title": "Testing Coordination", "description": "We arrange laboratory testing with accredited facilities when required."}, {"step": "4", "title": "Submission", "description": "We submit your application to ICASA and manage all communications."}, {"step": "5", "title": "Approval", "description": "We track progress and ensure timely approval of your certification."}]',
  '{"scenario": "A technology company wanted to import a new range of wireless routers into South Africa.", "challenge": "They needed ICASA type approval but were unfamiliar with the regulatory requirements and documentation process.", "solution": "Bilacert managed their ICASA type approval application from start to finish, ensuring compliance and timely market entry.", "result": "The company received approval 30% faster than industry average, allowing them to launch their products on schedule and capture market opportunities."}'
);

-- 2. Class ECS/ECNS Licensing
INSERT INTO services (title, slug, href, category, description, short_description, icon, content, features, requirements, includes, published, featured, processing_time, pricing, image, thumbnail, seo_title, seo_description, seo_keywords, pricing_plans, process_steps, success_story)
VALUES (
  'Class ECS/ECNS Licensing',
  'class-ecs-ecns-licensing',
  '/services/class-ecs-ecns-licensing',
  'Licensing',
  'Professional ECS and ECNS licensing services for South African telecommunications providers. Expert guidance for Electronic Communications Service and Network Service licenses.',
  'Expert guidance for Class Electronic Communications Service (ECS) and Electronic Communications Network Service (ECNS) licensing.',
  'Shield',
  'Businesses providing electronic communications services or network infrastructure may require a Class Electronic Communications Service (ECS) or Electronic Communications Network Service (ECNS) license from ICASA. Without the appropriate license, your operations could be at risk of non-compliance, fines, or shutdowns.\nWe simplify the licensing process, ensuring your business remains compliant while you focus on innovation and growth.',
  ARRAY['Required for electronic communication services','Issued by ICASA','Essential for legal operations'],
  ARRAY['Company registration documents','Business plan','Technical network diagram'],
  ARRAY['Eligibility assessment', 'Application preparation', 'ICASA liaison', 'Renewal support'],
  true,
  false,
  '30 working Days',
  7500.00,
  '/class-ens-ecns.jpg',
  '/class-ens-ecns.jpg',
  'Class ECS/ECNS Licensing',
  'Professional ECS and ECNS licensing services for South African telecommunications providers. Expert guidance for Electronic Communications Service and Network Service licenses.',
  'ECS license, ECNS license, electronic communications service, electronic communications network service, telecommunications license, ICASA ECS ECNS, VoIP license, network service license',
  '[{"title": "Basic", "description": "Consultation & Application Review", "features": ["Eligibility assessment", "Application review", "Basic guidance"], "price": "R3,000", "popular": false}, {"title": "Standard", "description": "Full Documentation Submission & Liaison", "features": ["Full documentation preparation", "ICASA submission", "Liaison & tracking", "Application management"], "price": "R7,500", "popular": true}, {"title": "Premium", "description": "End-to-End Approval & Ongoing Support", "features": ["Complete end-to-end service", "Ongoing compliance support", "Priority processing", "Renewal management"], "price": "R9,500", "popular": false}]',
  '[{"step": "1", "title": "Consultation & Eligibility Check", "description": "We assess whether your business requires a Class ECS or ECNS license and identify necessary documentation."}, {"step": "2", "title": "Application Preparation", "description": "Our experts compile, review, and prepare all required documents for complete and accurate submission."}, {"step": "3", "title": "Submission & ICASA Liaison", "description": "We submit the application and manage all interactions with ICASA to streamline the approval process."}, {"step": "4", "title": "License Approval & Issuance", "description": "Once approved, we ensure you receive your official ICASA license."}, {"step": "5", "title": "Post-License Compliance", "description": "We provide ongoing support for license renewals, amendments, and regulatory compliance updates."}]',
  '{"scenario": "A startup launching a VoIP communication platform needed an ECS license to operate legally.", "challenge": "They were unfamiliar with ICASA''s licensing requirements and needed guidance on the application process.", "solution": "Bilacert assessed their needs, filed their application, and ensured they met ICASA''s operational requirements.", "result": "The startup received their ECS license efficiently, allowing them to launch their VoIP platform legally and focus on growing their business."}'
);

-- Repeat for the other 4 services...

-- 3. License Exemptions
INSERT INTO services (title, slug, href, category, description, short_description, icon, content, features, requirements, includes, published, featured, processing_time, pricing, image, thumbnail, seo_title, seo_description, seo_keywords, pricing_plans, process_steps, success_story)
VALUES (
  'License Exemptions',
  'license-exemptions',
  '/services/license-exemptions',
  'Licensing',
  'Expert ECS/ECNS license exemption services for South African businesses. We help determine if your business qualifies for exemptions and provide the necessary documentation for compliance assurance.',
  'Determine if your business qualifies for ICASA license exemptions and get compliance documentation.',
  'FileText',
  'Not all businesses providing electronic communications services or infrastructure require an ICASA license. Some may qualify for an exemption, allowing them to operate legally without a full licensing process. Determining qualification can be complex, but we simplify it, ensuring you avoid unnecessary costs and risks.',
  ARRAY['Available for specific business models', 'Under ICASA''s exemption list', 'Avoids full licensing process'],
  ARRAY['Detailed business model description', 'Service offering breakdown', 'Proof of limited scope'],
  ARRAY['Eligibility assessment', 'Compliance documentation', 'ICASA confirmation request'],
  true,
  false,
  '30 working Days',
  6800.00,
  '/ecs-ecns-licensing-explained.jpg',
  '/ecs-ecns-licensing-explained.jpg',
  'License Exemptions',
  'Expert ECS/ECNS license exemption services for South African businesses. We help determine if your business qualifies for ICASA license exemptions and provide compliance documentation.',
  'license exemption, ECS exemption, ECNS exemption, ICASA exemption, license exemption South Africa, exemption verification, compliance exemption, regulatory exemption',
  '[{"title": "Basic", "description": "Eligibility Assessment", "features": ["Business model assessment", "Exemption verification", "Basic guidance"], "price": "R2,500", "popular": false}, {"title": "Standard", "description": "Full Documentation & ICASA Confirmation", "features": ["Full documentation preparation", "ICASA confirmation", "Compliance documentation", "Verification process"], "price": "R6,800", "popular": true}, {"title": "Premium", "description": "End-to-End Exemption Processing", "features": ["Complete end-to-end service", "Ongoing compliance support", "Priority processing", "Annual compliance review"], "price": "R8,000", "popular": false}]',
  '[{"step": "1", "title": "Consultation & Business Model Assessment", "description": "We review your business model to determine if an ECS/ECNS exemption applies."}, {"step": "2", "title": "Documentation & Compliance Review", "description": "We compile the necessary paperwork to support your exemption claim."}, {"step": "3", "title": "ICASA Confirmation (If Required)", "description": "For certain cases, we submit a request to ICASA for official exemption confirmation."}, {"step": "4", "title": "Exemption Approval & Compliance Assurance", "description": "Once verified, we provide you with the necessary documentation to prove your exemption status."}, {"step": "5", "title": "Ongoing Compliance Monitoring", "description": "We track regulatory changes to ensure your exemption remains valid and your business stays compliant."}]',
  '{"scenario": "A software company offering cloud-based VoIP services assumed they needed an ECS license.", "challenge": "They were unsure about their licensing requirements and wanted to avoid unnecessary costs and regulatory hurdles.", "solution": "Bilacert assessed their operations and confirmed they qualified for an exemption, saving them licensing costs.", "result": "The company now operates legally under an exemption, avoiding unnecessary licensing fees while maintaining full compliance with ICASA regulations."}'
);

-- 4. NRCS LOA Applications
INSERT INTO services (title, slug, href, category, description, short_description, icon, content, features, requirements, includes, published, featured, processing_time, pricing, image, thumbnail, seo_title, seo_description, seo_keywords, pricing_plans, process_steps, success_story)
VALUES (
  'NRCS LOA Applications',
  'nrcs-loa-applications',
  '/services/nrcs-loa-applications',
  'Compliance',
  'Professional NRCS Letter of Authority (LOA) application services for South African businesses. Expert guidance for electrical and electronic product compliance.',
  'Letter of Authority applications for electrical and electronic products.',
  'FileText',
  'The National Regulator for Compulsory Specifications (NRCS) mandates that certain electrical and electronic products must receive a Letter of Authority (LOA) before entering the South African market. This certification ensures products meet South African safety and quality standards. Our team streamlines the NRCS LOA application process, ensuring businesses obtain approvals efficiently while staying fully compliant.',
  ARRAY['Electrical and electronic products', 'Safety and quality standards compliance', 'Mandatory before importation or sale'],
  ARRAY['Test reports from accredited labs', 'Product samples for evaluation', 'Technical file'],
  ARRAY['Product eligibility assessment', 'Technical documentation review', 'Testing coordination'],
  true,
  false,
  '120 Days',
  7000.00,
  '/NRCS.jpg',
  '/NRCS.jpg',
  'NRCS LOA Applications',
  'Professional NRCS Letter of Authority (LOA) application services for South African businesses. Expert guidance for electrical and electronic product compliance.',
  'NRCS LOA, NRCS Letter of Authority, NRCS certification, electrical product approval, electronic product compliance, NRCS South Africa, LOA application, NRCS testing',
  '[{"title": "Basic", "description": "Eligibility Assessment & Document Review", "features": ["Product eligibility assessment", "Document review", "Basic guidance"], "price": "R3,500", "popular": false}, {"title": "Standard", "description": "Full Application Submission & NRCS Liaison", "features": ["Full documentation preparation", "NRCS submission", "Liaison & tracking", "Testing coordination"], "price": "R7,000", "popular": true}, {"title": "Premium", "description": "End-to-End Approval & Compliance Support", "features": ["Complete end-to-end service", "Testing coordination", "Ongoing compliance support", "Priority processing"], "price": "R10,500", "popular": false}]',
  '[{"step": "1", "title": "Consultation & Product Review", "description": "We assess your product''s technical specifications and determine LOA requirements."}, {"step": "2", "title": "Documentation & Compliance Check", "description": "We compile and verify all necessary compliance documents before submission."}, {"step": "3", "title": "Submission & NRCS Liaison", "description": "Bilacert submits the application and manages all communication with NRCS."}, {"step": "4", "title": "Testing (If Required)", "description": "For products needing laboratory testing, we coordinate with accredited testing facilities."}, {"step": "5", "title": "Approval & Certification", "description": "Once approved, we deliver your NRCS LOA certificate and provide ongoing compliance support."}]',
  '{"scenario": "An electronics importer wanted to bring in a new range of LED lighting products but was unaware of NRCS LOA requirements.", "challenge": "They needed an LOA but lacked the technical knowledge and documentation required for NRCS compliance.", "solution": "Bilacert confirmed the LOA requirement, handled their submission, and ensured a smooth approval process.", "result": "The company received their NRCS LOA efficiently, allowing them to import and sell their LED products legally in South Africa without delays."}'
);

-- 5. Radio Dealer Licensing
INSERT INTO services (title, slug, href, category, description, short_description, icon, content, features, requirements, includes, published, featured, processing_time, pricing, image, thumbnail, seo_title, seo_description, seo_keywords, pricing_plans, process_steps, success_story)
VALUES (
  'Radio Dealer Licensing',
  'radio-dealer-licensing',
  '/services/radio-dealer-licensing',
  'Licensing',
  'Complete Radio Dealer License services for South African businesses selling radio communication equipment. Expert ICASA licensing support and compliance guidance.',
  'Complete licensing support for radio communication equipment dealers.',
  'Headphones',
  'Any business that sells, distributes, or supplies radio communication equipment in South Africa must hold a valid Radio Dealer License issued by ICASA. Without this license, trading in such equipment is illegal and can result in hefty fines or business disruptions. We simplify the licensing process, ensuring your business remains compliant while you focus on growth.',
  ARRAY['Required for radio communication equipment sales', 'Issued by ICASA', 'Mandatory for legal trading'],
  ARRAY['Business registration documents', 'Tax clearance certificate', 'List of equipment to be sold'],
  ARRAY['Eligibility assessment', 'Documentation preparation', 'ICASA liaison', 'Renewal support'],
  true,
  false,
  '30 Days',
  3000.00,
  '/herosetion/Radio-Dealer.jpg',
  '/herosetion/Radio-Dealer.jpg',
  'Radio Dealer Licensing',
  'Complete Radio Dealer License services for South African businesses selling radio communication equipment. Expert ICASA licensing support and compliance guidance.',
  'radio dealer license, ICASA radio license, radio communication license, two-way radio license, radio equipment dealer, ICASA dealer license, radio licensing South Africa, communication equipment license',
  '[{"title": "Basic", "description": "Consultation & Application Review", "features": ["Eligibility assessment", "Application review", "Basic guidance"], "price": "R1,000", "popular": false}, {"title": "Standard", "description": "Full Documentation Submission & Liaison", "features": ["Full documentation preparation", "ICASA submission", "Liaison & tracking", "Application management"], "price": "R3,000", "popular": true}, {"title": "Premium", "description": "End-to-End Approval & Ongoing Support", "features": ["Complete end-to-end service", "Ongoing compliance support", "Priority processing", "Renewal management"], "price": "R4,000", "popular": false}]',
  '[{"step": "1", "title": "Consultation & Eligibility Check", "description": "We assess whether your business requires a Radio Dealer License and identify necessary documentation."}, {"step": "2", "title": "Application Preparation", "description": "Our experts compile, review, and prepare all required documents for complete and accurate submission."}, {"step": "3", "title": "Submission & ICASA Liaison", "description": "We submit the application and manage all interactions with ICASA to streamline the approval process."}, {"step": "4", "title": "License Approval & Issuance", "description": "Once approved, we ensure you receive your official Radio Dealer License."}, {"step": "5", "title": "Post-License Compliance", "description": "We provide ongoing support for license renewals, amendments, and regulatory compliance updates."}]',
  '{"scenario": "A two-way radio distributor was unaware of the ICASA licensing requirements and faced operational risks.", "challenge": "They needed a Radio Dealer License urgently to avoid business disruption and legal penalties.", "solution": "Bilacert swiftly secured their Radio Dealer License, ensuring they could continue trading legally.", "result": "The distributor now operates without disruptions, maintaining full compliance with ICASA regulations and avoiding costly penalties."}'
);

-- 6. Ski Boat VHF Licensing
INSERT INTO services (title, slug, href, category, description, short_description, icon, content, features, requirements, includes, published, featured, processing_time, pricing, image, thumbnail, seo_title, seo_description, seo_keywords, pricing_plans, process_steps, success_story)
VALUES (
  'Ski Boat VHF Licensing',
  'ski-boat-vhf-licensing',
  '/services/ski-boat-vhf-licensing',
  'Licensing',
  'Professional VHF radio licensing services for South African marine vessels including ski boats, yachts, and recreational watercraft. Expert ICASA maritime compliance support.',
  'VHF radio licensing for marine vessels, including ski boats and yachts.',
  'Ship',
  'In South Africa, ski boats and other vessels using VHF radios for marine communication are required to have a valid VHF Radio License from ICASA. This ensures that all maritime radio communication remains safe, legal, and interference-free. We simplify the process of obtaining your Ski Boat VHF License, ensuring compliance with ICASA regulations while allowing you to focus on your boating experience.',
  ARRAY['Required for marine VHF radio communication', 'Issued by ICASA', 'Essential for safe maritime operations'],
  ARRAY['Vessel registration details', 'VHF radio model and serial number', 'Operator certificate of competency'],
  ARRAY['Vessel assessment', 'Application preparation', 'Maritime compliance checks'],
  true,
  false,
  '30 working Days',
  3000.00,
  '/herosetion/Ski-Boat-VHF.jpg',
  '/herosetion/Ski-Boat-VHF.jpg',
  'Ski Boat VHF Licensing',
  'Professional VHF radio licensing services for South African marine vessels including ski boats, yachts, and recreational watercraft. Expert ICASA maritime compliance support.',
  'VHF radio license, ski boat VHF, marine radio license, boat VHF license, yacht radio license, maritime radio license, ICASA VHF license, marine communication license',
  '[{"title": "Basic", "description": "Consultation & Application Review", "features": ["Vessel assessment", "Application review", "Basic guidance"], "price": "R1,800", "popular": false}, {"title": "Standard", "description": "Full Documentation Submission & Liaison", "features": ["Full documentation preparation", "ICASA submission", "Liaison & tracking", "Application management"], "price": "R3,000", "popular": true}, {"title": "Premium", "description": "End-to-End Approval & Ongoing Support", "features": ["Complete end-to-end service", "Ongoing compliance support", "Priority processing", "Fleet licensing"], "price": "R4,500", "popular": false}]',
  '[{"step": "1", "title": "Consultation & Eligibility Check", "description": "We assess whether your ski boat or vessel requires a VHF license and identify necessary documentation."}, {"step": "2", "title": "Application Preparation", "description": "Our experts compile, review, and prepare all required documents for complete and accurate submission."}, {"step": "3", "title": "Submission & ICASA Liaison", "description": "We submit the application and manage all interactions with ICASA to streamline the approval process."}, {"step": "4", "title": "License Approval & Issuance", "description": "Once approved, we ensure you receive your official ICASA VHF Radio License."}, {"step": "5", "title": "Post-License Compliance", "description": "We provide ongoing support for license renewals, amendments, and regulatory compliance updates."}]',
  '{"scenario": "A fishing charter company needed multiple VHF licenses for its fleet of boats.", "challenge": "They needed to ensure all vessels were legally compliant before peak season and were unfamiliar with the licensing process.", "solution": "Bilacert managed the entire process, ensuring all vessels were legally compliant with maritime regulations.", "result": "The charter company received all their VHF licenses efficiently, allowing them to operate legally during peak season without any compliance issues."}'
);

-- Seed Blog Posts Data
INSERT INTO blog_posts (slug, title, excerpt, content, category, published, image) VALUES
(
  'icasa-type-approval-requirements',
  'Understanding ICASA Type Approval Requirements',
  'A comprehensive guide to ICASA type approval requirements for South African businesses. Learn about the different types of approvals and how to navigate the process.',
  E'<p>ICASA (Independent Communications Authority of South Africa) type approval is a mandatory certification process for all electronic communication equipment before it can be sold or used in South Africa. This comprehensive guide will help you understand the requirements and navigate the process successfully.</p>\n      \n      <h2>What is ICASA Type Approval?</h2>\n      <p>ICASA type approval ensures that electronic communication devices meet South African regulatory, technical, and safety standards. This includes telecommunications equipment, radio frequency devices, and other electronic communication products.</p>\n      \n      <h2>Types of ICASA Approvals</h2>\n      <h3>Standard Type Approval</h3>\n      <p>Required for most telecommunications and radio frequency devices. This is the most common type of approval and involves comprehensive testing and documentation.</p>\n      \n      <h3>Simplified Type Approval</h3>\n      <p>Available for products that meet specific pre-approved conditions. This streamlined process is faster and less expensive for qualifying products.</p>\n      \n      <h3>Tested & Untested Approvals</h3>\n      <p>We guide clients through the decision-making process, ensuring they select the right approval method based on their product specifications and requirements.</p>\n      \n      <h2>The Application Process</h2>\n      <p>Our team handles the entire application process, from initial assessment to final approval. We ensure all documentation is complete and accurate, minimizing delays and maximizing success rates.</p>\n      \n      <h2>Why Choose Bilacert?</h2>\n      <p>With our expertise and streamlined processes, we typically reduce approval times by 30% compared to industry average, while maintaining a 100% success rate on first-time applications.</p>',
  'ICASA Approvals',
  TRUE,
  '/ICASA.png'
),
(
  'nrcs-loa-guide',
  'NRCS LOA: What You Need to Know',
  'Everything you need to know about NRCS Letter of Authority applications. From eligibility to the application process, we cover it all.',
  E'<p>The National Regulator for Compulsory Specifications (NRCS) Letter of Authority (LOA) is a critical certification for electrical and electronic products entering the South African market.</p>\n      \n      <h2>What is an NRCS LOA?</h2>\n      <p>An NRCS LOA is a certificate that confirms your product meets South African safety and quality standards. It''s required for certain electrical and electronic products before they can be imported, sold, or distributed.</p>\n      \n      <h2>Which Products Require an LOA?</h2>\n      <p>Products that typically require an NRCS LOA include electrical appliances, electronic devices, lighting products, and other regulated electrical equipment.</p>\n      \n      <h2>The Application Process</h2>\n      <p>Our team manages the entire LOA application process, including product assessment, documentation preparation, testing coordination, and submission to NRCS.</p>',
  'NRCS Compliance',
  TRUE,
  '/NRCS.jpg'
);


-- Seed Testimonials Data
INSERT INTO testimonials (post_url) VALUES
('https://web.facebook.com/abram.nyathi.1/posts/pfbid02ko48NxyJV74fPKgKewogGyFURoAgsCKjp2gMB1suARU72Qm9g59SpxzHbe9fYxadl');
</file>

<file path="src/lib/supabase/supabase.ts">
import { createBrowserClient } from "@supabase/ssr";

const supabaseUrl = process.env.NEXT_PUBLIC_SUPABASE_URL;
const supabaseAnonKey = process.env.NEXT_PUBLIC_SUPABASE_ANON_KEY;

const isValidSupabaseUrl = (url?: string) => {
    if (!url) return false;
    try {
        const u = new URL(url);
        return u.protocol === 'http:' || u.protocol === 'https:';
    } catch (e) {
        return false;
    }
}

export const isSupabaseConfigured = 
    isValidSupabaseUrl(supabaseUrl) && 
    !!supabaseAnonKey && 
    supabaseAnonKey !== "YOUR_SUPABASE_ANON_KEY";

// We only want to initialize the client if the config is valid.
// Otherwise, we'll export a dummy object to prevent build errors,
// and our configuration check will prevent it from being used at runtime.
export const supabase = isSupabaseConfigured 
    ? createBrowserClient(supabaseUrl!, supabaseAnonKey!)
    : {} as ReturnType<typeof createBrowserClient>;

if (!isSupabaseConfigured) {
    console.error(
      "Supabase is not configured. Please check your .env file and ensure NEXT_PUBLIC_SUPABASE_URL and NEXT_PUBLIC_SUPABASE_ANON_KEY are set correctly."
    );
}
</file>

<file path="src/lib/placeholder-images.json">
{
  "placeholderImages": [
    {
      "id": "user-avatar-1",
      "description": "User avatar",
      "imageUrl": "https://images.unsplash.com/photo-1710974481447-fb001ad9ad5a?crop=entropy&cs=tinysrgb&fit=max&fm=jpg&ixid=M3w3NDE5ODJ8MHwxfHNlYXJjaHw3fHxwZXJzb24lMjBmYWNlfGVufDB8fHx8MTc2OTQxMTQ1NXww&ixlib=rb-4.1.0&q=80&w=1080",
      "imageHint": "person face"
    }
  ]
}
</file>

<file path="src/lib/placeholder-images.ts">
import data from './placeholder-images.json';

export type ImagePlaceholder = {
  id: string;
  description: string;
  imageUrl: string;
  imageHint: string;
};

export const PlaceHolderImages: ImagePlaceholder[] = data.placeholderImages;
</file>

<file path="src/lib/utils.ts">
import { clsx, type ClassValue } from "clsx"
import { twMerge } from "tailwind-merge"

export function cn(...inputs: ClassValue[]) {
  return twMerge(clsx(inputs))
}
</file>

<file path="src/app/admin/blogs/actions.ts">
'use server';

import { createSupabaseAdminClient } from '@/lib/supabase/admin';
import { blogSchema } from './schema';
import { revalidatePath } from 'next/cache';
import { BlogPost } from '@/lib/types';

export async function upsertBlog(values: unknown, blogId?: string) {
  const supabase = createSupabaseAdminClient();
  const parsedValues = blogSchema.safeParse(values);

  if (!parsedValues.success) {
    return { error: parsedValues.error.message };
  }

  // eslint-disable-next-line @typescript-eslint/no-unused-vars
  const { id,slug, ...rest } = parsedValues.data;

  const dataToUpsert = slug ? { ...rest, id: slug, slug:slug } : rest;

  const { data: blogData, error } = await supabase
    .from('blog_posts')
    .upsert(dataToUpsert)
    .select('*')
    .single();

  if (error) {
    return { error: `Database error: ${error.message}` };
  }

  revalidatePath('/admin/blogs');
  revalidatePath(`/admin/blogs/${(blogData as BlogPost).id}`);
  revalidatePath(`/blog/${(blogData as BlogPost).slug}`);

  return {
    data: blogData,
    message: `Blog post ${blogId ? 'updated' : 'created'} successfully!`,
  };
}
</file>

<file path="src/app/admin/blogs/schema.ts">
import * as z from 'zod';

export const blogSchema = z.object({
  id: z.string().optional(),
  title: z.string().min(1, 'Title is required'),
  slug: z.string().min(1, 'Slug is required'),
  author_name: z.string().optional(),
  read_time: z.string().optional(),
  category: z.string().optional(),
  tags: z.string().optional(),
  excerpt: z.string().optional(),
  content: z.string().min(1, 'Content is required.'),
  published: z.boolean(),
  featured_image: z.string().url({ message: "Please enter a valid URL." }).optional().or(z.literal('')),
  thumbnail: z.string().url({ message: "Please enter a valid URL." }).optional().or(z.literal('')),
  featured: z.boolean(),
  seo_title: z.string().optional(),
  seo_description: z.string().optional(),
  seo_keywords: z.string().optional(),
});

export type BlogFormValues = z.infer<typeof blogSchema>;
</file>

<file path="src/app/admin/contacts/new/page.tsx">
import { Card, CardContent, CardHeader, CardTitle, CardDescription } from '@/components/ui/card';
import Link from 'next/link';
import { Button } from '@/components/ui/button';
import { ArrowLeft } from 'lucide-react';
import ContactForm from '../ContactForm';

export const metadata = {
    title: 'New Contact | Bilacert Admin Pro',
    description: 'Add a new contact to your records.',
};

export default function NewContactPage() {
    return (
        <div className="space-y-6">
            <Button variant="outline" asChild>
                <Link href="/admin/contacts">
                    <ArrowLeft className="mr-2 h-4 w-4" />
                    Back to Contacts
                </Link>
            </Button>
            <Card>
                <CardHeader>
                    <CardTitle>Add New Contact</CardTitle>
                    <CardDescription>Fill out the form below to add a new contact.</CardDescription>
                </CardHeader>
                <CardContent>
                    <ContactForm />
                </CardContent>
            </Card>
        </div>
    );
}
</file>

<file path="src/app/admin/contacts/loading.tsx">
import { Card, CardContent, CardHeader } from '@/components/ui/card';
import { Skeleton } from '@/components/ui/skeleton';

export default function ContactsLoading() {
    return (
        <div className="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-6">
            {Array.from({ length: 8 }).map((_, i) => (
                <Card key={i}>
                    <CardHeader>
                        <div className="flex justify-between items-start">
                            <Skeleton className="h-6 w-3/4" />
                            <Skeleton className="h-8 w-8 rounded-full" />
                        </div>
                        <Skeleton className="h-4 w-1/2" />
                    </CardHeader>
                    <CardContent className="space-y-3">
                         <Skeleton className="h-5 w-full" />
                         <Skeleton className="h-5 w-3/4" />
                    </CardContent>
                </Card>
            ))}
        </div>
    )
}
</file>

<file path="src/app/admin/form_submissions/[id]/edit/page.tsx">
import { supabase } from '@/lib/supabase/supabase';
import SubmissionForm from '../../SubmissionForm';
import { notFound } from 'next/navigation';
import { Card, CardContent, CardHeader, CardTitle, CardDescription } from '@/components/ui/card';
import type { Submission } from '@/lib/types';
import Link from 'next/link';
import { Button } from '@/components/ui/button';
import { ArrowLeft } from 'lucide-react';

export const metadata = {
    title: 'Edit Submission | Bilacert Admin Pro',
    description: 'Edit a form submission.',
};

async function getSubmission(id: string): Promise<Submission | null> {
    const { data, error } = await supabase
        .from('form_submissions')
        .select('*')
        .eq('id', id)
        .single();

    if (error || !data) {
        return null;
    }

    return {
        id: data.id,
        formType: data.form_type,
        status: data.status,
        serviceId: data.service_id,
        serviceName: data.service_name,
        fullName: data.full_name,
        email: data.email,
        phone: data.phone,
        company: data.company,
        industry: data.industry,
        details: data.details,
        internalNotes: data.internal_notes,
        assignedTo: data.assigned_to,
        createdAt: data.created_at,
        updatedAt: data.updated_at,
        completedAt: data.completed_at,
    } as Submission;
}

export default async function EditSubmissionPage({ params }: { params: Promise<{ id: string }> }) {
    const { id } = await params;
    const submission = await getSubmission(id);

    if (!submission) {
        notFound();
    }

    return (
        <div className="space-y-6">
            <Button variant="outline" asChild>
                <Link href={`/admin/form_submissions/${submission.id}`}>
                    <ArrowLeft className="mr-2 h-4 w-4" />
                    Back to Submission
                </Link>
            </Button>
            <Card>
                <CardHeader>
                    <CardTitle>Edit Submission</CardTitle>
                    <CardDescription>Update details for submission from "{submission.fullName}".</CardDescription>
                </CardHeader>
                <CardContent>
                    <SubmissionForm submission={submission} />
                </CardContent>
            </Card>
        </div>
    );
}
</file>

<file path="src/app/admin/form_submissions/[id]/page.tsx">
import { supabase } from '@/lib/supabase/supabase';
import SubmissionDetails from '../SubmissionDetails';
import { notFound } from 'next/navigation';
import type { Submission } from '@/lib/types';
import type { Metadata } from 'next';

async function getSubmission(id: string): Promise<Submission | null> {
    const { data, error } = await supabase
        .from('form_submissions')
        .select('*')
        .eq('id', id)
        .single();

    if (error || !data) {
        return null;
    }

    return {
        id: data.id,
        formType: data.form_type,
        status: data.status,
        serviceId: data.service_id,
        serviceName: data.service_name,
        fullName: data.full_name,
        email: data.email,
        phone: data.phone,
        company: data.company,
        industry: data.industry,
        details: data.details,
        internalNotes: data.internal_notes,
        assignedTo: data.assigned_to,
        createdAt: data.created_at,
        updatedAt: data.updated_at,
        completedAt: data.completed_at,
    } as Submission;
}

export async function generateMetadata({ params }: { params: { id: string } }): Promise<Metadata> {
    const submission = await getSubmission(params.id);
    if (!submission) {
        return {
            title: 'Submission Not Found'
        }
    }
    return {
        title: `Submission from ${submission.fullName} | Bilacert Admin Pro`,
    }
}

export default async function SubmissionDetailsPage({ params }: { params: Promise<{ id: string }> }) {
    const { id } = await params;
    const submission = await getSubmission(id);

    if (!submission) {
        notFound();
    }

    return <SubmissionDetails submission={submission} />;
}
</file>

<file path="src/app/admin/form_submissions/data-table.tsx">
"use client"

import {
  ColumnDef,
  flexRender,
  getCoreRowModel,
  useReactTable,
  getPaginationRowModel,
  getSortedRowModel,
  SortingState,
  Row,
} from "@tanstack/react-table"

import {
  Table,
  TableBody,
  TableCell,
  TableHead,
  TableHeader,
  TableRow,
} from "@/components/ui/table"
import { Button } from "@/components/ui/button"
import { useState } from "react"
import { Skeleton } from "@/components/ui/skeleton"
import { useRouter } from "next/navigation"
import type { Submission } from "@/lib/types"

interface DataTableProps<TData, TValue> {
  columns: ColumnDef<TData, TValue>[]
  data: TData[]
  isLoading?: boolean
}

export function DataTable<TData, TValue>({
  columns,
  data,
  isLoading = false
}: DataTableProps<TData, TValue>) {
    const [sorting, setSorting] = useState<SortingState>([])
    const router = useRouter();

  const table = useReactTable({
    data,
    columns,
    getCoreRowModel: getCoreRowModel(),
    getPaginationRowModel: getPaginationRowModel(),
    onSortingChange: setSorting,
    getSortedRowModel: getSortedRowModel(),
    state: {
        sorting,
    }
  })

  const handleRowClick = (row: Row<TData>) => {
    const submission = row.original as Submission;
    if (submission?.id) {
        router.push(`/admin/form_submissions/${submission.id}`);
    }
  }

  return (
    <div>
        <div className="rounded-md border">
        <Table>
            <TableHeader>
            {table.getHeaderGroups().map((headerGroup) => (
                <TableRow key={headerGroup.id}>
                {headerGroup.headers.map((header) => {
                    return (
                    <TableHead key={header.id}>
                        {header.isPlaceholder
                        ? null
                        : flexRender(
                            header.column.columnDef.header,
                            header.getContext()
                            )}
                    </TableHead>
                    )
                })}
                </TableRow>
            ))}
            </TableHeader>
            <TableBody>
            {isLoading ? (
                Array.from({ length: 5 }).map((_, i) => (
                    <TableRow key={i}>
                        {columns.map((col, j) => (
                            <TableCell key={j}>
                                <Skeleton className="h-6 w-full" />
                            </TableCell>
                        ))}
                    </TableRow>
                ))
            ) : table.getRowModel().rows?.length ? (
                table.getRowModel().rows.map((row) => (
                <TableRow
                    key={row.id}
                    data-state={row.getIsSelected() && "selected"}
                    className="cursor-pointer"
                    onClick={() => handleRowClick(row)}
                >
                    {row.getVisibleCells().map((cell) => (
                    <TableCell 
                        key={cell.id} 
                        onClick={(e) => {
                            if (cell.column.id === 'actions') {
                                e.stopPropagation();
                            }
                        }}
                    >
                        {flexRender(cell.column.columnDef.cell, cell.getContext())}
                    </TableCell>
                    ))}
                </TableRow>
                ))
            ) : (
                <TableRow>
                <TableCell colSpan={columns.length} className="h-24 text-center">
                    No results.
                </TableCell>
                </TableRow>
            )}
            </TableBody>
        </Table>
        </div>
        <div className="flex items-center justify-end space-x-2 py-4">
            <Button
                variant="outline"
                size="sm"
                onClick={() => table.previousPage()}
                disabled={!table.getCanPreviousPage()}
            >
                Previous
            </Button>
            <Button
                variant="outline"
                size="sm"
                onClick={() => table.nextPage()}
                disabled={!table.getCanNextPage()}
            >
                Next
            </Button>
        </div>
    </div>
  )
}
</file>

<file path="src/app/admin/form_submissions/DeleteSubmissionDialog.tsx">
'use client';

import {
  AlertDialog,
  AlertDialogCancel,
  AlertDialogContent,
  AlertDialogDescription,
  AlertDialogFooter,
  AlertDialogHeader,
  AlertDialogTitle,
} from '@/components/ui/alert-dialog';
import { Button } from '@/components/ui/button';
import { useToast } from '@/hooks/use-toast';
import { supabase } from '@/lib/supabase/supabase';
import type { Submission } from '@/lib/types';
import { Loader2 } from 'lucide-react';
import { useState } from 'react';

interface DeleteSubmissionDialogProps {
  isOpen: boolean;
  onClose: () => void;
  submission: Submission | null;
  onDeleted?: () => void;
}

export default function DeleteSubmissionDialog({
  isOpen,
  onClose,
  submission,
  onDeleted
}: DeleteSubmissionDialogProps) {
  const { toast } = useToast();
  const [isDeleting, setIsDeleting] = useState(false);

  const handleDelete = async () => {
    if (!submission) return;

    setIsDeleting(true);
    try {
      const { error } = await supabase
        .from('form_submissions')
        .delete()
        .eq('id', submission.id);

      if (error) throw error;

      toast({
        title: 'Submission deleted',
        description: `The submission from "${submission.fullName}" has been successfully deleted.`,
      });
      if (onDeleted) {
        onDeleted();
      } else {
        onClose();
      }
    } catch (error: any) {
      toast({
        variant: 'destructive',
        title: 'Error deleting submission',
        description: error.message,
      });
    } finally {
      setIsDeleting(false);
    }
  };

  return (
    <AlertDialog open={isOpen} onOpenChange={onClose}>
      <AlertDialogContent>
        <AlertDialogHeader>
          <AlertDialogTitle>Are you absolutely sure?</AlertDialogTitle>
          <AlertDialogDescription>
            This action cannot be undone. This will permanently delete the
            submission from "{submission?.fullName}".
          </AlertDialogDescription>
        </AlertDialogHeader>
        <AlertDialogFooter>
          <AlertDialogCancel disabled={isDeleting} onClick={onClose}>Cancel</AlertDialogCancel>
          <Button
            variant="destructive"
            onClick={handleDelete}
            disabled={isDeleting}
          >
            {isDeleting && <Loader2 className="mr-2 h-4 w-4 animate-spin" />}
            Delete
          </Button>
        </AlertDialogFooter>
      </AlertDialogContent>
    </AlertDialog>
  );
}
</file>

<file path="src/app/admin/form_submissions/SubmissionDetails.tsx">
'use client';

import { Badge } from '@/components/ui/badge';
import type { Submission } from '@/lib/types';
import { format } from 'date-fns';
import { Card, CardContent, CardHeader, CardTitle, CardDescription } from '@/components/ui/card';
import { Button } from '@/components/ui/button';
import Link from 'next/link';
import { ArrowLeft, Edit, Trash2, Phone } from 'lucide-react';
import { useState } from 'react';
import DeleteSubmissionDialog from './DeleteSubmissionDialog';
import { useRouter } from 'next/navigation';
import { statusVariantMap } from './columns';

interface SubmissionDetailsProps {
  submission: Submission;
}

export default function SubmissionDetails({ submission }: SubmissionDetailsProps) {
  const router = useRouter();
  const [isDeleteDialogOpen, setIsDeleteDialogOpen] = useState(false);

  if (!submission) return null;

  const handleDelete = () => {
    setIsDeleteDialogOpen(true);
  };
  
  const handleCloseDialog = () => {
    setIsDeleteDialogOpen(false);
  };

  const onDeleted = () => {
    setIsDeleteDialogOpen(false);
    router.push('/admin/form_submissions');
    router.refresh();
  }

  const renderJson = (data: any) => {
    if (!data) return <p className="text-sm text-card-foreground">Not set.</p>;
    return (
        <div className="prose prose-sm dark:prose-invert mt-1 text-card-foreground text-sm whitespace-pre-wrap">
            <pre className="bg-muted/50 p-2 rounded-md"><code>{JSON.stringify(data, null, 2)}</code></pre>
        </div>
    )
  }

  const formatPhoneNumberForWhatsApp = (phone: string) => {
    // Remove all non-digit characters
    return phone.replace(/\D/g, '');
  }

  return (
    <>
      <div className="space-y-6">
        <div className="flex items-center justify-between">
            <Button variant="outline" asChild>
                <Link href="/admin/form_submissions">
                    <ArrowLeft className="mr-2 h-4 w-4" />
                    Back to Submissions
                </Link>
            </Button>
            <div className="flex gap-2">
                <Button asChild>
                    <Link href={`/admin/form_submissions/${submission.id}/edit`}>
                        <Edit className="mr-2 h-4 w-4" /> Edit
                    </Link>
                </Button>
                <Button variant="destructive" onClick={handleDelete}>
                    <Trash2 className="mr-2 h-4 w-4" /> Delete
                </Button>
            </div>
        </div>

        <Card>
            <CardHeader>
                <div className="flex justify-between items-start">
                    <div>
                        <CardTitle>Submission from {submission.fullName}</CardTitle>
                        <CardDescription>
                            {submission.serviceName ? `Service: ${submission.serviceName}` : `Form: ${submission.formType}`}
                        </CardDescription>
                    </div>
                     <Badge variant={statusVariantMap[submission.status] || 'default'} className="capitalize">
                        {submission.status}
                    </Badge>
                </div>
            </CardHeader>
            <CardContent>
                <div className="grid gap-6 md:grid-cols-2">
                    <div className="space-y-6">
                        <div>
                            <h4 className="text-sm font-medium text-muted-foreground">Client Name</h4>
                            <p className="text-sm text-card-foreground">{submission.fullName}</p>
                        </div>
                        <div>
                            <h4 className="text-sm font-medium text-muted-foreground">Client Email</h4>
                            <p className="text-sm text-card-foreground">{submission.email}</p>
                        </div>
                         {submission.phone && (
                            <div>
                                <h4 className="text-sm font-medium text-muted-foreground">Phone</h4>
                                <a 
                                    href={`https://wa.me/${formatPhoneNumberForWhatsApp(submission.phone)}`}
                                    target="_blank"
                                    rel="noopener noreferrer"
                                    className="flex items-center gap-2 text-sm text-primary transition-colors hover:underline"
                                >
                                    <Phone className="h-4 w-4" />
                                    {submission.phone}
                                </a>
                            </div>
                        )}
                         {submission.company && (
                            <div>
                                <h4 className="text-sm font-medium text-muted-foreground">Company</h4>
                                <p className="text-sm text-card-foreground">{submission.company}</p>
                            </div>
                        )}
                        {submission.industry && (
                            <div>
                                <h4 className="text-sm font-medium text-muted-foreground">Industry</h4>
                                <p className="text-sm text-card-foreground">{submission.industry}</p>
                            </div>
                        )}
                    </div>
                     <div className="space-y-6">
                        {submission.assignedTo && (
                            <div>
                                <h4 className="text-sm font-medium text-muted-foreground">Assigned To</h4>
                                <p className="text-sm font-mono text-card-foreground">{submission.assignedTo}</p>
                            </div>
                        )}
                        <div>
                            <h4 className="text-sm font-medium text-muted-foreground">Submitted At</h4>
                            <p className="text-sm text-card-foreground">{format(new Date(submission.createdAt), 'PPpp')}</p>
                        </div>
                         <div>
                            <h4 className="text-sm font-medium text-muted-foreground">Last Updated</h4>
                            <p className="text-sm text-card-foreground">{format(new Date(submission.updatedAt), 'PPpp')}</p>
                        </div>
                        {submission.completedAt && (
                             <div>
                                <h4 className="text-sm font-medium text-muted-foreground">Completed At</h4>
                                <p className="text-sm text-card-foreground">{format(new Date(submission.completedAt), 'PPpp')}</p>
                            </div>
                        )}
                    </div>
                </div>

                {submission.details && (
                    <div className="mt-6 border-t pt-6">
                        <h3 className="text-lg font-medium mb-4">Submission Details</h3>
                        {renderJson(submission.details)}
                    </div>
                )}

                 {submission.internalNotes && (
                    <div className="mt-6 border-t pt-6">
                        <h3 className="text-lg font-medium mb-4">Internal Notes</h3>
                        <div className="prose prose-sm dark:prose-invert mt-1 text-card-foreground text-sm whitespace-pre-wrap">
                            {submission.internalNotes}
                        </div>
                    </div>
                )}
            </CardContent>
        </Card>
      </div>
      
      {isDeleteDialogOpen && (
        <DeleteSubmissionDialog
            isOpen={isDeleteDialogOpen}
            onClose={handleCloseDialog}
            submission={submission}
            onDeleted={onDeleted}
        />
      )}
    </>
  );
}
</file>

<file path="src/app/admin/form_submissions/SubmissionForm.tsx">
'use client';

import { useForm } from 'react-hook-form';
import { zodResolver } from '@hookform/resolvers/zod';
import { Button } from '@/components/ui/button';
import {
  Form,
  FormControl,
  FormField,
  FormItem,
  FormLabel,
  FormMessage,
} from '@/components/ui/form';
import { Input } from '@/components/ui/input';
import { Textarea } from '@/components/ui/textarea';
import { useToast } from '@/hooks/use-toast';
import type { Submission } from '@/lib/types';
import { useEffect } from 'react';
import { Loader2 } from 'lucide-react';
import { useRouter } from 'next/navigation';
import Link from 'next/link';
import {
    Select,
    SelectContent,
    SelectItem,
    SelectTrigger,
    SelectValue,
} from '@/components/ui/select';
import { submissionSchema } from './schema';
import { upsertSubmission } from './actions';

type SubmissionFormValues = Zod.infer<typeof submissionSchema>;

interface SubmissionFormProps {
  submission: Submission;
}

export default function SubmissionForm({ submission }: SubmissionFormProps) {
  const { toast } = useToast();
  const router = useRouter();
  const form = useForm<SubmissionFormValues>({
    resolver: zodResolver(submissionSchema),
    defaultValues: {
      fullName: '',
      email: '',
      phone: '',
      company: '',
      industry: '',
      serviceName: '',
      status: 'pending',
      details: '',
      internalNotes: '',
      assignedTo: '',
    },
  });

  const {
    handleSubmit,
    reset,
    formState: { isSubmitting },
  } = form;

  useEffect(() => {
    if (submission) {
      reset({
        fullName: submission.fullName,
        email: submission.email,
        phone: submission.phone || '',
        company: submission.company || '',
        industry: submission.industry || '',
        serviceName: submission.serviceName || '',
        status: submission.status,
        details: submission.details ? JSON.stringify(submission.details, null, 2) : '',
        internalNotes: submission.internalNotes || '',
        assignedTo: submission.assignedTo || '',
      });
    }
  }, [submission, reset]);

  const onSubmit = async (values: SubmissionFormValues) => {
    try {
      const result = await upsertSubmission(values, submission.id);

      if (result.error) {
        throw new Error(result.error);
      }
      
      toast({
        title: result.message,
      });
      router.push(`/admin/form_submissions/${submission.id}`);
      router.refresh();
    } catch (error: any) {
      toast({
        variant: 'destructive',
        title: 'Error saving submission',
        description: error.message,
      });
    }
  };

  return (
    <Form {...form}>
      <form onSubmit={handleSubmit(onSubmit)}>
        <div className="grid md:grid-cols-2 gap-6">
            <div className="space-y-6">
                 <FormField
                    control={form.control}
                    name="fullName"
                    render={({ field }) => (
                        <FormItem>
                        <FormLabel>Full Name</FormLabel>
                        <FormControl>
                            <Input {...field} />
                        </FormControl>
                        <FormMessage />
                        </FormItem>
                    )}
                 />
                 <FormField
                    control={form.control}
                    name="email"
                    render={({ field }) => (
                        <FormItem>
                        <FormLabel>Email</FormLabel>
                        <FormControl>
                            <Input {...field} />
                        </FormControl>
                        <FormMessage />
                        </FormItem>
                    )}
                />
                 <FormField
                    control={form.control}
                    name="phone"
                    render={({ field }) => (
                        <FormItem>
                        <FormLabel>Phone</FormLabel>
                        <FormControl>
                            <Input {...field} />
                        </FormControl>
                        <FormMessage />
                        </FormItem>
                    )}
                />
                 <FormField
                    control={form.control}
                    name="company"
                    render={({ field }) => (
                        <FormItem>
                        <FormLabel>Company</FormLabel>
                        <FormControl>
                            <Input {...field} />
                        </FormControl>
                        <FormMessage />
                        </FormItem>
                    )}
                />
                 <FormField
                    control={form.control}
                    name="industry"
                    render={({ field }) => (
                        <FormItem>
                        <FormLabel>Industry</FormLabel>
                        <FormControl>
                            <Input {...field} />
                        </FormControl>
                        <FormMessage />
                        </FormItem>
                    )}
                />
            </div>
             <div className="space-y-6">
                <FormField
                    control={form.control}
                    name="serviceName"
                    render={({ field }) => (
                        <FormItem>
                        <FormLabel>Service Name</FormLabel>
                        <FormControl>
                            <Input {...field} />
                        </FormControl>
                        <FormMessage />
                        </FormItem>
                    )}
                />
                <FormField
                  control={form.control}
                  name="status"
                  render={({ field }) => (
                    <FormItem>
                      <FormLabel>Status</FormLabel>
                      <Select onValueChange={field.onChange} defaultValue={field.value}>
                        <FormControl>
                          <SelectTrigger className="capitalize">
                            <SelectValue placeholder="Select a status" />
                          </SelectTrigger>
                        </FormControl>
                        <SelectContent>
                          {['pending', 'in-progress', 'completed', 'rejected', 'archived'].map(status => (
                            <SelectItem key={status} value={status} className="capitalize">{status}</SelectItem>
                          ))}
                        </SelectContent>
                      </Select>
                      <FormMessage />
                    </FormItem>
                  )}
                />
                <FormField
                    control={form.control}
                    name="assignedTo"
                    render={({ field }) => (
                    <FormItem>
                        <FormLabel>Assigned To (User ID)</FormLabel>
                        <FormControl>
                            <Input placeholder="Enter user UUID" {...field} value={field.value ?? ''} />
                        </FormControl>
                        <FormMessage />
                    </FormItem>
                    )}
                />
                <FormField
                    control={form.control}
                    name="details"
                    render={({ field }) => (
                    <FormItem>
                        <FormLabel>Details (JSON format)</FormLabel>
                        <FormControl>
                        <Textarea
                            placeholder='e.g., { "inquiry": "..." }'
                            rows={6}
                            {...field}
                        />
                        </FormControl>
                        <FormMessage />
                    </FormItem>
                    )}
                />
                <FormField
                    control={form.control}
                    name="internalNotes"
                    render={({ field }) => (
                    <FormItem>
                        <FormLabel>Internal Notes</FormLabel>
                        <FormControl>
                        <Textarea
                            placeholder="Add internal notes here..."
                            rows={4}
                            {...field}
                        />
                        </FormControl>
                        <FormMessage />
                    </FormItem>
                    )}
                />
            </div>
        </div>
        <div className="mt-8 flex justify-end gap-4">
          <Button type="button" variant="outline" asChild>
            <Link href={`/admin/form_submissions/${submission.id}`}>Cancel</Link>
          </Button>
          <Button type="submit" disabled={isSubmitting}>
            {isSubmitting && <Loader2 className="mr-2 h-4 w-4 animate-spin" />}
            Save Changes
          </Button>
        </div>
      </form>
    </Form>
  );
}
</file>

<file path="src/app/admin/services/columns.tsx">
"use client"

import { ColumnDef } from "@tanstack/react-table"
import { Service } from "@/lib/types"
import { MoreHorizontal, ArrowUpDown } from "lucide-react"
import { Button } from "@/components/ui/button"
import {
  DropdownMenu,
  DropdownMenuContent,
  DropdownMenuItem,
  DropdownMenuLabel,
  DropdownMenuSeparator,
  DropdownMenuTrigger,
} from "@/components/ui/dropdown-menu"
import Link from 'next/link';
import { Badge } from "@/components/ui/badge"

interface ColumnsOptions {
    onDelete: (service: Service) => void;
}

export const columns = ({ onDelete }: ColumnsOptions): ColumnDef<Service>[] => [
    {
        accessorKey: "title",
        header: ({ column }) => {
            return (
              <Button
                variant="ghost"
                onClick={() => column.toggleSorting(column.getIsSorted() === "asc")}
              >
                Title
                <ArrowUpDown className="ml-2 h-4 w-4" />
              </Button>
            )
        },
        cell: ({ row }) => {
            return (
                <Link href={`/admin/services/${row.original.id}`} className="font-medium text-primary hover:underline">
                    {row.original.title}
                </Link>
            )
        }
    },
    {
        accessorKey: "category",
        header: "Category",
    },
    {
        accessorKey: "published",
        header: "Status",
        cell: ({ row }) => {
            const published = row.getValue("published") as boolean;
            return <Badge variant={published ? "default" : "secondary"}>{published ? "Published" : "Draft"}</Badge>
        }
    },
    {
        accessorKey: "featured",
        header: "Featured",
        cell: ({ row }) => {
            const featured = row.getValue("featured") as boolean;
            return featured ? <Badge variant="outline">Yes</Badge> : 'No'
        }
    },
    {
        accessorKey: "pricing",
        header: "Pricing (ZAR)",
        cell: ({ row }) => {
            const amount = parseFloat(row.getValue("pricing"))
            if (isNaN(amount)) return "N/A"
            const formatted = new Intl.NumberFormat("en-ZA", {
              style: "currency",
              currency: "ZAR",
            }).format(amount)
       
            return <div className="font-medium">{formatted}</div>
        },
    },
    {
        id: "actions",
        cell: ({ row }) => {
          const service = row.original
     
          return (
            <DropdownMenu>
              <DropdownMenuTrigger asChild>
                <Button variant="ghost" className="h-8 w-8 p-0">
                  <span className="sr-only">Open menu</span>
                  <MoreHorizontal className="h-4 w-4" />
                </Button>
              </DropdownMenuTrigger>
              <DropdownMenuContent align="end">
                <DropdownMenuLabel>Actions</DropdownMenuLabel>
                <DropdownMenuItem asChild>
                    <Link href={`/admin/services/${service.id}`}>View Details</Link>
                </DropdownMenuItem>
                <DropdownMenuItem asChild>
                    <Link href={`/admin/services/${service.id}/edit`}>Edit</Link>
                </DropdownMenuItem>
                <DropdownMenuSeparator />
                 <DropdownMenuItem 
                    className="text-destructive focus:bg-destructive/10 focus:text-destructive"
                    onClick={() => onDelete(service)}
                 >
                    Delete
                </DropdownMenuItem>
              </DropdownMenuContent>
            </DropdownMenu>
          )
        },
    },
]
</file>

<file path="src/app/admin/services/data-table.tsx">
"use client"

import {
  ColumnDef,
  flexRender,
  getCoreRowModel,
  useReactTable,
  getPaginationRowModel,
  getSortedRowModel,
  SortingState,
  getFilteredRowModel,
  ColumnFiltersState,
} from "@tanstack/react-table"

import {
  Table,
  TableBody,
  TableCell,
  TableHead,
  TableHeader,
  TableRow,
} from "@/components/ui/table"
import { Button } from "@/components/ui/button"
import { useState } from "react"
import { Skeleton } from "@/components/ui/skeleton"
import { Input } from "@/components/ui/input"

interface DataTableProps<TData, TValue> {
  columns: ColumnDef<TData, TValue>[]
  data: TData[]
  isLoading?: boolean
}

export function DataTable<TData, TValue>({
  columns,
  data,
  isLoading = false
}: DataTableProps<TData, TValue>) {
    const [sorting, setSorting] = useState<SortingState>([])
    const [columnFilters, setColumnFilters] = useState<ColumnFiltersState>([])

  const table = useReactTable({
    data,
    columns,
    getCoreRowModel: getCoreRowModel(),
    getPaginationRowModel: getPaginationRowModel(),
    onSortingChange: setSorting,
    getSortedRowModel: getSortedRowModel(),
    onColumnFiltersChange: setColumnFilters,
    getFilteredRowModel: getFilteredRowModel(),
    state: {
        sorting,
        columnFilters,
    }
  })

  return (
    <div>
        <div className="flex items-center py-4">
            <Input
            placeholder="Filter by title..."
            value={(table.getColumn("title")?.getFilterValue() as string) ?? ""}
            onChange={(event) =>
                table.getColumn("title")?.setFilterValue(event.target.value)
            }
            className="max-w-sm"
            />
        </div>
        <div className="rounded-md border">
        <Table>
            <TableHeader>
            {table.getHeaderGroups().map((headerGroup) => (
                <TableRow key={headerGroup.id}>
                {headerGroup.headers.map((header) => {
                    return (
                    <TableHead key={header.id}>
                        {header.isPlaceholder
                        ? null
                        : flexRender(
                            header.column.columnDef.header,
                            header.getContext()
                            )}
                    </TableHead>
                    )
                })}
                </TableRow>
            ))}
            </TableHeader>
            <TableBody>
            {isLoading ? (
                Array.from({ length: 5 }).map((_, i) => (
                    <TableRow key={i}>
                        {columns.map((col, j) => (
                            <TableCell key={j}>
                                <Skeleton className="h-6 w-full" />
                            </TableCell>
                        ))}
                    </TableRow>
                ))
            ) : table.getRowModel().rows?.length ? (
                table.getRowModel().rows.map((row) => (
                <TableRow
                    key={row.id}
                    data-state={row.getIsSelected() && "selected"}
                >
                    {row.getVisibleCells().map((cell) => (
                    <TableCell 
                        key={cell.id} 
                    >
                        {flexRender(cell.column.columnDef.cell, cell.getContext())}
                    </TableCell>
                    ))}
                </TableRow>
                ))
            ) : (
                <TableRow>
                <TableCell colSpan={columns.length} className="h-24 text-center">
                    No results.
                </TableCell>
                </TableRow>
            )}
            </TableBody>
        </Table>
        </div>
        <div className="flex items-center justify-end space-x-2 py-4">
            <Button
                variant="outline"
                size="sm"
                onClick={() => table.previousPage()}
                disabled={!table.getCanPreviousPage()}
            >
                Previous
            </Button>
            <Button
                variant="outline"
                size="sm"
                onClick={() => table.nextPage()}
                disabled={!table.getCanNextPage()}
            >
                Next
            </Button>
        </div>
    </div>
  )
}
</file>

<file path="src/app/admin/services/loading.tsx">
import { Card, CardContent, CardHeader, CardFooter } from '@/components/ui/card';
import { Skeleton } from '@/components/ui/skeleton';

export default function ServicesLoading() {
    return (
        <div className="grid grid-cols-1 gap-6 md:grid-cols-2 lg:grid-cols-3">
            {Array.from({ length: 6 }).map((_, i) => (
                <Card key={i}>
                    <CardHeader>
                        <div className="flex justify-between items-start">
                            <Skeleton className="h-6 w-3/4" />
                            <Skeleton className="h-8 w-8" />
                        </div>
                        <Skeleton className="h-4 w-1/2" />
                    </CardHeader>
                    <CardContent className="space-y-4">
                        <div className="flex gap-2">
                             <Skeleton className="h-5 w-16" />
                             <Skeleton className="h-5 w-20" />
                        </div>
                        <Skeleton className="h-12 w-full" />
                    </CardContent>
                    <CardFooter>
                        <Skeleton className="h-10 w-full" />
                    </CardFooter>
                </Card>
            ))}
        </div>
    )
}
</file>

<file path="src/app/admin/testimonials/new/page.tsx">
import { Card, CardContent, CardHeader, CardTitle, CardDescription } from '@/components/ui/card';
import Link from 'next/link';
import { Button } from '@/components/ui/button';
import { ArrowLeft } from 'lucide-react';
import TestimonialForm from '../TestimonialForm';

export const metadata = {
    title: 'New Testimonial | Bilacert Admin Pro',
    description: 'Add a new testimonial from a Facebook post.',
};

export default function NewTestimonialPage() {
    return (
        <div className="space-y-6">
            <Button variant="outline" asChild>
                <Link href="/admin/testimonials">
                    <ArrowLeft className="mr-2 h-4 w-4" />
                    Back to Testimonials
                </Link>
            </Button>
            <Card>
                <CardHeader>
                    <CardTitle>Add New Testimonial</CardTitle>
                    <CardDescription>Enter the URL of the Facebook post below.</CardDescription>
                </CardHeader>
                <CardContent>
                    <TestimonialForm />
                </CardContent>
            </Card>
        </div>
    );
}
</file>

<file path="src/app/admin/testimonials/loading.tsx">
import { Card, CardContent, CardFooter, CardHeader } from '@/components/ui/card';
import { Skeleton } from '@/components/ui/skeleton';
import { Button } from '@/components/ui/button';
import { PlusCircle } from 'lucide-react';

export default function TestimonialsLoading() {
    return (
        <div className="space-y-6">
            <div className="flex justify-end">
                <Button disabled>
                    <PlusCircle className="mr-2 h-4 w-4" />
                    Add Testimonial
                </Button>
            </div>
            <div className="grid gap-6 md:grid-cols-2 lg:grid-cols-3">
                {Array.from({ length: 3 }).map((_, i) => (
                    <Card key={i}>
                         <CardHeader>
                            <Skeleton className="h-5 w-full" />
                        </CardHeader>
                        <CardContent className="flex items-center justify-center p-6">
                           <div className="space-y-4 text-center">
                                <Skeleton className="mx-auto h-12 w-12 rounded-full" />
                                <Skeleton className="h-4 w-32" />
                            </div>
                        </CardContent>
                        <CardFooter className="flex justify-end">
                            <Skeleton className="h-8 w-8" />
                        </CardFooter>
                    </Card>
                ))}
            </div>
        </div>
    )
}
</file>

<file path="src/app/admin/testimonials/TestimonialDetails.tsx">
'use client';

import { Card, CardContent } from '@/components/ui/card';
import { Button } from '@/components/ui/button';
import Link from 'next/link';
import { ArrowLeft, Edit, Trash2 } from 'lucide-react';
import TestimonialEmbed from './TestimonialEmbed';
import DeleteTestimonialDialog from './DeleteTestimonialDialog';
import { useState } from 'react';
import { useRouter } from 'next/navigation';
import type { Testimonial } from '@/lib/types';

interface TestimonialDetailsProps {
    testimonial: Testimonial;
}

export default function TestimonialDetails({ testimonial }: TestimonialDetailsProps) {
    const router = useRouter();
    const [isDeleteDialogOpen, setIsDeleteDialogOpen] = useState(false);

    if (!testimonial) {
        return null;
    }

    const handleDelete = () => {
        setIsDeleteDialogOpen(true);
    };
    
    const handleCloseDialog = () => {
        setIsDeleteDialogOpen(false);
    };

    const onDeleted = () => {
        setIsDeleteDialogOpen(false);
        router.push('/admin/testimonials');
        router.refresh();
    }
  
    return (
    <>
      <div className="space-y-6">
        <div className="flex items-center justify-between">
            <Button variant="outline" asChild>
                <Link href="/admin/testimonials">
                    <ArrowLeft className="mr-2 h-4 w-4" />
                    Back to Testimonials
                </Link>
            </Button>
            <div className="flex gap-2">
                <Button asChild>
                    <Link href={`/admin/testimonials/${testimonial.id}/edit`}>
                        <Edit className="mr-2 h-4 w-4" /> Edit
                    </Link>
                </Button>
                <Button variant="destructive" onClick={handleDelete}>
                    <Trash2 className="mr-2 h-4 w-4" /> Delete
                </Button>
            </div>
        </div>

        <Card>
            <CardContent className="h-[calc(100vh-20rem)] overflow-y-auto p-0">
                <TestimonialEmbed postUrl={testimonial.postUrl} />
            </CardContent>
        </Card>
      </div>
      
      {isDeleteDialogOpen && (
        <DeleteTestimonialDialog
            isOpen={isDeleteDialogOpen}
            onClose={handleCloseDialog}
            testimonial={testimonial}
            onDeleted={onDeleted}
        />
      )}
    </>
  );
}
</file>

<file path="src/app/admin/testimonials/TestimonialEmbed.tsx">
'use client';

import { useEffect } from 'react';

declare global {
  interface Window {
    FB?: {
      init: (params: { xfbml: boolean; version: string; }) => void;
      XFBML: {
        parse: (element?: HTMLElement) => void;
      };
    };
    fbAsyncInit?: () => void;
  }
}

interface TestimonialEmbedProps {
  postUrl: string;
}

export default function TestimonialEmbed({ postUrl }: TestimonialEmbedProps) {
  useEffect(() => {
    // Re-parse the DOM for FB elements whenever the URL changes.
    if (window.FB) {
      window.FB.XFBML.parse();
    }
  }, [postUrl]);

  return (
    <div className="p-4">
      <div
        key={postUrl} // Using key to help React remount the component on URL change
        className="fb-post"
        data-href={postUrl}
        data-show-text="true"
        data-adapt-container-width="true"
      />
    </div>
  );
}
</file>

<file path="src/app/admin/layout.tsx">
'use client';

import React, { useEffect } from 'react';
import { usePathname, useRouter } from 'next/navigation';
import { useUser } from '@/hooks/useUser';
import { SidebarProvider } from '@/components/ui/sidebar';
import AdminSidebar from '@/components/admin/Sidebar';
import AdminHeader from '@/components/admin/Header';
import { Loader2 } from 'lucide-react';
import { isSupabaseConfigured } from '@/lib/supabase/supabase';
import SupabaseNotConfigured from '@/components/admin/SupabaseNotConfigured';

export default function AdminLayout({
  children,
}: {
  children: React.ReactNode;
}) {
  const pathname = usePathname();
  const router = useRouter();

  if (pathname !== '/admin/login' && !isSupabaseConfigured) {
    return <SupabaseNotConfigured />;
  }
  
  const { user, loading } = useUser();

  useEffect(() => {
    if (!loading) {
      if (!user && pathname !== '/admin/login') {
        router.push('/admin/login');
      }
      if (user && pathname === '/admin/login') {
        router.push('/admin/dashboard');
      }
    }
  }, [user, loading, pathname, router]);

  if (loading && pathname !== '/admin/login') {
    return (
      <div className="flex h-screen w-full items-center justify-center bg-background">
        <Loader2 className="h-8 w-8 animate-spin text-primary" />
      </div>
    );
  }

  if (!user && pathname !== '/admin/login') {
    return null; 
  }

  if (user && pathname === '/admin/login') {
    return null;
  }
  
  if (pathname === '/admin/login') {
    return <>{children}</>;
  }

  return (
    <SidebarProvider>
      <AdminSidebar />
      <main className="flex min-h-svh flex-1 flex-col bg-background">
        <AdminHeader />
        <div className="flex-1 p-4 sm:p-6 lg:p-8">{children}</div>
      </main>
    </SidebarProvider>
  );
}
</file>

<file path="src/app/contact/page.tsx">
import type { Metadata } from 'next';
import ContactForm from './ContactForm';

export const metadata: Metadata = {
	title: 'Contact Us',
	description:
		'Get in touch with Bilacert for expert ICASA and NRCS compliance guidance. Call 075 430 4433 or email info@bilacert.co.za for a free consultation.',
	keywords: [
		'contact Bilacert',
		'ICASA compliance consultation',
		'NRCS LOA consultation',
		'compliance expert South Africa',
		'regulatory approval consultation',
		'free compliance consultation',
	],
	openGraph: {
		title: 'Contact Bilacert - Get Expert Compliance Guidance',
		description:
			'Get in touch with Bilacert for expert ICASA and NRCS compliance guidance. Call 075 430 4433 or email info@bilacert.co.za for a free consultation.',
		url: 'https://bilacert.co.za/contact',
		type: 'website',
	},
	alternates: {
		canonical: 'https://bilacert.co.za/contact',
	},
};

export default function ContactPage() {
	return <ContactForm />;
}
</file>

<file path="src/app/faq/FAQContent.tsx">
'use client';

import { useState } from 'react';
import Image from 'next/image';
import { ChevronDown, ChevronUp } from 'lucide-react';
import StructuredData from '@/components/StructuredData';
import { Accordion, AccordionContent, AccordionItem, AccordionTrigger } from '@/components/ui/accordion';
import { Button } from '@/components/ui/button';
import Link from 'next/link';

export default function FAQContent() {
	const faqCategories = [
		{
			title: 'General Questions',
			questions: [
				{
					question: 'What is Bilacert and what services do you provide?',
					answer:
						'Bilacert is a specialized compliance consultancy that simplifies ICASA and NRCS LOA approvals for South African businesses. We provide expert guidance for type approvals, licensing, and regulatory compliance across telecommunications and electronic communications sectors.',
				},
				{
					question: 'How long does the compliance process typically take?',
					answer:
						'Processing times vary by service type. ICASA type approvals typically take 30 Days, NRCS LOA applications also take 30 - 90 working days, while licensing applications can take 30-60 working days. We work to expedite these processes and keep you informed throughout.',
				},
				{
					question: 'Do you work with businesses of all sizes?',
					answer:
						'Yes, we work with businesses of all sizes, from startups and SMEs to large corporations. Our services are tailored to meet the specific needs and budgets of each client, ensuring everyone can access professional compliance support.',
				},
			],
		},
		{
			title: 'ICASA Type Approvals',
			questions: [
				{
					question: 'What types of devices require ICASA type approval?',
					answer:
						'All telecommunications and radio frequency devices require ICASA type approval before being sold or used in South Africa. This includes wireless routers, mobile phones, radio equipment, Bluetooth devices, and other electronic communication equipment.',
				},
			],
		},
	];

	// Prepare FAQ data for structured data
	const faqData = {
		questions: faqCategories.flatMap((category) =>
			category.questions.map((q) => ({
				question: q.question,
				answer: q.answer,
			}))
		),
	};

	return (
		<div className='min-h-screen'>
			<StructuredData
				type='FAQ'
				data={faqData}
			/>
			{/* Hero Section */}
			<section className='relative text-white py-20'>
				<Image
					src="https://picsum.photos/seed/faq/1920/1080"
                    data-ai-hint="question mark"
					alt='Frequently Asked Questions'
					fill
					priority
					className='object-cover'
				/>
				<div className='absolute inset-0 bg-black/40' />
				<div className='relative max-w-7xl mx-auto px-4 sm:px-6 lg:px-8'>
					<div className='text-center'>
						<h1 className='text-4xl lg:text-5xl font-bold mb-6'>Frequently Asked Questions</h1>
						<p className='text-xl text-gray-200 max-w-3xl mx-auto'>
							Find answers to common questions about ICASA and NRCS compliance, type approvals,
							licensing, and regulatory requirements in South Africa.
						</p>
					</div>
				</div>
			</section>

			{/* FAQ Content */}
			<section className='py-20'>
				<div className='max-w-4xl mx-auto px-4 sm:px-6 lg:px-8'>
					{faqCategories.map((category, categoryIndex) => (
						<div key={categoryIndex} className="mb-12">
							<h2 className='text-3xl font-bold text-primary mb-6'>{category.title}</h2>
							<Accordion type="single" collapsible className="w-full">
								{category.questions.map((item, itemIndex) => (
									<AccordionItem value={`item-${categoryIndex}-${itemIndex}`} key={itemIndex}>
										<AccordionTrigger className="text-lg text-left">{item.question}</AccordionTrigger>
										<AccordionContent className="text-muted-foreground">
											{item.answer}
										</AccordionContent>
									</AccordionItem>
								))}
							</Accordion>
						</div>
					))}
				</div>
			</section>

			{/* CTA Section */}
			<section className='py-20 bg-secondary-gray'>
				<div className='max-w-4xl mx-auto px-4 sm:px-6 lg:px-8 text-center'>
					<h2 className='text-3xl font-bold text-primary mb-6'>Still Have Questions?</h2>
					<p className='text-xl text-gray-600 mb-8'>
						Can&apos;t find the answer you&apos;re looking for? Our compliance experts are here to
						help.
					</p>
					<div className='flex flex-col sm:flex-row gap-4 justify-center'>
						<Button asChild size="lg">
							<Link href='/contact'>Contact Us</Link>
						</Button>
						<Button asChild variant="outline" size="lg">
							<a href='tel:0754304433'>Call 075 430 4433</a>
						</Button>
					</div>
				</div>
			</section>
		</div>
	);
}
</file>

<file path="src/app/faq/page.tsx">
import type { Metadata } from 'next';
import FAQContent from './FAQContent';

export const metadata: Metadata = {
	title: 'Frequently Asked Questions',
	description:
		'Find answers to common questions about ICASA and NRCS compliance, type approvals, licensing, and regulatory requirements in South Africa.',
	keywords: [
		'ICASA FAQ',
		'NRCS LOA questions',
		'compliance FAQ South Africa',
		'type approval questions',
		'licensing FAQ',
		'regulatory compliance questions',
		'ICASA NRCS help',
	],
	openGraph: {
		title: 'FAQ - ICASA & NRCS Compliance Questions Answered',
		description:
			'Find answers to common questions about ICASA and NRCS compliance, type approvals, licensing, and regulatory requirements in South Africa.',
		url: 'https://bilacert.co.za/faq',
		type: 'website',
	},
	alternates: {
		canonical: 'https://bilacert.co.za/faq',
	},
};

export default function FAQPage() {
	return <FAQContent />;
}
</file>

<file path="src/components/admin/Sidebar.tsx">
'use client';

import Link from 'next/link';
import { usePathname, useRouter } from 'next/navigation';
import {
  Sidebar,
  SidebarContent,
  SidebarHeader,
  SidebarMenu,
  SidebarMenuItem,
  SidebarMenuButton,
  SidebarFooter,
  useSidebar,
} from '@/components/ui/sidebar';
import { Logo } from '@/components/icons';
import {
  LayoutDashboard,
  Briefcase,
  FileText,
  MessageSquare,
  LogOut,
  Settings,
  Users,
  FileSpreadsheet,
} from 'lucide-react';
import { supabase } from '@/lib/supabase/supabase';
import { useToast } from '@/hooks/use-toast';

const navItems = [
  { href: '/admin/dashboard', icon: LayoutDashboard, label: 'Dashboard' },
  { href: '/admin/services', icon: Briefcase, label: 'Services' },
  { href: '/admin/blogs', icon: FileText, label: 'Blogs' },
  { href: '/admin/testimonials', icon: MessageSquare, label: 'Testimonials' },
  { href: '/admin/contacts', icon: Users, label: 'Contacts' },
  { href: '/admin/form_submissions', icon: FileSpreadsheet, label: 'Submissions' },
];

export default function AdminSidebar() {
  const pathname = usePathname();
  const router = useRouter();
  const { toast } = useToast();
  const { setOpenMobile } = useSidebar();

  const handleLogout = async () => {
    try {
      const { error } = await supabase.auth.signOut();
      if (error) throw error;
      setOpenMobile(false);
      router.push('/admin/login');
    } catch (error: any) {
      toast({
        variant: 'destructive',
        title: 'Logout Failed',
        description: error.message,
      });
    }
  };

  return (
    <Sidebar>
      <SidebarHeader>
        <Link href="/admin/dashboard" className="flex items-center gap-2" onClick={() => setOpenMobile(false)}>
          <Logo className="h-8 w-8 text-sidebar-primary" />
          <span className="text-lg font-semibold text-sidebar-foreground">
            Bilacert Admin
          </span>
        </Link>
      </SidebarHeader>
      <SidebarContent className="p-2">
        <SidebarMenu>
          {navItems.map((item) => (
            <SidebarMenuItem key={item.href}>
              <SidebarMenuButton
                asChild
                isActive={pathname.startsWith(item.href)}
                className="w-full justify-start"
                tooltip={item.label}
                onClick={() => setOpenMobile(false)}
              >
                <Link href={item.href}>
                  <item.icon className="h-5 w-5" />
                  <span>{item.label}</span>
                </Link>
              </SidebarMenuButton>
            </SidebarMenuItem>
          ))}
        </SidebarMenu>
      </SidebarContent>
      <SidebarFooter>
        <SidebarMenu>
          <SidebarMenuItem>
            <SidebarMenuButton
              asChild
              className="w-full justify-start"
              tooltip="Settings"
              onClick={() => setOpenMobile(false)}
            >
              <Link href="#">
                <Settings className="h-5 w-5" />
                <span>Settings</span>
              </Link>
            </SidebarMenuButton>
          </SidebarMenuItem>
          <SidebarMenuItem>
            <SidebarMenuButton
              onClick={handleLogout}
              className="w-full justify-start"
              tooltip="Log out"
            >
              <LogOut className="h-5 w-5" />
              <span>Log Out</span>
            </SidebarMenuButton>
          </SidebarMenuItem>
        </SidebarMenu>
      </SidebarFooter>
    </Sidebar>
  );
}
</file>

<file path="src/components/ui/chart.tsx">
"use client"

import * as React from "react"
import * as RechartsPrimitive from "recharts"

import { cn } from "@/lib/utils"

// Format: { THEME_NAME: CSS_SELECTOR }
const THEMES = { light: "", dark: ".dark" } as const

export type ChartConfig = {
  [k in string]: {
    label?: React.ReactNode
    icon?: React.ComponentType
  } & (
    | { color?: string; theme?: never }
    | { color?: never; theme: Record<keyof typeof THEMES, string> }
  )
}

type ChartContextProps = {
  config: ChartConfig
}

const ChartContext = React.createContext<ChartContextProps | null>(null)

function useChart() {
  const context = React.useContext(ChartContext)

  if (!context) {
    throw new Error("useChart must be used within a <ChartContainer />")
  }

  return context
}

const ChartContainer = React.forwardRef<
  HTMLDivElement,
  React.ComponentProps<"div"> & {
    config: ChartConfig
    children: React.ComponentProps<
      typeof RechartsPrimitive.ResponsiveContainer
    >["children"]
  }
>(({ id, className, children, config, ...props }, ref) => {
  const uniqueId = React.useId()
  const chartId = `chart-${id || uniqueId.replace(/:/g, "")}`

  return (
    <ChartContext.Provider value={{ config }}>
      <div
        data-chart={chartId}
        ref={ref}
        className={cn(
          "flex aspect-video justify-center text-xs [&_.recharts-cartesian-axis-tick_text]:fill-muted-foreground [&_.recharts-cartesian-grid_line[stroke='#ccc']]:stroke-border/50 [&_.recharts-curve.recharts-tooltip-cursor]:stroke-border [&_.recharts-dot[stroke='#fff']]:stroke-transparent [&_.recharts-layer]:outline-none [&_.recharts-polar-grid_[stroke='#ccc']]:stroke-border [&_.recharts-radial-bar-background-sector]:fill-muted [&_.recharts-rectangle.recharts-tooltip-cursor]:fill-muted [&_.recharts-reference-line_[stroke='#ccc']]:stroke-border [&_.recharts-sector[stroke='#fff']]:stroke-transparent [&_.recharts-sector]:outline-none [&_.recharts-surface]:outline-none",
          className
        )}
        {...props}
      >
        <ChartStyle id={chartId} config={config} />
        <RechartsPrimitive.ResponsiveContainer>
          {children}
        </RechartsPrimitive.ResponsiveContainer>
      </div>
    </ChartContext.Provider>
  )
})
ChartContainer.displayName = "Chart"

const ChartStyle = ({ id, config }: { id: string; config: ChartConfig }) => {
  const colorConfig = Object.entries(config).filter(
    ([, config]) => config.theme || config.color
  )

  if (!colorConfig.length) {
    return null
  }

  return (
    <style
      dangerouslySetInnerHTML={{
        __html: Object.entries(THEMES)
          .map(
            ([theme, prefix]) => `
${prefix} [data-chart=${id}] {
${colorConfig
  .map(([key, itemConfig]) => {
    const color =
      itemConfig.theme?.[theme as keyof typeof itemConfig.theme] ||
      itemConfig.color
    return color ? `  --color-${key}: ${color};` : null
  })
  .join("\n")}
}
`
          )
          .join("\n"),
      }}
    />
  )
}

const ChartTooltip = RechartsPrimitive.Tooltip

const ChartTooltipContent = React.forwardRef<
  HTMLDivElement,
  React.ComponentProps<typeof RechartsPrimitive.Tooltip> &
    React.ComponentProps<"div"> & {
      hideLabel?: boolean
      hideIndicator?: boolean
      indicator?: "line" | "dot" | "dashed"
      nameKey?: string
      labelKey?: string
    }
>(
  (
    {
      active,
      payload,
      className,
      indicator = "dot",
      hideLabel = false,
      hideIndicator = false,
      label,
      labelFormatter,
      labelClassName,
      formatter,
      color,
      nameKey,
      labelKey,
    },
    ref
  ) => {
    const { config } = useChart()

    const tooltipLabel = React.useMemo(() => {
      if (hideLabel || !payload?.length) {
        return null
      }

      const [item] = payload
      const key = `${labelKey || item.dataKey || item.name || "value"}`
      const itemConfig = getPayloadConfigFromPayload(config, item, key)
      const value =
        !labelKey && typeof label === "string"
          ? config[label as keyof typeof config]?.label || label
          : itemConfig?.label

      if (labelFormatter) {
        return (
          <div className={cn("font-medium", labelClassName)}>
            {labelFormatter(value, payload)}
          </div>
        )
      }

      if (!value) {
        return null
      }

      return <div className={cn("font-medium", labelClassName)}>{value}</div>
    }, [
      label,
      labelFormatter,
      payload,
      hideLabel,
      labelClassName,
      config,
      labelKey,
    ])

    if (!active || !payload?.length) {
      return null
    }

    const nestLabel = payload.length === 1 && indicator !== "dot"

    return (
      <div
        ref={ref}
        className={cn(
          "grid min-w-[8rem] items-start gap-1.5 rounded-lg border border-border/50 bg-background px-2.5 py-1.5 text-xs shadow-xl",
          className
        )}
      >
        {!nestLabel ? tooltipLabel : null}
        <div className="grid gap-1.5">
          {payload.map((item: any, index: number) => {
            const key = `${nameKey || item.name || item.dataKey || "value"}`
            const itemConfig = getPayloadConfigFromPayload(config, item, key)
            const indicatorColor = color || item.payload.fill || item.color

            return (
              <div
                key={item.dataKey}
                className={cn(
                  "flex w-full flex-wrap items-stretch gap-2 [&>svg]:h-2.5 [&>svg]:w-2.5 [&>svg]:text-muted-foreground",
                  indicator === "dot" && "items-center"
                )}
              >
                {formatter && item?.value !== undefined && item.name ? (
                  formatter(item.value, item.name, item, index, item.payload)
                ) : (
                  <>
                    {itemConfig?.icon ? (
                      <itemConfig.icon />
                    ) : (
                      !hideIndicator && (
                        <div
                          className={cn(
                            "shrink-0 rounded-[2px] border-[--color-border] bg-[--color-bg]",
                            {
                              "h-2.5 w-2.5": indicator === "dot",
                              "w-1": indicator === "line",
                              "w-0 border-[1.5px] border-dashed bg-transparent":
                                indicator === "dashed",
                              "my-0.5": nestLabel && indicator === "dashed",
                            }
                          )}
                          style={
                            {
                              "--color-bg": indicatorColor,
                              "--color-border": indicatorColor,
                            } as React.CSSProperties
                          }
                        />
                      )
                    )}
                    <div
                      className={cn(
                        "flex flex-1 justify-between leading-none",
                        nestLabel ? "items-end" : "items-center"
                      )}
                    >
                      <div className="grid gap-1.5">
                        {nestLabel ? tooltipLabel : null}
                        <span className="text-muted-foreground">
                          {itemConfig?.label || item.name}
                        </span>
                      </div>
                      {item.value && (
                        <span className="font-mono font-medium tabular-nums text-foreground">
                          {item.value.toLocaleString()}
                        </span>
                      )}
                    </div>
                  </>
                )}
              </div>
            )
          })}
        </div>
      </div>
    )
  }
)
ChartTooltipContent.displayName = "ChartTooltip"

const ChartLegend = RechartsPrimitive.Legend

const ChartLegendContent = React.forwardRef<
  HTMLDivElement,
  React.ComponentProps<"div"> &
    Pick<RechartsPrimitive.LegendProps, "payload" | "verticalAlign"> & {
      hideIcon?: boolean
      nameKey?: string
    }
>(
  (
    { className, hideIcon = false, payload, verticalAlign = "bottom", nameKey },
    ref
  ) => {
    const { config } = useChart()

    if (!payload?.length) {
      return null
    }

    return (
      <div
        ref={ref}
        className={cn(
          "flex items-center justify-center gap-4",
          verticalAlign === "top" ? "pb-3" : "pt-3",
          className
        )}
      >
        {payload.map((item: any) => {
          const key = `${nameKey || item.dataKey || "value"}`
          const itemConfig = getPayloadConfigFromPayload(config, item, key)

          return (
            <div
              key={item.value}
              className={cn(
                "flex items-center gap-1.5 [&>svg]:h-3 [&>svg]:w-3 [&>svg]:text-muted-foreground"
              )}
            >
              {itemConfig?.icon && !hideIcon ? (
                <itemConfig.icon />
              ) : (
                <div
                  className="h-2 w-2 shrink-0 rounded-[2px]"
                  style={{
                    backgroundColor: item.color,
                  }}
                />
              )}
              {itemConfig?.label}
            </div>
          )
        })}
      </div>
    )
  }
)
ChartLegendContent.displayName = "ChartLegend"

// Helper to extract item config from a payload.
function getPayloadConfigFromPayload(
  config: ChartConfig,
  payload: unknown,
  key: string
) {
  if (typeof payload !== "object" || payload === null) {
    return undefined
  }

  const payloadPayload =
    "payload" in payload &&
    typeof payload.payload === "object" &&
    payload.payload !== null
      ? payload.payload
      : undefined

  let configLabelKey: string = key

  if (
    key in payload &&
    typeof payload[key as keyof typeof payload] === "string"
  ) {
    configLabelKey = payload[key as keyof typeof payload] as string
  } else if (
    payloadPayload &&
    key in payloadPayload &&
    typeof payloadPayload[key as keyof typeof payloadPayload] === "string"
  ) {
    configLabelKey = payloadPayload[
      key as keyof typeof payloadPayload
    ] as string
  }

  return configLabelKey in config
    ? config[configLabelKey]
    : config[key as keyof typeof config]
}

export {
  ChartContainer,
  ChartTooltip,
  ChartTooltipContent,
  ChartLegend,
  ChartLegendContent,
  ChartStyle,
}
</file>

<file path="src/components/Header.tsx">
'use client';

import { useState } from 'react';
import Link from 'next/link';
import { Menu, X, Phone, Mail } from 'lucide-react';
import Image from 'next/image';
import { usePathname } from 'next/navigation';
import { cn } from '@/lib/utils';
import { Button } from './ui/button';

export default function Header() {
	const [isMenuOpen, setIsMenuOpen] = useState(false);
	const pathname = usePathname();

	const navigation = [
		{ name: 'Home', href: '/' },
		{ name: 'Services', href: '/services' },
		{ name: 'Blog', href: '/blog' },
		{ name: 'About', href: '/about' },
		{ name: 'FAQ', href: '/faq' },
		{ name: 'Contact', href: '/contact' },
	];

	return (
		<header className='bg-card shadow-sm sticky top-0 z-50'>
			{/* Top bar with contact info */}
			<div className='bg-primary text-primary-foreground py-2'>
				<div className='max-w-7xl mx-auto px-4 sm:px-6 lg:px-8'>
					<div className='flex justify-between items-center text-sm'>
						<div className='flex items-center space-x-6'>
							<a href="tel:0754304433" className='flex items-center space-x-2 hover:text-accent transition-colors'>
								<Phone className='h-4 w-4' />
								<span>075 430 4433</span>
							</a>
							<a href="mailto:info@bilacert.co.za" className='flex items-center space-x-2 hover:text-accent transition-colors'>
								<Mail className='h-4 w-4' />
								<span>info@bilacert.co.za</span>
							</a>
						</div>
						<div className='hidden md:block'>
							<span>Your Compliance Partner.</span>
						</div>
					</div>
				</div>
			</div>

			{/* Main navigation */}
			<div className='max-w-7xl mx-auto px-4 sm:px-6 lg:px-8'>
				<div className='flex justify-between items-center py-4'>
					{/* Logo */}
					<Link href='/' className="flex items-center gap-2 font-bold text-lg">
                        <Image src="/logo.png" alt="Bilacert Logo" width={40} height={40} />
                        <span className="text-primary hidden sm:inline">Bilacert</span>
                    </Link>

					{/* Desktop Navigation */}
					<nav className='hidden md:flex space-x-6'>
						{navigation.map((item) => (
							<Link
								key={item.name}
								href={item.href}
								className={cn(
                                    'font-medium transition-colors duration-200 text-sm',
                                    pathname === item.href ? 'text-primary' : 'text-muted-foreground hover:text-primary'
                                )}
                            >
								{item.name}
							</Link>
						))}
					</nav>

					{/* CTA Button */}
					<div className='hidden md:block'>
						<Button asChild>
                            <Link href='/contact'>
                                Get Free Consultation
                            </Link>
                        </Button>
					</div>

					{/* Mobile menu button */}
					<div className='md:hidden'>
						<Button variant="ghost" size="icon" onClick={() => setIsMenuOpen(!isMenuOpen)}>
							{isMenuOpen ? <X className='h-6 w-6' /> : <Menu className='h-6 w-6' />}
                            <span className="sr-only">Toggle menu</span>
						</Button>
					</div>
				</div>

				{/* Mobile Navigation */}
				{isMenuOpen && (
					<div className='md:hidden pb-4'>
						<nav className='px-2 pt-2 pb-3 space-y-1 bg-card border-t'>
							{navigation.map((item) => (
								<Link
									key={item.name}
									href={item.href}
									className={cn(
                                        'block px-3 py-2 rounded-md',
                                        pathname === item.href ? 'bg-secondary text-secondary-foreground' : 'text-muted-foreground hover:bg-secondary/50'
                                    )}
									onClick={() => setIsMenuOpen(false)}>
									{item.name}
								</Link>
							))}
							<div className='px-3 py-2'>
								<Button asChild className="w-full">
                                    <Link href='/contact' onClick={() => setIsMenuOpen(false)}>
                                        Get Free Consultation
                                    </Link>
                                </Button>
							</div>
						</nav>
					</div>
				)}
			</div>
		</header>
	);
}
</file>

<file path="src/components/MainLayout.tsx">
'use client';

import { usePathname } from 'next/navigation';
import Header from '@/components/Header';
import WhatsAppButton from '@/components/WhatsAppButton';

export default function MainLayout({ 
    children, 
    footer 
}: { 
    children: React.ReactNode, 
    footer: React.ReactNode 
}) {
    const pathname = usePathname();
    const isAdminPage = pathname.startsWith('/admin');

    if (isAdminPage) {
        return <>{children}</>;
    }

    return (
        <>
            <Header />
            <main className="min-h-screen">{children}</main>
            {footer}
            <WhatsAppButton />
        </>
    );
}
</file>

<file path="src/components/StructuredData.tsx">
import Script from 'next/script';

interface StructuredDataProps {
	type: 'Organization' | 'Service' | 'FAQ' | 'BreadcrumbList';
	data: Record<string, unknown>;
}

export default function StructuredData({ type, data }: StructuredDataProps) {
	const getStructuredData = () => {
		switch (type) {
			case 'Organization':
				return {
					'@context': 'https://schema.org',
					'@type': 'Organization',
					'name': 'Bilacert (Pty) Ltd',
					'alternateName': 'Bilacert',
					'url': 'https://bilacert.co.za',
					'logo': 'https://bilacert.co.za/logo.png',
					'description':
						'Bilacert simplifies ICASA and NRCS LOA compliance for South African businesses. Expert guidance for type approvals, licensing, and regulatory compliance.',
					'address': {
						'@type': 'PostalAddress',
						'addressCountry': 'ZA',
						'addressRegion': 'South Africa',
					},
					'contactPoint': {
						'@type': 'ContactPoint',
						'telephone': '+27-75-430-4433',
						'contactType': 'customer service',
						'email': 'info@bilacert.co.za',
					},
					'sameAs': ['https://bilacert.co.za'],
					'foundingDate': '2024',
					'numberOfEmployees': '1-10',
					'industry': 'Compliance Consulting',
					'serviceArea': {
						'@type': 'Country',
						'name': 'South Africa',
					},
				};

			case 'Service':
				return {
					'@context': 'https://schema.org',
					'@type': 'Service',
					'name': data.name,
					'description': data.description,
					'provider': {
						'@type': 'Organization',
						'name': 'Bilacert (Pty) Ltd',
						'url': 'https://bilacert.co.za',
					},
					'serviceType': data.serviceType,
					'areaServed': {
						'@type': 'Country',
						'name': 'South Africa',
					},
					'offers': {
						'@type': 'Offer',
						'price': data.price,
						'priceCurrency': 'ZAR',
						'availability': 'https://schema.org/InStock',
					},
				};

			case 'FAQ':
				return {
					'@context': 'https://schema.org',
					'@type': 'FAQPage',
					'mainEntity': (data.questions as Array<{ question: string; answer: string }>).map(
						(q) => ({
							'@type': 'Question',
							'name': q.question,
							'acceptedAnswer': {
								'@type': 'Answer',
								'text': q.answer,
							},
						})
					),
				};

			case 'BreadcrumbList':
				return {
					'@context': 'https://schema.org',
					'@type': 'BreadcrumbList',
					'itemListElement': (data.items as Array<{ name: string; url: string }>).map(
						(item, index: number) => ({
							'@type': 'ListItem',
							'position': index + 1,
							'name': item.name,
							'item': item.url,
						})
					),
				};

			default:
				return {};
		}
	};

	return (
		<Script
			id={`structured-data-${type.toLowerCase()}`}
			type='application/ld+json'
			dangerouslySetInnerHTML={{
				__html: JSON.stringify(getStructuredData(), null, 2),
			}}
		/>
	);
}
</file>

<file path="src/hooks/useContacts.ts">
'use client';

import { useState, useEffect, useCallback } from 'react';
import type { Contact } from '@/lib/types';
import { getContacts } from '@/app/admin/contacts/actions';

export function useContacts() {
  const [contacts, setContacts] = useState<Contact[]>([]);
  const [loading, setLoading] = useState(true);
  const [error, setError] = useState<Error | null>(null);

  const fetchContacts = useCallback(async () => {
    setLoading(true);
    try {
      const data = await getContacts();
      setContacts(data);
    } catch (error) {
      setError(error as Error);
    } finally {
      setLoading(false);
    }
  }, []);

  useEffect(() => {
    fetchContacts();
  }, [fetchContacts]);

  return { contacts, loading, error, refresh: fetchContacts };
}
</file>

<file path="src/hooks/useFormSubmission.ts">
'use client';

import { useState, useCallback } from 'react';
import { submitContactForm } from '@/app/contact/actions';

export interface FormSubmissionPayload {
	serviceId?: string; // Optional: which service the form is for
	fullName: string;
	email: string;
	phone?: string;
	message?: string;
    [key: string]: any; // Allow other properties
}

export interface FormSubmissionResponse {
	success: boolean;
	message: string;
	submissionId?: string;
	error?: string;
}

export interface UseFormSubmissionState {
	isLoading: boolean;
	isSuccess: boolean;
	error: string | null;
	successMessage: string | null;
}

/**
 * Hook for submitting forms to Supabase via Server Actions
 */
export function useFormSubmission() {
	const [isLoading, setIsLoading] = useState(false);
	const [error, setError] = useState<string | null>(null);
	const [successMessage, setSuccessMessage] = useState<string | null>(null);

	const handleSubmit = useCallback(
		async (payload: FormSubmissionPayload): Promise<FormSubmissionResponse | null> => {
			setIsLoading(true);
			setError(null);
			setSuccessMessage(null);

			try {
        const result = await submitContactForm({ ...payload, formType: 'contact' });

				if (!result.success) {
					const errorMessage = result.message || 'Failed to submit form. Please try again.';
					setError(errorMessage);
					return { success: false, message: errorMessage };
				}

				setSuccessMessage(result.message);
				return result;
			} catch (err) {
				const errorMessage =
					err instanceof Error ? err.message : 'An unexpected error occurred';
				setError(errorMessage);
				return { success: false, message: errorMessage };
			} finally {
				setIsLoading(false);
			}
		},
		[]
	);

	const reset = useCallback(() => {
		setError(null);
		setSuccessMessage(null);
		setIsLoading(false);
	}, []);

	return {
		isLoading,
		error,
		isSuccess: successMessage !== null,
		successMessage,
		handleSubmit,
		reset,
	};
}
</file>

<file path="src/hooks/useServices.ts">
'use client';

import { useState, useEffect } from 'react';
import type { Service } from '@/lib/types';
import { supabase, isSupabaseConfigured } from '@/lib/supabase/supabase';

export function useServices() {
  const [services, setServices] = useState<Service[]>([]);
  const [loading, setLoading] = useState(true);
  const [error, setError] = useState<Error | null>(null);

  useEffect(() => {
    if (!isSupabaseConfigured) {
        setLoading(false);
        return;
    }
      
    const fetchServices = async () => {
      setLoading(true);
      const { data, error } = await supabase
        .from('services')
        .select('*')
        .order('created_at', { ascending: false });

      if (error) {
        setError(error);
        setServices([]);
      } else {
        const mappedData = data.map(item => ({
            id: item.id,
            title: item.title,
            slug: item.slug,
            href: item.href,
            category: item.category,
            description: item.description,
            short_description: item.short_description,
            icon: item.icon,
            order_index: item.order_index,
            content: item.content,
            features: item.features,
            requirements: item.requirements,
            includes: item.includes,
            published: item.published,
            featured: item.featured,
            created_at: item.created_at,
            processing_time: item.processing_time,
            pricing: item.pricing,
            image: item.image,
            thumbnail: item.thumbnail,
            seo_title: item.seo_title,
            seo_description: item.seo_description,
            seo_keywords: item.seo_keywords,
            pricing_plans: item.pricing_plans,
            process_steps: item.process_steps,
            success_story: item.success_story,
            updated_at: item.updated_at,
        })) as Service[];

        setServices(mappedData);
        setError(null);
      }
      setLoading(false);
    };

    fetchServices();

    const channel = supabase
      .channel('services-realtime')
      .on(
        'postgres_changes',
        { event: '*', schema: 'public', table: 'services' },
        (payload) => {
          fetchServices();
        }
      )
      .subscribe();

    return () => {
      supabase.removeChannel(channel);
    };
  }, []);

  return { services, loading, error };
}
</file>

<file path="src/lib/supabase/admin.ts">
import { createClient } from '@supabase/supabase-js';

const supabaseUrl = process.env.NEXT_PUBLIC_SUPABASE_URL!;
const supabaseServiceRoleKey = process.env.NEXT_PUBLIC_SUPABASE_ANON_KEY!;

export const createSupabaseAdminClient = () => {
  return createClient(supabaseUrl, supabaseServiceRoleKey, {
    auth: {
      autoRefreshToken: false,
      persistSession: false,
    },
  });
};
</file>

<file path="src/lib/supabase/api.ts">
import { createServerClient } from '@supabase/ssr'
import { cookies } from 'next/headers'
import { NextResponse } from 'next/server'

// This function creates a Supabase client for use in API routes
// and ensures that the user is an authenticated admin.
export async function createAdminApiClient() {
  const cookieStore = await cookies()

  const supabase = createServerClient(
    process.env.NEXT_PUBLIC_SUPABASE_URL!,
    process.env.NEXT_PUBLIC_SUPABASE_ANON_KEY!,
    {
      cookies: {
        get(name: string) {
          return cookieStore.get(name)?.value
        },
      },
    }
  )

  const {
    data: { session },
  } = await supabase.auth.getSession()

  if (!session) {
    return {
      supabase: null,
      error: NextResponse.json({ error: 'Unauthorized' }, { status: 401 }),
    }
  }

  // Check if user is admin
  const { data: userProfile, error: profileError } = await supabase
    .from('users')
    .select('role')
    .eq('id', session.user.id)
    .single()
  
  if (profileError || userProfile?.role !== 'admin') {
     return {
      supabase: null,
      error: NextResponse.json({ error: 'Forbidden: requires admin privileges' }, { status: 403 }),
    }
  }

  return { supabase, error: null }
}
</file>

<file path="src/lib/supabase/client.ts">
import { createBrowserClient } from '@supabase/ssr'

const supabaseUrl = process.env.NEXT_PUBLIC_SUPABASE_URL!
const supabaseAnonKey = process.env.NEXT_PUBLIC_SUPABASE_ANON_KEY!

export function createClient() {
  if (!supabaseUrl || !supabaseAnonKey) {
    // THROW instead of RETURN so the return type is always the client
    throw new Error("Missing Supabase environment variables")
  }
  
  return createBrowserClient(supabaseUrl, supabaseAnonKey)
}
</file>

<file path="src/lib/supabase/server.ts">
import { createServerClient } from "@supabase/ssr";
import { cookies } from "next/headers";

const supabaseUrl = process.env.NEXT_PUBLIC_SUPABASE_URL;
const supabaseAnonKey = process.env.NEXT_PUBLIC_SUPABASE_ANON_KEY;

export const createClient = async () => {
  // Use a proper guard: If keys are missing, throw an error during development
  // rather than returning an Error object that breaks types.
  if (!supabaseUrl || !supabaseAnonKey) {
    throw new Error("Missing Supabase Environment Variables: NEXT_PUBLIC_SUPABASE_URL or NEXT_PUBLIC_SUPABASE_ANON_KEY");
  }

  const cookieStore = await cookies();

  return createServerClient(
    supabaseUrl,
    supabaseAnonKey,
    {
      cookies: {
        getAll() {
          return cookieStore.getAll();
        },
        setAll(cookiesToSet: Array<{ name: string; value: string; options?: Record<string, any> }>) {
          try {
            cookiesToSet.forEach(({ name, value, options }) =>
              cookieStore.set(name, value, options)
            );
          } catch {
            // This is expected when called from Server Components
          }
        },
      },
    }
  );
};
</file>

<file path="src/app/about/page.tsx">
import type { Metadata } from 'next';
import { Target, Eye, Zap, Heart, Shield, Users, CheckCircle } from 'lucide-react';
import Image from 'next/image';

export const metadata: Metadata = {
	title: 'About Us',
	description:
		"Learn about Bilacert, South Africa's trusted compliance partner. We simplify ICASA and NRCS approvals with our values of simplicity, clarity, efficiency, and support.",
	keywords: [
		'about Bilacert',
		'compliance consultant South Africa',
		'ICASA NRCS experts',
		'regulatory compliance team',
		'South Africa compliance company',
		'telecommunications compliance experts',
	],
	openGraph: {
		title: 'About Bilacert - Your Trusted Compliance Partner',
		description:
			"Learn about Bilacert, South Africa's trusted compliance partner. We simplify ICASA and NRCS approvals with our values of simplicity, clarity, efficiency, and support.",
		url: 'https://bilacert.co.za/about',
		type: 'website',
	},
	alternates: {
		canonical: 'https://bilacert.co.za/about',
	},
};

export default function AboutPage() {
	const values = [
		{
			title: 'Simplicity',
			description:
				'We believe compliance should be clear and straightforward. We break down complex regulations into simple, actionable steps, removing unnecessary barriers for businesses.',
			icon: <Eye className='h-8 w-8' />,
		},
		{
			title: 'Clarity',
			description:
				'We communicate in a way that is direct and transparent, avoiding unnecessary jargon. Our goal is to ensure our clients always understand their compliance status and next steps.',
			icon: <Target className='h-8 w-8' />,
		},
		{
			title: 'Efficiency',
			description:
				'We prioritize speed and accuracy, ensuring applications are processed correctly the first time. Our refined processes and deep industry knowledge minimize delays and streamline approvals.',
			icon: <Zap className='h-8 w-8' />,
		},
		{
			title: 'Support',
			description:
				'We are more than just a service provider; we are a partner. We walk alongside our clients through the entire compliance process, offering guidance and solutions every step of the way.',
			icon: <Heart className='h-8 w-8' />,
		},
		{
			title: 'Trust & Integrity',
			description:
				'Regulatory compliance is a critical business function. We operate with honesty and integrity, ensuring our clients can trust us to handle their approvals with the utmost professionalism.',
			icon: <Shield className='h-8 w-8' />,
		},
	];

	return (
		<div className='min-h-screen'>
			{/* Hero Section */}
			<section className='relative text-white py-20'>
				<Image
					src="https://picsum.photos/seed/about/1920/1080"
                    data-ai-hint="office team"
					alt='About Bilacert'
					fill
					priority
					className='object-cover'
				/>
				<div className='absolute inset-0 bg-black/40' />
				<div className='relative max-w-7xl mx-auto px-4 sm:px-6 lg:px-8'>
					<div className='text-center'>
						<h1 className='text-4xl lg:text-5xl font-bold mb-6'>About Bilacert</h1>
						<p className='text-xl lg:text-2xl text-gray-200 max-w-4xl mx-auto'>
							Your trusted compliance partner, simplifying ICASA and NRCS approvals for South
							African businesses since day one.
						</p>
					</div>
				</div>
			</section>

			{/* Mission & Purpose */}
			<section className='py-20'>
				<div className='max-w-7xl mx-auto px-4 sm:px-6 lg:px-8'>
					<div className='grid grid-cols-1 lg:grid-cols-2 gap-12 items-center'>
						<div>
							<h2 className='text-3xl lg:text-4xl font-bold text-primary mb-6'>
								Our Mission & Purpose
							</h2>
							<div className='space-y-6'>
								<div>
									<h3 className='text-xl font-semibold text-primary mb-3'>Our Purpose</h3>
									<p className='text-gray-600 text-lg'>
										To make compliance easy, accessible, and efficient for businesses, so they can
										focus on innovation and growth while we handle the regulatory complexities.
									</p>
								</div>
								<div>
									<h3 className='text-xl font-semibold text-primary mb-3'>Our Mission</h3>
									<p className='text-gray-600 text-lg'>
										Bilacert is committed to being the trusted partner in regulatory compliance,
										providing businesses with expert guidance, seamless application processes, and
										reliable support. Our mission is to remove the guesswork from licensing and
										approvals, ensuring businesses meet South African regulatory requirements with
										confidence and ease.
									</p>
								</div>
							</div>
						</div>
						<div className='bg-secondary-gray p-8 rounded-2xl'>
							<div className='space-y-6'>
								<div className='flex items-center space-x-4'>
									<div className='bg-accent p-3 rounded-lg'>
										<Users className='h-6 w-6 text-white' />
									</div>
									<div>
										<h3 className='font-semibold text-primary'>500+ Clients Served</h3>
										<p className='text-gray-600'>From startups to multinationals</p>
									</div>
								</div>
								<div className='flex items-center space-x-4'>
									<div className='bg-accent p-3 rounded-lg'>
										<CheckCircle className='h-6 w-6 text-white' />
									</div>
									<div>
										<h3 className='font-semibold text-primary'>100% Success Rate</h3>
										<p className='text-gray-600'>On first-time applications</p>
									</div>
								</div>
								<div className='flex items-center space-x-4'>
									<div className='bg-accent p-3 rounded-lg'>
										<Zap className='h-6 w-6 text-white' />
									</div>
									<div>
										<h3 className='font-semibold text-primary'>30% Faster</h3>
										<p className='text-gray-600'>Than industry average</p>
									</div>
								</div>
							</div>
						</div>
					</div>
				</div>
			</section>

			{/* Our Values */}
			<section className='py-20 bg-secondary-gray'>
				<div className='max-w-7xl mx-auto px-4 sm:px-6 lg:px-8'>
					<div className='text-center mb-16'>
						<h2 className='text-3xl lg:text-4xl font-bold text-primary mb-4'>Our Values</h2>
						<p className='text-xl text-gray-600 max-w-3xl mx-auto'>
							The principles that guide everything we do and shape our commitment to excellence
						</p>
					</div>

					<div className='grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-8'>
						{values.map((value, index) => (
							<div
								key={index}
								className='bg-white p-6 rounded-xl shadow-sm'>
								<div className='text-accent mb-4'>{value.icon}</div>
								<h3 className='text-xl font-semibold text-primary mb-3'>{value.title}</h3>
								<p className='text-gray-600'>{value.description}</p>
							</div>
						))}
					</div>
				</div>
			</section>
		</div>
	);
}
</file>

<file path="src/app/admin/blogs/columns.tsx">
"use client"

import { ColumnDef } from "@tanstack/react-table"
import { BlogPost } from "@/lib/types"
import { Badge } from "@/components/ui/badge"
import { format } from "date-fns"
import { MoreHorizontal } from "lucide-react"
import { Button } from "@/components/ui/button"
import {
  DropdownMenu,
  DropdownMenuContent,
  DropdownMenuItem,
  DropdownMenuLabel,
  DropdownMenuSeparator,
  DropdownMenuTrigger,
} from "@/components/ui/dropdown-menu"

interface ColumnsOptions {
    onEdit: (blog: BlogPost) => void;
    onDelete: (blog: BlogPost) => void;
    onViewDetails: (blog: BlogPost) => void;
}

export const columns = ({ onEdit, onDelete, onViewDetails }: ColumnsOptions): ColumnDef<BlogPost>[] => [
  {
    accessorKey: "title",
    header: "Title",
    cell: ({ row }) => <div className="max-w-[300px] truncate font-medium">{row.getValue("title")}</div>,
  },
  {
    accessorKey: "author_name",
    header: "Author",
  },
  {
    accessorKey: "category",
    header: "Category",
  },
  {
    accessorKey: "published",
    header: "Status",
    cell: ({ row }) => {
        const published = row.getValue("published") as boolean;
        return <Badge variant={published ? "default" : "secondary"}>{published ? "Published" : "Draft"}</Badge>
    }
  },
  {
    accessorKey: "createdAt",
    header: "Created At",
    cell: ({ row }) => {
        const date = row.getValue("createdAt") as string;
        if (!date) return "N/A";
        const formattedDate = format(new Date(date), "PP");
        return <div className="font-medium">{formattedDate}</div>
    }
  },
  {
    id: "actions",
    cell: ({ row }) => {
      const blog = row.original
 
      return (
        <DropdownMenu>
          <DropdownMenuTrigger asChild>
            <Button variant="ghost" className="h-8 w-8 p-0">
              <span className="sr-only">Open menu</span>
              <MoreHorizontal className="h-4 w-4" />
            </Button>
          </DropdownMenuTrigger>
          <DropdownMenuContent align="end">
            <DropdownMenuLabel>Actions</DropdownMenuLabel>
            <DropdownMenuItem onClick={() => onViewDetails(blog)}>
              View details
            </DropdownMenuItem>
            <DropdownMenuItem onClick={() => onEdit(blog)}>
              Edit
            </DropdownMenuItem>
            <DropdownMenuSeparator />
             <DropdownMenuItem 
                className="text-destructive focus:bg-destructive/10 focus:text-destructive"
                onClick={() => onDelete(blog)}
             >
                Delete
            </DropdownMenuItem>
          </DropdownMenuContent>
        </DropdownMenu>
      )
    },
  },
]
</file>

<file path="src/app/admin/contacts/[id]/edit/page.tsx">
import { supabase } from '@/lib/supabase/supabase';
import ContactForm from '../../ContactForm';
import { notFound } from 'next/navigation';
import { Card, CardContent, CardHeader, CardTitle, CardDescription } from '@/components/ui/card';
import type { Contact } from '@/lib/types';
import Link from 'next/link';
import { Button } from '@/components/ui/button';
import { ArrowLeft } from 'lucide-react';

export const metadata = {
    title: 'Edit Contact | Bilacert Admin Pro',
    description: 'Edit an existing contact.',
};

async function getContact(id: string): Promise<Contact | null> {
    const { data, error } = await supabase
        .from('contacts')
        .select('*')
        .eq('id', id)
        .single();

    if (error || !data) {
        return null;
    }

    return {
        id: data.id,
        name: data.name,
        email: data.email,
        phone: data.phone,
        company: data.company,
        message: data.message,
        submitted_at: data.submitted_at,
    } as Contact;
}


export default async function EditContactPage({ params }: { params: Promise<{ id: string }> }) {
    const { id } = await params;
    const contact = await getContact(id);

    if (!contact) {
        notFound();
    }

    return (
        <div className="space-y-6">
            <Button variant="outline" asChild>
                <Link href="/admin/contacts">
                    <ArrowLeft className="mr-2 h-4 w-4" />
                    Back to Contacts
                </Link>
            </Button>
            <Card>
                <CardHeader>
                    <CardTitle>Edit Contact</CardTitle>
                    <CardDescription>Update the details for "{contact.name}".</CardDescription>
                </CardHeader>
                <CardContent>
                    <ContactForm contact={contact} />
                </CardContent>
            </Card>
        </div>
    );
}
</file>

<file path="src/app/admin/contacts/[id]/page.tsx">
import { supabase } from '@/lib/supabase/supabase';
import ContactDetails from '../ContactDetails';
import { notFound } from 'next/navigation';
import type { Contact } from '@/lib/types';
import type { Metadata } from 'next';

async function getContact(id: string): Promise<Contact | null> {
    const { data, error } = await supabase
        .from('contacts')
        .select('*')
        .eq('id', id)
        .single();

    if (error || !data) {
        return null;
    }

    return {
        id: data.id,
        name: data.name,
        email: data.email,
        phone: data.phone,
        company: data.company,
        message: data.message,
        submitted_at: data.submitted_at,
    } as Contact;
}

export async function generateMetadata({ params }: { params: { id: string } }): Promise<Metadata> {
    const contact = await getContact(params.id);
    if (!contact) {
        return {
            title: 'Contact Not Found'
        }
    }
    return {
        title: `${contact.name} | Bilacert Admin Pro`,
    }
}

export default async function ContactDetailsPage({ params }: { params: { id: string } }) {
    const { id } = params;
    const contact = await getContact(id);

    if (!contact) {
        notFound();
    }

    return <ContactDetails contact={contact} />;
}
</file>

<file path="src/app/admin/contacts/columns.tsx">
"use client"

import { ColumnDef } from "@tanstack/react-table"
import { Contact } from "@/lib/types"
import { MoreHorizontal, ArrowUpDown } from "lucide-react"
import { Button } from "@/components/ui/button"
import {
  DropdownMenu,
  DropdownMenuContent,
  DropdownMenuItem,
  DropdownMenuLabel,
  DropdownMenuSeparator,
  DropdownMenuTrigger,
} from "@/components/ui/dropdown-menu"
import { Checkbox } from "@/components/ui/checkbox"
import Link from "next/link"

interface ColumnsOptions {
    onEdit: (contact: Contact) => void;
    onDelete: (contact: Contact) => void;
}

export const columns = ({ onEdit, onDelete }: ColumnsOptions): ColumnDef<Contact>[] => [
    {
        id: "select",
        header: ({ table }) => (
          <Checkbox
            checked={table.getIsAllPageRowsSelected()}
            onCheckedChange={(value) => table.toggleAllPageRowsSelected(!!value)}
            aria-label="Select all"
          />
        ),
        cell: ({ row }) => (
          <Checkbox
            checked={row.getIsSelected()}
            onCheckedChange={(value) => row.toggleSelected(!!value)}
            aria-label="Select row"
          />
        ),
        enableSorting: false,
        enableHiding: false,
    },
    {
        accessorKey: "name",
        header: ({ column }) => {
            return (
              <Button
                variant="ghost"
                onClick={() => column.toggleSorting(column.getIsSorted() === "asc")}
              >
                Name
                <ArrowUpDown className="ml-2 h-4 w-4" />
              </Button>
            )
        },
    },
    {
        accessorKey: "email",
        header: "Email",
    },
    {
        accessorKey: "phone",
        header: "Phone",
        cell: ({ row }) => row.getValue("phone") || "N/A",
    },
    {
        accessorKey: "service",
        header: "Service",
        cell: ({ row }) => row.getValue("service") || "N/A",
    },
    {
        id: "actions",
        cell: ({ row }) => {
          const contact = row.original
     
          return (
            <DropdownMenu>
              <DropdownMenuTrigger asChild>
                <Button variant="ghost" className="h-8 w-8 p-0">
                  <span className="sr-only">Open menu</span>
                  <MoreHorizontal className="h-4 w-4" />
                </Button>
              </DropdownMenuTrigger>
              <DropdownMenuContent align="end">
                <DropdownMenuLabel>Actions</DropdownMenuLabel>
                <DropdownMenuItem asChild>
                    <Link href={`/admin/contacts/${contact.id}`}>View Details</Link>
                </DropdownMenuItem>
                <DropdownMenuItem onClick={() => onEdit(contact)}>
                  Edit
                </DropdownMenuItem>
                <DropdownMenuSeparator />
                 <DropdownMenuItem 
                    className="text-destructive focus:bg-destructive/10 focus:text-destructive"
                    onClick={() => onDelete(contact)}
                 >
                    Delete
                </DropdownMenuItem>
              </DropdownMenuContent>
            </DropdownMenu>
          )
        },
    },
]
</file>

<file path="src/app/admin/contacts/data-table.tsx">
"use client"

import {
  ColumnDef,
  flexRender,
  getCoreRowModel,
  useReactTable,
  getPaginationRowModel,
  getSortedRowModel,
  SortingState,
  RowSelectionState,
  Row,
  getFilteredRowModel,
  ColumnFiltersState,
} from "@tanstack/react-table"

import {
  Table,
  TableBody,
  TableCell,
  TableHead,
  TableHeader,
  TableRow,
} from "@/components/ui/table"
import { Button } from "@/components/ui/button"
import { useState } from "react"
import { Skeleton } from "@/components/ui/skeleton"
import { useRouter } from "next/navigation"
import type { Contact } from "@/lib/types"
import { Input } from '@/components/ui/input'

interface DataTableProps<TData, TValue> {
  columns: ColumnDef<TData, TValue>[]
  data: TData[]
  isLoading?: boolean
}

export function DataTable<TData, TValue>({
  columns,
  data,
  isLoading = false
}: DataTableProps<TData, TValue>) {
    const [sorting, setSorting] = useState<SortingState>([])
    const [rowSelection, setRowSelection] = useState({})
    const [columnFilters, setColumnFilters] = useState<ColumnFiltersState>([])
    const router = useRouter();

  const table = useReactTable({
    data,
    columns,
    getCoreRowModel: getCoreRowModel(),
    getPaginationRowModel: getPaginationRowModel(),
    onSortingChange: setSorting,
    getSortedRowModel: getSortedRowModel(),
    onRowSelectionChange: setRowSelection,
    onColumnFiltersChange: setColumnFilters,
    getFilteredRowModel: getFilteredRowModel(),
    state: {
        sorting,
        rowSelection,
        columnFilters,
    }
  })

  const handleRowClick = (row: Row<TData>) => {
    const contact = row.original as Contact;
    if (contact?.id) {
        router.push(`/admin/contacts/${contact.id}`);
    }
  }

  return (
    <div>
        <div className="flex items-center py-4">
            <Input
                placeholder="Filter by name or email..."
                value={(table.getColumn("name")?.getFilterValue() as string) ?? ""}
                onChange={(event) => {
                    table.getColumn("name")?.setFilterValue(event.target.value)
                    table.getColumn("email")?.setFilterValue(event.target.value)
                }}
                className="max-w-sm"
            />
        </div>
        <div className="rounded-md border">
        <Table>
            <TableHeader>
            {table.getHeaderGroups().map((headerGroup) => (
                <TableRow key={headerGroup.id}>
                {headerGroup.headers.map((header) => {
                    return (
                    <TableHead key={header.id}>
                        {header.isPlaceholder
                        ? null
                        : flexRender(
                            header.column.columnDef.header,
                            header.getContext()
                            )}
                    </TableHead>
                    )
                })}
                </TableRow>
            ))}
            </TableHeader>
            <TableBody>
            {isLoading ? (
                Array.from({ length: 10 }).map((_, i) => (
                    <TableRow key={i}>
                        {columns.map((col, j) => (
                            <TableCell key={j}>
                                <Skeleton className="h-6 w-full" />
                            </TableCell>
                        ))}
                    </TableRow>
                ))
            ) : table.getRowModel().rows?.length ? (
                table.getRowModel().rows.map((row) => (
                <TableRow
                    key={row.id}
                    data-state={row.getIsSelected() && "selected"}
                    className="cursor-pointer"
                    onClick={() => handleRowClick(row)}
                >
                    {row.getVisibleCells().map((cell) => (
                    <TableCell 
                        key={cell.id} 
                        onClick={(e) => {
                            if (cell.column.id === 'actions' || cell.column.id === 'select') {
                                e.stopPropagation();
                            }
                        }}
                    >
                        {flexRender(cell.column.columnDef.cell, cell.getContext())}
                    </TableCell>
                    ))}
                </TableRow>
                ))
            ) : (
                <TableRow>
                <TableCell colSpan={columns.length} className="h-24 text-center">
                    No results.
                </TableCell>
                </TableRow>
            )}
            </TableBody>
        </Table>
        </div>
        <div className="flex items-center justify-end space-x-2 py-4">
            <div className="flex-1 text-sm text-muted-foreground">
                {table.getFilteredSelectedRowModel().rows.length} of{" "}
                {table.getFilteredRowModel().rows.length} row(s) selected.
            </div>
            <Button
                variant="outline"
                size="sm"
                onClick={() => table.previousPage()}
                disabled={!table.getCanPreviousPage()}
            >
                Previous
            </Button>
            <Button
                variant="outline"
                size="sm"
                onClick={() => table.nextPage()}
                disabled={!table.getCanNextPage()}
            >
                Next
            </Button>
        </div>
    </div>
  )
}
</file>

<file path="src/app/admin/testimonials/[id]/edit/page.tsx">
import { supabase } from '@/lib/supabase/supabase';
import TestimonialForm from '../../TestimonialForm';
import { notFound } from 'next/navigation';
import { Card, CardContent, CardHeader, CardTitle, CardDescription } from '@/components/ui/card';
import type { Testimonial } from '@/lib/types';
import Link from 'next/link';
import { Button } from '@/components/ui/button';
import { ArrowLeft } from 'lucide-react';

export const metadata = {
    title: 'Edit Testimonial | Bilacert Admin Pro',
    description: 'Edit an existing testimonial.',
};

async function getTestimonial(id: string): Promise<Testimonial | null> {
    const { data, error } = await supabase
        .from('testimonials')
        .select('*')
        .eq('id', id)
        .single();

    if (error || !data) {
        return null;
    }

    return {
        id: data.id,
        postUrl: data.post_url,
        createdAt: data.created_at,
    } as Testimonial;
}


export default async function EditTestimonialPage({ params }: { params: Promise<{ id: string }> }) {
    const { id } = await params;
    const testimonial = await getTestimonial(id);

    if (!testimonial) {
        notFound();
    }

    return (
        <div className="space-y-6">
            <Button variant="outline" asChild>
                <Link href="/admin/testimonials">
                    <ArrowLeft className="mr-2 h-4 w-4" />
                    Back to Testimonials
                </Link>
            </Button>
            <Card>
                <CardHeader>
                    <CardTitle>Edit Testimonial</CardTitle>
                    <CardDescription>Update the Facebook post URL.</CardDescription>
                </CardHeader>
                <CardContent>
                    <TestimonialForm testimonial={testimonial} />
                </CardContent>
            </Card>
        </div>
    );
}
</file>

<file path="src/app/admin/testimonials/[id]/page.tsx">
import { supabase } from '@/lib/supabase/supabase';
import { notFound } from 'next/navigation';
import type { Testimonial } from '@/lib/types';
import TestimonialDetails from '../TestimonialDetails';
import type { Metadata } from 'next';

async function getTestimonial(id: string): Promise<Testimonial | null> {
    const { data, error } = await supabase
        .from('testimonials')
        .select('*')
        .eq('id', id)
        .single();

    if (error || !data) {
        return null;
    }

    return {
        id: data.id,
        postUrl: data.post_url,
        createdAt: data.created_at,
    } as Testimonial;
}

export async function generateMetadata({ params }: { params: { id: string } }): Promise<Metadata> {
    const testimonial = await getTestimonial(params.id);
    if (!testimonial) {
        return {
            title: 'Testimonial Not Found'
        }
    }
    return {
        title: `Testimonial from ${new Date(testimonial.createdAt).toLocaleDateString()} | Bilacert Admin Pro`,
    }
}

export default async function TestimonialDetailsPage({ params }: { params: Promise<{ id: string }> }) {
    const { id } = await params;
    const testimonial = await getTestimonial(id);

    if (!testimonial) {
        notFound();
    }

    return <TestimonialDetails testimonial={testimonial} />;
}
</file>

<file path="src/components/Icon.tsx">
'use client';

import {
  Shield,
  CheckSquare,
  FileText,
  Radio,
  Sailboat,
  Package,
  LayoutDashboard,
  Briefcase,
  MessageSquare,
  Users,
  FileSpreadsheet,
  type LucideProps,
  type LucideIcon,
  HelpCircle,
  Settings,
  User,
  CreditCard,
  DollarSign,
  BarChart,
  Clock,
  Book,
  Check,
  Award,
  Headphones,
  Ship,
} from 'lucide-react';

export const iconMap: { [key: string]: LucideIcon } = {
  Shield,
  CheckSquare,
  FileText,
  Radio,
  Sailboat,
  Ship,
  Package,
  LayoutDashboard,
  Briefcase,
  MessageSquare,
  Users,
  FileSpreadsheet,
  Settings,
  User,
  CreditCard,
  DollarSign,
  BarChart,
  Clock,
  Book,
  Check,
  Award,
  Headphones,
};

interface IconProps extends LucideProps {
  name: string;
}

export const Icon = ({ name, ...props }: IconProps) => {
  if (!name) {
    return <HelpCircle {...props} />;
  }
  const LucideIcon = iconMap[name.charAt(0).toUpperCase() + name.slice(1)];

  if (!LucideIcon) {
    return <HelpCircle {...props} />; // A default fallback icon for unknown names
  }

  return <LucideIcon {...props} />;
};

export default Icon;
</file>

<file path="src/app/admin/blogs/BlogDetails.tsx">
'use client';

import { Badge } from '@/components/ui/badge';
import type { BlogPost } from '@/lib/types';
import { format } from 'date-fns';
import { Card, CardContent, CardHeader, CardTitle, CardDescription } from '@/components/ui/card';
import { Button } from '@/components/ui/button';
import Link from 'next/link';
import { ArrowLeft, Edit, Trash2 } from 'lucide-react';
import { useState } from 'react';
import DeleteBlogDialog from './DeleteBlogDialog';
import { useRouter } from 'next/navigation';
import Image from 'next/image';

interface BlogDetailsProps {
  blog: BlogPost;
}

export default function BlogDetails({ blog }: BlogDetailsProps) {
  const router = useRouter();
  const [isDeleteDialogOpen, setIsDeleteDialogOpen] = useState(false);

  if (!blog) return null;

  const handleDelete = () => {
    setIsDeleteDialogOpen(true);
  };
  
  const handleCloseDialog = () => {
    setIsDeleteDialogOpen(false);
  };

  const onDeleted = () => {
    setIsDeleteDialogOpen(false);
    router.push('/admin/blogs');
    router.refresh();
  }

  return (
    <>
      <div className="space-y-6">
        <div className="flex items-center justify-between">
            <Button variant="outline" asChild>
                <Link href="/admin/blogs">
                    <ArrowLeft className="mr-2 h-4 w-4" />
                    Back to Blogs
                </Link>
            </Button>
            <div className="flex gap-2">
                <Button asChild>
                    <Link href={`/admin/blogs/${blog.id}/edit`}>
                        <Edit className="mr-2 h-4 w-4" /> Edit
                    </Link>
                </Button>
                <Button variant="destructive" onClick={handleDelete}>
                    <Trash2 className="mr-2 h-4 w-4" /> Delete
                </Button>
            </div>
        </div>
        
        {(blog.featured_image || blog.thumbnail) && (
             <div className="grid grid-cols-1 md:grid-cols-2 gap-6">
                 {blog.featured_image && (
                     <Card>
                         <CardHeader>
                             <CardTitle className="text-lg">Featured Image</CardTitle>
                         </CardHeader>
                         <CardContent>
                            <div className="relative aspect-video w-full overflow-hidden rounded-lg">
                                <Image src={blog.featured_image} alt="Featured Image" fill className="object-cover" />
                            </div>
                         </CardContent>
                     </Card>
                 )}
                  {blog.thumbnail && (
                     <Card>
                         <CardHeader>
                             <CardTitle className="text-lg">Thumbnail</CardTitle>
                         </CardHeader>
                         <CardContent>
                            <div className="relative aspect-square w-48 overflow-hidden rounded-lg">
                                <Image src={blog.thumbnail} alt="Thumbnail" fill className="object-cover" />
                            </div>
                         </CardContent>
                     </Card>
                 )}
             </div>
        )}

        <Card>
            <CardHeader>
                <div className="flex justify-between items-start">
                    <div>
                        <CardTitle>{blog.title}</CardTitle>
                        {blog.category && <CardDescription>{blog.category}</CardDescription>}
                    </div>
                    <div className="flex gap-2">
                        {blog.featured && <Badge>Featured</Badge>}
                        <Badge variant={blog.published ? 'default' : 'secondary'}>
                            {blog.published ? 'Published' : 'Draft'}
                        </Badge>
                    </div>
                </div>
            </CardHeader>
            <CardContent>
                <div className="grid grid-cols-1 md:grid-cols-3 gap-6">
                    <div className="space-y-4">
                        <h4 className="text-sm font-medium text-muted-foreground">Details</h4>
                        <div className="text-sm"><strong>Slug:</strong> <span className="font-mono">{blog.slug}</span></div>
                        {blog.author_name && <div className="text-sm"><strong>Author:</strong> {blog.author_name}</div>}
                        {blog.read_time && <div className="text-sm"><strong>Read Time:</strong> {blog.read_time}</div>}
                        {blog.tags && <div className="text-sm"><strong>Tags:</strong> {blog.tags}</div>}
                        <div className="text-sm"><strong>Created:</strong> {format(new Date(blog.createdAt), 'PPpp')}</div>
                        {blog.updatedAt && <div className="text-sm"><strong>Updated:</strong> {format(new Date(blog.updatedAt), 'PPpp')}</div>}
                    </div>
                     <div className="space-y-4 md:col-span-2">
                        <h4 className="text-sm font-medium text-muted-foreground">SEO</h4>
                        {blog.seo_title && <div className="text-sm"><strong>Title:</strong> {blog.seo_title}</div>}
                        {blog.seo_description && <div className="text-sm"><strong>Description:</strong> {blog.seo_description}</div>}
                        {blog.seo_keywords && <div className="text-sm"><strong>Keywords:</strong> {blog.seo_keywords}</div>}
                     </div>
                </div>
                {blog.excerpt && (
                    <div className="mt-6 border-t pt-6">
                        <h3 className="text-lg font-medium mb-2">Excerpt</h3>
                        <p className="text-sm text-card-foreground italic">"{blog.excerpt}"</p>
                    </div>
                )}
                {blog.content && (
                    <div className="mt-6 border-t pt-6">
                        <h3 className="text-lg font-medium mb-2">Content</h3>
                        <div className="prose prose-sm dark:prose-invert mt-1 text-card-foreground whitespace-pre-wrap">
                            {blog.content}
                        </div>
                    </div>
                )}
            </CardContent>
        </Card>
      </div>
      
      {isDeleteDialogOpen && (
        <DeleteBlogDialog
            isOpen={isDeleteDialogOpen}
            onClose={handleCloseDialog}
            blog={blog}
            onDeleted={onDeleted}
        />
      )}
    </>
  );
}
</file>

<file path="src/app/admin/blogs/BlogsClient.tsx">
'use client';

import { useState } from 'react';
import { useBlogs } from '@/hooks/useBlogs';
import { BlogPost } from '@/lib/types';
import { Button } from '@/components/ui/button';
import { MoreHorizontal, Calendar } from 'lucide-react';
import DeleteBlogDialog from './DeleteBlogDialog';
import { Badge } from '@/components/ui/badge';
import { format } from 'date-fns';
import {
  DropdownMenu,
  DropdownMenuContent,
  DropdownMenuItem,
  DropdownMenuLabel,
  DropdownMenuSeparator,
  DropdownMenuTrigger,
} from '@/components/ui/dropdown-menu';
import Link from 'next/link';
import Image from 'next/image';
import { useRouter } from 'next/navigation';

export default function BlogsClient() {
  const { blogs, loading, error } = useBlogs();
  const router = useRouter();
  const [isDeleteDialogOpen, setIsDeleteDialogOpen] = useState(false);
  const [selectedBlog, setSelectedBlog] = useState<BlogPost | null>(null);

  const handleDelete = (blog: BlogPost) => {
    setSelectedBlog(blog);
    setIsDeleteDialogOpen(true);
  };
  
  const handleEdit = (blog: BlogPost) => {
    router.push(`/admin/blogs/${blog.id}/edit`);
  }

  const handleCloseDialogs = () => {
    setIsDeleteDialogOpen(false);
    setSelectedBlog(null);
  };
  
  const onDeleted = () => {
    handleCloseDialogs();
    router.refresh();
  }

  if (error) {
    return <div className="text-destructive">Error loading posts: {error.message}</div>;
  }

  return (
    <>
      <div>
        {blogs.length === 0 && !loading ? (
           <div className="flex flex-col items-center justify-center rounded-lg border-2 border-dashed border-muted-foreground/30 py-24 text-center">
              <h3 className="text-lg font-semibold tracking-tight">No Blog Posts Yet</h3>
              <p className="text-sm text-muted-foreground">Click "Add Post" to get started.</p>
          </div>
        ) : (
          <div className="grid grid-cols-1 gap-8 md:grid-cols-2 lg:grid-cols-3">
            {blogs.map((blog) => (
              <div key={blog.id} className="group relative flex flex-col overflow-hidden rounded-xl bg-white shadow-sm transition-all duration-300 hover:-translate-y-2 hover:shadow-lg">
                <Link href={`/admin/blogs/${blog.id}`} className="absolute inset-0 z-10" aria-label={`View ${blog.title}`}>
                  <span className="sr-only">View Details</span>
                </Link>
                <div className="absolute top-4 right-4 z-20">
                    <DropdownMenu>
                      <DropdownMenuTrigger asChild>
                        <Button variant="ghost" size="icon" className="h-8 w-8 rounded-full bg-background/60 backdrop-blur-sm hover:bg-background" onClick={(e) => e.preventDefault()}>
                          <span className="sr-only">Open menu</span>
                          <MoreHorizontal className="h-4 w-4" />
                        </Button>
                      </DropdownMenuTrigger>
                      <DropdownMenuContent align="end">
                        <DropdownMenuLabel>Actions</DropdownMenuLabel>
                         <DropdownMenuItem onClick={(e) => { e.preventDefault(); router.push(`/admin/blogs/${blog.id}`)}}>View</DropdownMenuItem>
                        <DropdownMenuItem onClick={(e) => { e.preventDefault(); handleEdit(blog)}}>Edit</DropdownMenuItem>
                        <DropdownMenuSeparator />
                        <DropdownMenuItem
                          className="text-destructive focus:bg-destructive/10 focus:text-destructive"
                          onClick={(e) => {
                              e.preventDefault();
                              handleDelete(blog);
                          }}
                        >
                          Delete
                        </DropdownMenuItem>
                      </DropdownMenuContent>
                    </DropdownMenu>
                </div>

                <div className="relative h-48 w-full">
                    <Image
                        src={blog.featured_image || `https://picsum.photos/seed/${blog.id}/600/400`}
                        alt={blog.title}
                        fill
                        className="object-cover transition-transform duration-300 group-hover:scale-105"
                    />
                    <div className="absolute inset-0 bg-gradient-to-t from-black/50 to-transparent"></div>
                     <div className="absolute bottom-4 left-4">
                        {blog.category && <Badge variant="secondary">{blog.category}</Badge>}
                    </div>
                </div>

                <div className="flex flex-col flex-grow p-6">
                    <h3 className="mb-2 text-xl font-semibold text-primary line-clamp-2">{blog.title}</h3>
                    <p className="mb-4 text-sm text-muted-foreground line-clamp-3 flex-grow">{blog.excerpt}</p>
                    <div className="mt-auto flex items-center justify-between text-xs text-muted-foreground">
                        <Badge variant={blog.published ? "default" : "outline"}>
                            {blog.published ? "Published" : "Draft"}
                        </Badge>
                        <div className="flex items-center gap-2">
                            <Calendar className="h-4 w-4" />
                            <span>{format(new Date(blog.createdAt), 'PP')}</span>
                        </div>
                    </div>
                </div>
              </div>
            ))}
          </div>
        )}
      </div>
      
      {isDeleteDialogOpen && (
        <DeleteBlogDialog
            isOpen={isDeleteDialogOpen}
            onClose={handleCloseDialogs}
            blog={selectedBlog}
            onDeleted={onDeleted}
        />
      )}
    </>
  );
}
</file>

<file path="src/app/admin/blogs/DeleteBlogDialog.tsx">
'use client';

import {
  AlertDialog,
  AlertDialogCancel,
  AlertDialogContent,
  AlertDialogDescription,
  AlertDialogFooter,
  AlertDialogHeader,
  AlertDialogTitle,
} from '@/components/ui/alert-dialog';
import { Button } from '@/components/ui/button';
import { useToast } from '@/hooks/use-toast';
import type { BlogPost } from '@/lib/types';
import { Loader2 } from 'lucide-react';
import { useState } from 'react';

interface DeleteBlogDialogProps {
  isOpen: boolean;
  onClose: () => void;
  blog: BlogPost | null;
  onDeleted?: () => void;
}

export default function DeleteBlogDialog({
  isOpen,
  onClose,
  blog,
  onDeleted,
}: DeleteBlogDialogProps) {
  const { toast } = useToast();
  const [isDeleting, setIsDeleting] = useState(false);

  const handleDelete = async () => {
    if (!blog) return;

    setIsDeleting(true);
    try {
      const response = await fetch(`/api/blogs/${blog.id}`, {
        method: 'DELETE',
      });

      if (!response.ok) {
        let errorMessage = `API Error: ${response.status} ${response.statusText}`;
        try {
            const errorData = await response.json();
            if (errorData.error) {
                errorMessage = errorData.error;
            }
        } catch (jsonError) {
            console.error("Could not parse JSON from error response.");
        }
        throw new Error(errorMessage);
      }

      toast({
        title: 'Blog post deleted',
        description: `The post "${blog.title}" has been successfully deleted.`,
      });
      if (onDeleted) {
        onDeleted();
      } else {
        onClose();
      }
    } catch (error: any) {
      toast({
        variant: 'destructive',
        title: 'Error deleting post',
        description: error.message,
      });
    } finally {
      setIsDeleting(false);
    }
  };

  return (
    <AlertDialog open={isOpen} onOpenChange={onClose}>
      <AlertDialogContent>
        <AlertDialogHeader>
          <AlertDialogTitle>Are you absolutely sure?</AlertDialogTitle>
          <AlertDialogDescription>
            This action cannot be undone. This will permanently delete the
            blog post "{blog?.title}".
          </AlertDialogDescription>
        </AlertDialogHeader>
        <AlertDialogFooter>
          <AlertDialogCancel disabled={isDeleting} onClick={onClose}>Cancel</AlertDialogCancel>
          <Button
            variant="destructive"
            onClick={handleDelete}
            disabled={isDeleting}
          >
            {isDeleting && <Loader2 className="mr-2 h-4 w-4 animate-spin" />}
            Delete
          </Button>
        </AlertDialogFooter>
      </AlertDialogContent>
    </AlertDialog>
  );
}
</file>

<file path="src/app/admin/contacts/ContactDetails.tsx">
'use client';

import type { Contact } from '@/lib/types';
import { Card, CardContent, CardHeader, CardTitle, CardDescription } from '@/components/ui/card';
import { Button } from '@/components/ui/button';
import Link from 'next/link';
import { ArrowLeft, Edit, Trash2, Phone } from 'lucide-react';
import { useState } from 'react';
import DeleteContactDialog from './DeleteContactDialog';
import { useRouter } from 'next/navigation';

interface ContactDetailsProps {
  contact: Contact;
}

export default function ContactDetails({ contact }: ContactDetailsProps) {
  const router = useRouter();
  const [isDeleteDialogOpen, setIsDeleteDialogOpen] = useState(false);

  if (!contact) return null;

  const handleDelete = () => {
    setIsDeleteDialogOpen(true);
  };
  
  const handleCloseDialog = () => {
    setIsDeleteDialogOpen(false);
  };

  const onDeleted = () => {
    setIsDeleteDialogOpen(false);
    router.push('/admin/contacts');
    router.refresh();
  }

  const formatPhoneNumberForWhatsApp = (phone: string) => {
    // Remove all non-digit characters
    return phone.replace(/\D/g, '');
  }

  return (
    <>
      <div className="space-y-6">
        <div className="flex items-center justify-between">
            <Button variant="outline" asChild>
                <Link href="/admin/contacts">
                    <ArrowLeft className="mr-2 h-4 w-4" />
                    Back to Contacts
                </Link>
            </Button>
            <div className="flex gap-2">
                <Button asChild>
                    <Link href={`/admin/contacts/${contact.id}/edit`}>
                        <Edit className="mr-2 h-4 w-4" /> Edit
                    </Link>
                </Button>
                <Button variant="destructive" onClick={handleDelete}>
                    <Trash2 className="mr-2 h-4 w-4" /> Delete
                </Button>
            </div>
        </div>

        <Card>
            <CardHeader>
                <CardTitle>{contact.name}</CardTitle>
                <CardDescription>{contact.email}</CardDescription>
            </CardHeader>
            <CardContent>
                <div className="grid gap-6 md:grid-cols-2">
                    <div className="space-y-6">
                        {contact.phone && (
                            <div>
                                <h4 className="text-sm font-medium text-muted-foreground">Phone</h4>
                                <a 
                                    href={`https://wa.me/${formatPhoneNumberForWhatsApp(contact.phone)}`}
                                    target="_blank"
                                    rel="noopener noreferrer"
                                    className="flex items-center gap-2 text-sm text-primary transition-colors hover:underline"
                                >
                                    <Phone className="h-4 w-4" />
                                    {contact.phone}
                                </a>
                            </div>
                        )}
                         {contact.service && (
                            <div>
                                <h4 className="text-sm font-medium text-muted-foreground">Service of Interest</h4>
                                <p className="text-sm text-card-foreground">{contact.service}</p>
                            </div>
                        )}
                    </div>
                </div>

                {contact.message && (
                    <div className="mt-6 border-t pt-6">
                        <h3 className="text-lg font-medium mb-4">Message / Notes</h3>
                        <div className="prose prose-sm dark:prose-invert mt-1 text-card-foreground text-sm whitespace-pre-wrap">
                            {contact.message}
                        </div>
                    </div>
                )}
            </CardContent>
        </Card>
      </div>
      
      {isDeleteDialogOpen && (
        <DeleteContactDialog
            isOpen={isDeleteDialogOpen}
            onClose={handleCloseDialog}
            contact={contact}
            onDeleted={onDeleted}
        />
      )}
    </>
  );
}
</file>

<file path="src/app/admin/services/[id]/edit/page.tsx">
import { createSupabaseAdminClient } from '@/lib/supabase/admin';
import ServiceForm from '../../ServiceForm';
import { notFound } from 'next/navigation';
import { Card, CardContent, CardHeader, CardTitle, CardDescription } from '@/components/ui/card';
import type { Service } from '@/lib/types';
import Link from 'next/link';
import { Button } from '@/components/ui/button';
import { ArrowLeft } from 'lucide-react';

export const metadata = {
    title: 'Edit Service | Bilacert Admin Pro',
    description: 'Edit an existing regulatory service.',
};




async function getService(id: string): Promise<Service | null> {
    const supabase = createSupabaseAdminClient();
    const { data, error } = await supabase
        .from('services')
        .select('*')
        .eq('id', id)
        .single();

    if (error) {
        console.error('Error fetching service:', error);
        return null;
    }

    return data as Service;
}

export default async function EditServicePage({ params }:  { params: Promise<{ id: string }> } ) {
    const slug = (await params).id;
    const service = await getService(slug);

    if (!service) {
        notFound();
    }

    return (
        <div className="space-y-6">
            <Button variant="outline" asChild>
                <Link href="/admin/services">
                    <ArrowLeft className="mr-2 h-4 w-4" />
                    Back to Services
                </Link>
            </Button>
            <Card>
                <CardHeader>
                    <CardTitle>Edit Service</CardTitle>
                    <CardDescription>Update the details for "{service.title}".</CardDescription>
                </CardHeader>
                <CardContent>
                    <ServiceForm service={service} />
                </CardContent>
            </Card>
        </div>
    );
}
</file>

<file path="src/app/admin/services/[id]/page.tsx">
import { supabase } from '@/lib/supabase/supabase';
import ServiceDetails from './ServiceDetails';
import { notFound } from 'next/navigation';
import type { Service } from '@/lib/types';
import type { Metadata } from 'next';

async function getService(id: string): Promise<Service | null> {
    const { data, error } = await supabase
        .from('services')
        .select('*')
        .eq('id', id)
        .single();

    if (error || !data) {
        return null;
    }

    return {
        id: data.id,
        title: data.title,
        slug: data.slug,
        href: data.href,
        category: data.category,
        description: data.description,
        short_description: data.short_description,
        icon: data.icon,
        order_index: data.order_index,
        content: data.content,
        features: data.features,
        requirements: data.requirements,
        includes: data.includes,
        published: data.published,
        featured: data.featured,
        created_at: data.created_at,
        processing_time: data.processing_time,
        pricing: data.pricing,
        image: data.image,
        thumbnail: data.thumbnail,
        seo_title: data.seo_title,
        seo_description: data.seo_description,
        seo_keywords: data.seo_keywords,
        pricing_plans: data.pricing_plans,
        process_steps: data.process_steps,
        success_story: data.success_story,
    } as Service;
}

export async function generateMetadata({ params }: { params: { id: string } }): Promise<Metadata> {
    const service = await getService(params.id);
    if (!service) {
        return {
            title: 'Service Not Found'
        }
    }
    return {
        title: `${service.title} | Bilacert Admin Pro`,
    }
}

export default async function ServiceDetailsPage({ params }: { params: Promise<{ id: string }> }) {
    const { id } = await params;
    const service = await getService(id);

    if (!service) {
        notFound();
    }

    return <ServiceDetails service={service} />;
}
</file>

<file path="src/app/admin/services/DeleteServiceDialog.tsx">
'use client';

import {
  AlertDialog,
  AlertDialogCancel,
  AlertDialogContent,
  AlertDialogDescription,
  AlertDialogFooter,
  AlertDialogHeader,
  AlertDialogTitle,
} from '@/components/ui/alert-dialog';
import { Button } from '@/components/ui/button';
import { useToast } from '@/hooks/use-toast';
import type { Service } from '@/lib/types';
import { Loader2 } from 'lucide-react';
import { useState } from 'react';

interface DeleteServiceDialogProps {
  isOpen: boolean;
  onClose: () => void;
  service: Service | null;
  onDeleted?: () => void;
}

export default function DeleteServiceDialog({
  isOpen,
  onClose,
  service,
  onDeleted,
}: DeleteServiceDialogProps) {
  const { toast } = useToast();
  const [isDeleting, setIsDeleting] = useState(false);

  const handleDelete = async () => {
    if (!service) return;

    setIsDeleting(true);
    try {
      const response = await fetch(`/api/services/${service.id}`, {
        method: 'DELETE',
      });

      if (!response.ok) {
        let errorMessage = `API Error: ${response.status} ${response.statusText}`;
        try {
            const errorData = await response.json();
            if (errorData.error) {
                errorMessage = errorData.error;
            }
        } catch (jsonError) {
            console.error("Could not parse JSON from error response.");
        }
        throw new Error(errorMessage);
      }

      toast({
        title: 'Service deleted',
        description: `The service "${service.title}" has been successfully deleted.`,
      });
      if (onDeleted) {
        onDeleted();
      } else {
        onClose();
      }
    } catch (error: any) {
      toast({
        variant: 'destructive',
        title: 'Error deleting service',
        description: error.message,
      });
    } finally {
      setIsDeleting(false);
    }
  };

  return (
    <AlertDialog open={isOpen} onOpenChange={onClose}>
      <AlertDialogContent>
        <AlertDialogHeader>
          <AlertDialogTitle>Are you absolutely sure?</AlertDialogTitle>
          <AlertDialogDescription>
            This action cannot be undone. This will permanently delete the
            service "{service?.title}".
          </AlertDialogDescription>
        </AlertDialogHeader>
        <AlertDialogFooter>
          <AlertDialogCancel disabled={isDeleting} onClick={onClose}>Cancel</AlertDialogCancel>
          <Button
            variant="destructive"
            onClick={handleDelete}
            disabled={isDeleting}
          >
            {isDeleting && <Loader2 className="mr-2 h-4 w-4 animate-spin" />}
            Delete
          </Button>
        </AlertDialogFooter>
      </AlertDialogContent>
    </AlertDialog>
  );
}
</file>

<file path="src/components/Testimonials.tsx">
'use client';

import { useEffect, useState } from 'react';
import type { Testimonial } from '@/lib/types';
import { supabase } from '@/lib/supabase/supabase';
import { Card, CardContent } from '@/components/ui/card';

declare global {
    interface Window {
        FB?: {
            init: (params: { xfbml: boolean; version: string; }) => void;
            XFBML: {
                parse: (element?: HTMLElement) => void;
            };
        };
        fbAsyncInit?: () => void;
    }
}

export default function Testimonials() {
    const [testimonials, setTestimonials] = useState<Testimonial[]>([]);

    useEffect(() => {
        const fetchTestimonials = async () => {
            const { data, error } = await supabase
                .from('testimonials')
                .select('*')
                .order('created_at', { ascending: false });

            if (!error && data) {
                setTestimonials(data.map(item => ({ id: item.id, postUrl: item.post_url, createdAt: item.created_at })));
            }
        };

        fetchTestimonials();
    }, []);

    useEffect(() => {
        if (testimonials.length > 0 && typeof window !== 'undefined' && window.FB) {
            window.FB.XFBML.parse();
        }
    }, [testimonials]);

    if (testimonials.length === 0) {
        return null;
    }

    return (
        <section className="py-20 bg-primary text-white">
            <div className="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
                <div className="text-center mb-16">
                    <h2 className="text-3xl lg:text-4xl font-bold mb-4">
                        Trusted by South African Businesses
                    </h2>
                    <p className="text-xl text-gray-200 max-w-3xl mx-auto">
                        See what our clients say about our services
                    </p>
                </div>

                <div className="grid grid-cols-1 md:grid-cols-2 gap-8 justify-items-center">
                    {testimonials.map((t) => (
                        <Card key={t.id} className="bg-white text-black w-full max-w-lg">
                            <CardContent className="p-4">
                                <div
                                    className="fb-post"
                                    data-href={t.postUrl}
                                    data-width="auto"
                                    data-show-text="true"
                                >
                                    <blockquote cite={t.postUrl} className="fb-xfbml-parse-ignore">
                                        <a href={t.postUrl}>Post</a>
                                    </blockquote>
                                </div>
                            </CardContent>
                        </Card>
                    ))}
                </div>
            </div>
        </section>
    );
}
</file>

<file path="src/components/WhatsAppButton.tsx">
'use client';

import { Button } from './ui/button';
import { FaWhatsapp } from 'react-icons/fa';

export default function WhatsAppButton() {
  const phoneNumber = '27754304433'; // South African format
  const message = 'Hi! I\'m interested in your compliance services. Can you help me?';

  const handleWhatsAppClick = () => {
    const url = `https://wa.me/${phoneNumber}?text=${encodeURIComponent(message)}`;
    window.open(url, '_blank');
  };

  return (
    <Button
      onClick={handleWhatsAppClick}
      className="fixed bottom-6 right-6 h-14 w-14 rounded-full bg-green-500 shadow-lg transition-all duration-300 hover:scale-110 hover:bg-green-600"
      size="icon"
      aria-label="Chat with us on WhatsApp"
    >
      <FaWhatsapp className="h-7 w-7" />
    </Button>
  );
}
</file>

<file path="src/app/admin/contacts/ContactsClient.tsx">
'use client';

import { useState } from 'react';
import { useContacts } from '@/hooks/useContacts';
import { Contact } from '@/lib/types';
import { Button } from '@/components/ui/button';
import { MoreHorizontal, Mail, Phone } from 'lucide-react';
import DeleteContactDialog from './DeleteContactDialog';
import Link from 'next/link';
import { useRouter } from 'next/navigation';
import { Card, CardHeader, CardTitle, CardContent, CardDescription } from '@/components/ui/card';
import {
  DropdownMenu,
  DropdownMenuContent,
  DropdownMenuItem,
  DropdownMenuLabel,
  DropdownMenuSeparator,
  DropdownMenuTrigger,
} from '@/components/ui/dropdown-menu';
import ContactsLoading from './loading';
import { format } from 'date-fns';

export default function ContactsClient() {
  const { contacts, loading, error, refresh } = useContacts();
  const router = useRouter();
  const [isDeleteDialogOpen, setIsDeleteDialogOpen] = useState(false);
  const [selectedContact, setSelectedContact] = useState<Contact | null>(null);

  const handleDelete = (contact: Contact) => {
    setSelectedContact(contact);
    setIsDeleteDialogOpen(true);
  };
  
  const handleEdit = (contact: Contact) => {
    router.push(`/admin/contacts/${contact.id}/edit`);
  };

  const handleViewDetails = (contact: Contact) => {
    router.push(`/admin/contacts/${contact.id}`);
  }

  const handleCloseDialogs = () => {
    setIsDeleteDialogOpen(false);
    setSelectedContact(null);
  };
  
  const onDeleted = () => {
      handleCloseDialogs();
      refresh();
  }

  if (error) {
    return <div className="text-destructive">Error loading contacts: {error.message}</div>;
  }

  return (
    <>
      <div>
        {loading ? <ContactsLoading /> : contacts.length === 0 ? (
          <div className="flex flex-col items-center justify-center rounded-lg border-2 border-dashed border-muted-foreground/30 py-24 text-center">
              <h3 className="text-lg font-semibold tracking-tight">No Contacts Yet</h3>
              <p className="text-sm text-muted-foreground">Click "Add Contact" to get started.</p>
          </div>
        ) : (
          <div className="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-6">
            {contacts.map((contact) => (
              <div key={contact.id} className="group relative">
                <Link href={`/admin/contacts/${contact.id}`} className="absolute inset-0 z-10" aria-label={`View ${contact.name}`}>
                    <span className="sr-only">View Details</span>
                </Link>
                <Card className="flex h-full flex-col transition-all duration-300 group-hover:shadow-lg group-hover:border-primary/50">
                    <CardHeader>
                        <div className="flex justify-between items-start">
                            <CardTitle className="text-lg line-clamp-1">{contact.name}</CardTitle>
                            <div className="relative z-20">
                                <DropdownMenu>
                                    <DropdownMenuTrigger asChild>
                                        <Button variant="ghost" className="h-8 w-8 p-0" onClick={(e) => e.preventDefault()}>
                                            <span className="sr-only">Open menu</span>
                                            <MoreHorizontal className="h-4 w-4" />
                                        </Button>
                                    </DropdownMenuTrigger>
                                    <DropdownMenuContent align="end">
                                        <DropdownMenuLabel>Actions</DropdownMenuLabel>
                                        <DropdownMenuItem onClick={(e) => { e.preventDefault(); handleViewDetails(contact); }}>View</DropdownMenuItem>
                                        <DropdownMenuItem onClick={(e) => { e.preventDefault(); handleEdit(contact); }}>Edit</DropdownMenuItem>
                                        <DropdownMenuSeparator />
                                        <DropdownMenuItem
                                            className="text-destructive focus:bg-destructive/10 focus:text-destructive"
                                            onClick={(e) => { e.preventDefault(); handleDelete(contact); }}
                                        >
                                            Delete
                                        </DropdownMenuItem>
                                    </DropdownMenuContent>
                                </DropdownMenu>
                            </div>
                        </div>
                      <CardDescription>{contact.service || `Submitted on ${format(new Date(contact.submitted_at), 'PP')}`}</CardDescription>
                    </CardHeader>
                    <CardContent className="space-y-3 flex-grow">
                      <div className="flex items-center gap-2 text-sm text-muted-foreground">
                        <Mail className="h-4 w-4" />
                        <a href={`mailto:${contact.email}`} onClick={(e) => e.stopPropagation()} className="truncate hover:underline">{contact.email}</a>
                      </div>
                      {contact.phone && (
                        <div className="flex items-center gap-2 text-sm text-muted-foreground">
                          <Phone className="h-4 w-4" />
                          <span>{contact.phone}</span>
                        </div>
                      )}
                    </CardContent>
                </Card>
              </div>
            ))}
          </div>
        )}
      </div>
      
      {isDeleteDialogOpen && (
        <DeleteContactDialog
          isOpen={isDeleteDialogOpen}
          onClose={handleCloseDialogs}
          contact={selectedContact}
          onDeleted={onDeleted}
        />
      )}
    </>
  );
}
</file>

<file path="src/app/admin/contacts/DeleteContactDialog.tsx">
'use client';

import {
  AlertDialog,
  AlertDialogCancel,
  AlertDialogContent,
  AlertDialogDescription,
  AlertDialogFooter,
  AlertDialogHeader,
  AlertDialogTitle,
} from '@/components/ui/alert-dialog';
import { Button } from '@/components/ui/button';
import { useToast } from '@/hooks/use-toast';
import type { Contact } from '@/lib/types';
import { Loader2 } from 'lucide-react';
import { useState } from 'react';
import { deleteContact } from './actions';

interface DeleteContactDialogProps {
  isOpen: boolean;
  onClose: () => void;
  contact: Contact | null;
  onDeleted?: () => void;
}

export default function DeleteContactDialog({
  isOpen,
  onClose,
  contact,
  onDeleted,
}: DeleteContactDialogProps) {
  const { toast } = useToast();
  const [isDeleting, setIsDeleting] = useState(false);

  const handleDelete = async () => {
    if (!contact) return;

    setIsDeleting(true);
    try {
      const result = await deleteContact(contact.id);

      if (result?.error) {
        throw new Error(result.error);
      }

      toast({
        title: 'Contact deleted',
        description: `The contact "${contact.name}" has been successfully deleted.`,
      });
      if (onDeleted) {
        onDeleted();
      }
    } catch (error: any) {
      toast({
        variant: 'destructive',
        title: 'Error deleting contact',
        description: error.message,
      });
    } finally {
      setIsDeleting(false);
      onClose();
    }
  };

  return (
    <AlertDialog open={isOpen} onOpenChange={onClose}>
      <AlertDialogContent>
        <AlertDialogHeader>
          <AlertDialogTitle>Are you absolutely sure?</AlertDialogTitle>
          <AlertDialogDescription>
            This action cannot be undone. This will permanently delete the
            contact "{contact?.name}".
          </AlertDialogDescription>
        </AlertDialogHeader>
        <AlertDialogFooter>
          <AlertDialogCancel disabled={isDeleting} onClick={onClose}>Cancel</AlertDialogCancel>
          <Button
            variant="destructive"
            onClick={handleDelete}
            disabled={isDeleting}
          >
            {isDeleting && <Loader2 className="mr-2 h-4 w-4 animate-spin" />}
            Delete
          </Button>
        </AlertDialogFooter>
      </AlertDialogContent>
    </AlertDialog>
  );
}
</file>

<file path="src/app/admin/dashboard/DashboardClient.tsx">
'use client';

import {
  DollarSign,
  BarChart as BarChartIcon,
  Clock,
  Users,
} from 'lucide-react';
import StatCard from '@/components/admin/StatCard';
import { useSubmissions } from '@/hooks/useSubmissions';
import { useContacts } from '@/hooks/useContacts';
import { useServices } from '@/hooks/useServices';
import { Card, CardContent, CardHeader, CardTitle } from '@/components/ui/card';
import { Progress } from '@/components/ui/progress';
import { useMemo } from 'react';
import { format } from 'date-fns';
import { Submission } from '@/lib/types';
import Icon from '@/components/Icon';
import Link from 'next/link';

const serviceTypeToIconNameMap: Record<string, string> = {
    'Class ECS/ECNS Licensing': 'Shield',
    'ICASA Type Approvals': 'CheckSquare',
    'License Exemptions': 'FileText',
    'NRCS LOA Applications': 'FileText',
    'Radio Dealer Licensing': 'Radio',
    'Ski Boat VHF Licensing': 'Sailboat',
    'contact': 'MessageSquare',
    'default': 'Package',
};
  
const getIconForServiceType = (submission: Submission, props?: { className: string }) => {
      const type = submission.serviceName || submission.formType;
      const iconName = serviceTypeToIconNameMap[type] || serviceTypeToIconNameMap['default'];
      return <Icon name={iconName} {...props} />;
};

export default function DashboardClient() {
  const { submissions, loading: submissionsLoading, error: submissionsError } = useSubmissions();
  const { contacts, loading: contactsLoading, error: contactsError } = useContacts();
  const { services, loading: servicesLoading, error: servicesError } = useServices();

  const loading = submissionsLoading || contactsLoading || servicesLoading;
  const error = submissionsError || contactsError || servicesError;

  const stats = useMemo(() => {
    const total = submissions.length;
    const newCount = submissions.filter(s => s.status === 'pending').length;
    const totalContacts = contacts.length;

    const totalRevenue = submissions
      .filter(s => s.status === 'completed')
      .reduce((acc, submission) => {
        // Find service by ID (UUID) or by slug (from serviceName)
        const service = services.find(s => s.id === submission.serviceId || s.slug === submission.serviceName);
        return acc + (service?.pricing || 0);
      }, 0);

    return { total, newCount, totalContacts, totalRevenue };
  }, [submissions, contacts, services]);

  const recentSubmissions = useMemo(() => {
    return submissions.slice(0, 5);
  }, [submissions]);

  const submissionsByType = useMemo(() => {
    const typeMap = submissions.reduce((acc, sub) => {
        const key = sub.serviceName || sub.formType;
        acc[key] = (acc[key] || 0) + 1;
        return acc;
    }, {} as Record<string, number>);
    return Object.entries(typeMap).map(([name, value]) => ({ name, submissions: value }));
  }, [submissions]);
  
  if (error) {
    return <div className="text-destructive">Error loading dashboard data: {error.message}</div>;
  }

  return (
    <div className="space-y-8">
      <div className="grid gap-4 md:grid-cols-2 lg:grid-cols-4">
        <StatCard title="Total Submissions" value={loading ? '...' : `${stats.total}`} icon={<Icon name="Package" className="h-4 w-4" />} />
        <StatCard title="New Applications" value={loading ? '...' : `${stats.newCount}`} icon={<BarChartIcon className="h-4 w-4" />} description="Awaiting review" />
        <StatCard title="Total Contacts" value={loading ? '...' : `${stats.totalContacts}`} icon={<Users className="h-4 w-4" />} />
        <StatCard 
            title="Total Revenue" 
            value={loading ? '...' : `R ${stats.totalRevenue.toLocaleString('en-ZA', { minimumFractionDigits: 2, maximumFractionDigits: 2 })}`} 
            icon={<DollarSign className="h-4 w-4" />} 
            description="From completed submissions" 
        />
      </div>

      <div className="grid gap-8 md:grid-cols-2">
        <Card>
            <CardHeader className="flex flex-row items-center justify-between pb-2">
                <CardTitle className="text-lg font-medium">Submissions by Type</CardTitle>
            </CardHeader>
            <CardContent>
            <div className="space-y-4">
              {submissionsByType.length > 0 ? (
                (() => {
                  const maxSubmissions = Math.max(...submissionsByType.map((s) => s.submissions), 0);
                  const progressColorClasses = [
                    "[&>div]:bg-chart-1",
                    "[&>div]:bg-chart-2",
                    "[&>div]:bg-chart-3",
                    "[&>div]:bg-chart-4",
                    "[&>div]:bg-chart-5",
                  ];
                  return submissionsByType
                    .sort((a, b) => b.submissions - a.submissions)
                    .map((item, index) => (
                      <div key={item.name} className="grid grid-cols-[auto_1fr_auto] items-center gap-4">
                        <div className='flex items-center gap-3'>
                            {getIconForServiceType({ formType: item.name, serviceName: item.name } as Submission, { className: "h-5 w-5 text-muted-foreground"})}
                            <span className="truncate text-sm font-medium">{item.name}</span>
                        </div>
                        <Progress
                          value={maxSubmissions > 0 ? (item.submissions / maxSubmissions) * 100 : 0}
                          className={`h-2 ${progressColorClasses[index % progressColorClasses.length]}`}
                        />
                        <span className="font-mono text-sm font-medium">{item.submissions}</span>
                      </div>
                    ));
                })()
              ) : (
                <div className="text-center text-muted-foreground pt-4">No submissions yet.</div>
              )}
            </div>
          </CardContent>
        </Card>
        
        <Card>
            <CardHeader className="flex flex-row items-center justify-between pb-2">
                <CardTitle className="text-lg font-medium">Recent Submissions</CardTitle>
                <Clock className="h-5 w-5 text-muted-foreground" />
            </CardHeader>
            <CardContent>
                <div className="space-y-2">
                {recentSubmissions.length > 0 ? (
                    recentSubmissions.map(submission => (
                        <Link 
                            key={submission.id}
                            href={`/admin/form_submissions/${submission.id}`}
                            className="block rounded-lg transition-colors hover:bg-muted/50"
                        >
                            <div className="flex items-start gap-4 p-3">
                                <div className="flex h-9 w-9 items-center justify-center rounded-lg bg-primary/10 text-primary shrink-0">
                                    {getIconForServiceType(submission, { className: "h-5 w-5"})}
                                </div>
                                <div className="grid gap-0.5 flex-1">
                                    <p className="text-sm font-medium">{submission.fullName}</p>
                                    <p className="text-xs text-muted-foreground">{submission.email}</p>
                                    <p className="text-xs text-muted-foreground mt-1">{submission.serviceName || submission.formType}</p>
                                </div>
                                <div className="ml-auto text-xs text-muted-foreground whitespace-nowrap">
                                    {format(new Date(submission.createdAt), 'dd MMM yyyy, HH:mm')}
                                </div>
                            </div>
                        </Link>
                    ))
                ) : (
                    <div className="text-center text-muted-foreground pt-4">No recent submissions.</div>
                )}
                </div>
          </CardContent>
        </Card>
      </div>
    </div>
  );
}
</file>

<file path="src/app/admin/services/[id]/ServiceDetails.tsx">
'use client';

import { Badge } from '@/components/ui/badge';
import type { Service, PricingPlan, ProcessStep, SuccessStory } from '@/lib/types';
import { format } from 'date-fns';
import { Card, CardContent, CardHeader, CardTitle, CardDescription } from '@/components/ui/card';
import { Button } from '@/components/ui/button';
import Link from 'next/link';
import { ArrowLeft, Edit, Trash2, Phone, CheckCircle } from 'lucide-react';
import { useState } from 'react';
import DeleteServiceDialog from '../DeleteServiceDialog';
import { useRouter } from 'next/navigation';
import Image from 'next/image';
import Icon from '@/components/Icon';

interface ServiceDetailsProps {
  service: Service;
}

export default function ServiceDetails({ service }: ServiceDetailsProps) {
  const router = useRouter();
  const [isDeleteDialogOpen, setIsDeleteDialogOpen] = useState(false);

  if (!service) return null;

  const handleDelete = () => {
    setIsDeleteDialogOpen(true);
  };
  
  const handleCloseDialog = () => {
    setIsDeleteDialogOpen(false);
  };

  const onDeleted = () => {
    setIsDeleteDialogOpen(false);
    router.push('/admin/services');
    router.refresh();
  }

  const renderStringArray = (data: string[] | undefined) => {
    if (!data || data.length === 0) return <p className="text-sm text-card-foreground">Not set.</p>;
    return (
        <ul className="list-disc list-inside space-y-1 mt-1 text-sm text-card-foreground">
            {data.map((item, index) => (
                <li key={index}>{item}</li>
            ))}
        </ul>
    )
  }

  const renderPricingPlans = (plans: PricingPlan[] | undefined) => {
    if (!plans || plans.length === 0) return <p className="text-sm text-card-foreground">No pricing plans defined.</p>;
    return (
        <div className="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4 mt-2">
            {plans.map((plan, index) => (
                <Card key={index} className="flex flex-col">
                    <CardHeader>
                        <div className="flex justify-between items-start">
                            <CardTitle className="text-lg">{plan.title}</CardTitle>
                            {plan.popular && <Badge variant="default">Popular</Badge>}
                        </div>
                        <CardDescription>{plan.description}</CardDescription>
                    </CardHeader>
                    <CardContent className="flex-grow space-y-4">
                        <p className="text-2xl font-bold">{plan.price}</p>
                        <ul className="space-y-2 text-sm text-muted-foreground">
                            {plan.features.map((feature, i) => (
                                <li key={i} className="flex items-start">
                                    <CheckCircle className="h-4 w-4 mr-2 mt-1 text-green-500 shrink-0" />
                                    <span>{feature}</span>
                                </li>
                            ))}
                        </ul>
                    </CardContent>
                </Card>
            ))}
        </div>
    )
  };

  const renderProcessSteps = (steps: ProcessStep[] | undefined) => {
    if (!steps || steps.length === 0) return <p className="text-sm text-card-foreground">No process steps defined.</p>;
    return (
        <div className="relative mt-4 pl-6">
            <div className="absolute left-0 top-0 bottom-0 w-px bg-border -translate-x-1/2 ml-3"></div>
            <div className="space-y-8">
            {steps.map((step, index) => (
                <div key={index} className="relative flex items-start gap-4">
                    <div className="flex-shrink-0 w-6 h-6 bg-primary text-primary-foreground rounded-full flex items-center justify-center font-bold text-xs z-10">
                        {step.step}
                    </div>
                    <div className="flex-grow">
                        <h5 className="font-semibold text-card-foreground">{step.title}</h5>
                        <p className="text-sm text-muted-foreground">{step.description}</p>
                    </div>
                </div>
              ))}
            </div>
        </div>
    )
  };

  const renderSuccessStory = (story: SuccessStory | undefined) => {
    if (!story) return <p className="text-sm text-card-foreground">No success story defined.</p>;
    return (
         <Card className="mt-2 bg-muted/50">
            <CardContent className="p-6 space-y-4">
                <div>
                    <h5 className="text-xs font-semibold text-muted-foreground uppercase tracking-wider">Scenario</h5>
                    <p className="text-sm text-card-foreground">{story.scenario}</p>
                </div>
                 <div>
                    <h5 className="text-xs font-semibold text-muted-foreground uppercase tracking-wider">Challenge</h5>
                    <p className="text-sm text-card-foreground">{story.challenge}</p>
                </div>
                 <div>
                    <h5 className="text-xs font-semibold text-muted-foreground uppercase tracking-wider">Solution</h5>
                    <p className="text-sm text-card-foreground">{story.solution}</p>
                </div>
                 <div>
                    <h5 className="text-xs font-semibold text-muted-foreground uppercase tracking-wider">Result</h5>
                    <p className="text-sm text-card-foreground font-medium">{story.result}</p>
                </div>
            </CardContent>
         </Card>
    )
  };


  return (
    <>
      <div className="space-y-6">
        <div className="flex items-center justify-between">
            <Button variant="outline" asChild>
                <Link href="/admin/services">
                    <ArrowLeft className="mr-2 h-4 w-4" />
                    Back to Services
                </Link>
            </Button>
            <div className="flex gap-2">
                <Button asChild>
                    <Link href={`/admin/services/${service.id}/edit`}>
                        <Edit className="mr-2 h-4 w-4" /> Edit
                    </Link>
                </Button>
                <Button variant="destructive" onClick={handleDelete}>
                    <Trash2 className="mr-2 h-4 w-4" /> Delete
                </Button>
            </div>
        </div>

        <Card>
            <CardHeader>
                <div className="flex justify-between items-start">
                    <div>
                        <CardTitle>{service.title}</CardTitle>
                        <CardDescription>{service.category}</CardDescription>
                    </div>
                     <Badge variant={service.featured ? 'default' : 'secondary'}>
                        {service.featured ? 'Featured' : 'Not Featured'}
                    </Badge>
                </div>
            </CardHeader>
            <CardContent>
                <div className="grid gap-6 md:grid-cols-2">
                    <div className="space-y-6">
                        <div>
                            <h4 className="text-sm font-medium text-muted-foreground">Status</h4>
                            <Badge variant={service.published ? 'default' : 'secondary'}>
                                {service.published ? 'Published' : 'Draft'}
                            </Badge>
                        </div>
                        {service.description && (
                            <div>
                                <h4 className="text-sm font-medium text-muted-foreground">Description</h4>
                                <p className="text-sm text-card-foreground">{service.description}</p>
                            </div>
                        )}
                        {service.short_description && (
                            <div>
                                <h4 className="text-sm font-medium text-muted-foreground">Short Description</h4>
                                <p className="text-sm text-card-foreground">{service.short_description}</p>
                            </div>
                        )}
                        {service.content && (
                            <div>
                                <h4 className="text-sm font-medium text-muted-foreground">Content</h4>
                                <div className="prose prose-sm dark:prose-invert mt-1 text-card-foreground text-sm whitespace-pre-wrap">
                                    {service.content}
                                </div>
                            </div>
                        )}
                        <div>
                            <h4 className="text-sm font-medium text-muted-foreground">Features</h4>
                            {renderStringArray(service.features)}
                        </div>
                        <div>
                            <h4 className="text-sm font-medium text-muted-foreground">Requirements</h4>
                            {renderStringArray(service.requirements)}
                        </div>
                        <div>
                            <h4 className="text-sm font-medium text-muted-foreground">Includes</h4>
                            {renderStringArray(service.includes)}
                        </div>
                    </div>
                    <div className="space-y-6">
                        {service.slug && (
                            <div>
                                <h4 className="text-sm font-medium text-muted-foreground">Slug</h4>
                                <p className="text-sm font-mono text-card-foreground">{service.slug}</p>
                            </div>
                        )}
                         {service.href && (
                            <div>
                                <h4 className="text-sm font-medium text-muted-foreground">HREF</h4>
                                <p className="text-sm font-mono text-card-foreground">{service.href}</p>
                            </div>
                        )}
                         {service.icon && (
                            <div>
                                <h4 className="text-sm font-medium text-muted-foreground">Icon</h4>
                                <div className="flex items-center gap-2 mt-1">
                                    <Icon name={service.icon} className="h-5 w-5 text-accent" />
                                    <p className="text-sm font-mono text-card-foreground">{service.icon}</p>
                                </div>
                            </div>
                        )}
                        {service.order_index !== undefined && (
                             <div>
                                <h4 className="text-sm font-medium text-muted-foreground">Order Index</h4>
                                <p className="text-sm text-card-foreground">{service.order_index}</p>
                            </div>
                        )}
                        {service.processing_time && (
                            <div>
                                <h4 className="text-sm font-medium text-muted-foreground">Processing Time</h4>
                                <p className="text-sm text-card-foreground">{service.processing_time}</p>
                            </div>
                        )}
                        {service.pricing !== null && service.pricing !== undefined && (
                            <div>
                                <h4 className="text-sm font-medium text-muted-foreground">Pricing</h4>
                                <p className="text-sm font-mono text-card-foreground">R{Number(service.pricing).toFixed(2)}</p>
                            </div>
                        )}
                         <div>
                            <h4 className="text-sm font-medium text-muted-foreground">Created At</h4>
                            <p className="text-sm text-card-foreground">{format(new Date(service.created_at), 'PPpp')}</p>
                        </div>
                    </div>
                </div>

                {(service.image || service.thumbnail) && (
                    <div className="mt-6 border-t pt-6">
                        <h3 className="text-lg font-medium mb-4">Media</h3>
                        <div className="flex gap-4">
                        {service.image && (
                            <div>
                                <h4 className="text-sm font-medium text-muted-foreground">Image</h4>
                                <Image src={service.image} alt="Service Image" width={300} height={200} className="mt-1 rounded-md border" />
                            </div>
                        )}
                        {service.thumbnail && (
                            <div>
                                <h4 className="text-sm font-medium text-muted-foreground">Thumbnail</h4>
                                <Image src={service.thumbnail} alt="Service Thumbnail" width={150} height={100} className="mt-1 rounded-md border" />
                            </div>
                        )}
                        </div>
                    </div>
                )}
                 {(service.seo_title || service.seo_description || service.seo_keywords) && (
                    <div className="mt-6 border-t pt-6">
                        <h3 className="text-lg font-medium mb-4">SEO</h3>
                        <div className="grid md:grid-cols-2 gap-6">
                        {service.seo_title && (
                            <div>
                            <h4 className="text-sm font-medium text-muted-foreground">SEO Title</h4>
                            <p className="text-sm text-card-foreground">{service.seo_title}</p>
                            </div>
                        )}
                        {service.seo_description && (
                            <div>
                            <h4 className="text-sm font-medium text-muted-foreground">SEO Description</h4>
                            <p className="text-sm text-card-foreground">{service.seo_description}</p>
                            </div>
                        )}
                        {service.seo_keywords && (
                             <div className="col-span-full">
                            <h4 className="text-sm font-medium text-muted-foreground">SEO Keywords</h4>
                            <p className="text-sm text-card-foreground">{service.seo_keywords}</p>
                            </div>
                        )}
                        </div>
                    </div>
                 )}

                <div className="mt-6 border-t pt-6">
                    <h3 className="text-lg font-medium mb-4">Pricing Plans</h3>
                    {renderPricingPlans(service.pricing_plans)}
                </div>
                 <div className="mt-6 border-t pt-6">
                    <h3 className="text-lg font-medium mb-4">Process Steps</h3>
                    {renderProcessSteps(service.process_steps)}
                </div>
                 <div className="mt-6 border-t pt-6">
                    <h3 className="text-lg font-medium mb-4">Success Story</h3>
                    {renderSuccessStory(service.success_story)}
                </div>

            </CardContent>
        </Card>
      </div>
      
      {isDeleteDialogOpen && (
        <DeleteServiceDialog
            isOpen={isDeleteDialogOpen}
            onClose={handleCloseDialog}
            service={service}
            onDeleted={onDeleted}
        />
      )}
    </>
  );
}
</file>

<file path="src/app/admin/testimonials/DeleteTestimonialDialog.tsx">
'use client';

import {
  AlertDialog,
  AlertDialogCancel,
  AlertDialogContent,
  AlertDialogDescription,
  AlertDialogFooter,
  AlertDialogHeader,
  AlertDialogTitle,
} from '@/components/ui/alert-dialog';
import { Button } from '@/components/ui/button';
import { useToast } from '@/hooks/use-toast';
import type { Testimonial } from '@/lib/types';
import { Loader2 } from 'lucide-react';
import { useState } from 'react';

interface DeleteTestimonialDialogProps {
  isOpen: boolean;
  onClose: () => void;
  testimonial: Testimonial | null;
  onDeleted?: () => void;
}

export default function DeleteTestimonialDialog({
  isOpen,
  onClose,
  testimonial,
  onDeleted,
}: DeleteTestimonialDialogProps) {
  const { toast } = useToast();
  const [isDeleting, setIsDeleting] = useState(false);

  const handleDelete = async () => {
    if (!testimonial) return;

    setIsDeleting(true);
    try {
      const response = await fetch(`/api/testimonials/${testimonial.id}`, {
        method: 'DELETE',
      });

      if (!response.ok) {
        let errorMessage = `API Error: ${response.status} ${response.statusText}`;
        try {
            const errorData = await response.json();
            if (errorData.error) {
                errorMessage = errorData.error;
            }
        } catch (jsonError) {
            console.error("Could not parse JSON from error response.");
        }
        throw new Error(errorMessage);
      }

      toast({
        title: 'Testimonial deleted',
        description: 'The testimonial has been successfully deleted.',
      });
      if (onDeleted) {
        onDeleted();
      } else {
        onClose();
      }
    } catch (error: any) {
      toast({
        variant: 'destructive',
        title: 'Error deleting testimonial',
        description: error.message,
      });
    } finally {
      setIsDeleting(false);
    }
  };

  return (
    <AlertDialog open={isOpen} onOpenChange={onClose}>
      <AlertDialogContent>
        <AlertDialogHeader>
          <AlertDialogTitle>Are you absolutely sure?</AlertDialogTitle>
          <AlertDialogDescription>
            This action cannot be undone. This will permanently delete the testimonial.
          </AlertDialogDescription>
        </AlertDialogHeader>
        <AlertDialogFooter>
          <AlertDialogCancel disabled={isDeleting} onClick={onClose}>Cancel</AlertDialogCancel>
          <Button
            variant="destructive"
            onClick={handleDelete}
            disabled={isDeleting}
          >
            {isDeleting && <Loader2 className="mr-2 h-4 w-4 animate-spin" />}
            Delete
          </Button>
        </AlertDialogFooter>
      </AlertDialogContent>
    </AlertDialog>
  );
}
</file>

<file path="src/app/admin/testimonials/TestimonialsClient.tsx">
'use client';

import { useState } from 'react';
import { useTestimonials } from '@/hooks/useTestimonials';
import { Card, CardContent, CardDescription, CardHeader, CardTitle } from '@/components/ui/card';
import { Button } from '@/components/ui/button';
import { PlusCircle, MoreHorizontal } from 'lucide-react';
import type { Testimonial } from '@/lib/types';
import DeleteTestimonialDialog from './DeleteTestimonialDialog';
import Link from 'next/link';
import { format } from 'date-fns';
import {
  DropdownMenu,
  DropdownMenuContent,
  DropdownMenuItem,
  DropdownMenuLabel,
  DropdownMenuSeparator,
  DropdownMenuTrigger,
} from '@/components/ui/dropdown-menu';
import TestimonialEmbed from './TestimonialEmbed';
import TestimonialsLoading from './loading';
import { useRouter } from 'next/navigation';

export default function TestimonialsClient() {
  const { testimonials, loading, error } = useTestimonials();
  const [isDeleteDialogOpen, setIsDeleteDialogOpen] = useState(false);
  const [selectedTestimonial, setSelectedTestimonial] = useState<Testimonial | null>(null);
  const router = useRouter();
  
  const handleDelete = (testimonial: Testimonial) => {
    setSelectedTestimonial(testimonial);
    setIsDeleteDialogOpen(true);
  };

  const handleCloseDialogs = () => {
    setIsDeleteDialogOpen(false);
    setSelectedTestimonial(null);
  };
  
  const onDeleted = () => {
      handleCloseDialogs();
      router.refresh();
  }

  if (error) {
    return <div className="text-destructive">Error loading testimonials: {error.message}</div>;
  }
  
  return (
    <>
      <div className="flex justify-end">
          <Button asChild>
            <Link href="/admin/testimonials/new">
              <PlusCircle className="mr-2 h-4 w-4" />
              Add Testimonial
            </Link>
          </Button>
      </div>
      
      <div className="mt-6">
        {loading ? <TestimonialsLoading /> : testimonials.length === 0 ? (
            <div className="flex flex-col items-center justify-center rounded-lg border-2 border-dashed border-muted-foreground/30 py-24 text-center">
                <h3 className="text-lg font-semibold tracking-tight">No Testimonials Yet</h3>
                <p className="text-sm text-muted-foreground">Click "Add Testimonial" to get started.</p>
            </div>
        ) : (
            <div className="grid gap-6 md:grid-cols-2 lg:grid-cols-3">
                {testimonials.map((testimonial) => (
                    <div key={testimonial.id} className="group relative">
                        <Link href={`/admin/testimonials/${testimonial.id}`} className="absolute inset-0 z-10" aria-label={`View testimonial`}>
                            <span className="sr-only">View Details</span>
                        </Link>
                        <Card className="flex flex-col h-full hover:shadow-lg hover:border-primary/50 transition-all">
                            <CardHeader className="flex-row items-center justify-between">
                                <div>
                                    <CardTitle className="text-base">Testimonial</CardTitle>
                                    <CardDescription className="text-xs">
                                        Added on {format(new Date(testimonial.createdAt), 'PP')}
                                    </CardDescription>
                                </div>
                                <div className="relative z-20">
                                <DropdownMenu>
                                    <DropdownMenuTrigger asChild>
                                    <Button variant="ghost" className="h-8 w-8 p-0" onClick={(e) => e.preventDefault()}>
                                        <span className="sr-only">Open menu</span>
                                        <MoreHorizontal className="h-4 w-4" />
                                    </Button>
                                    </DropdownMenuTrigger>
                                    <DropdownMenuContent align="end">
                                    <DropdownMenuLabel>Actions</DropdownMenuLabel>
                                    <DropdownMenuItem onClick={(e) => { e.preventDefault(); router.push(`/admin/testimonials/${testimonial.id}`)}}>View</DropdownMenuItem>
                                    <DropdownMenuItem onClick={(e) => { e.preventDefault(); router.push(`/admin/testimonials/${testimonial.id}/edit`)}}>Edit</DropdownMenuItem>
                                    <DropdownMenuSeparator />
                                    <DropdownMenuItem
                                        className="text-destructive focus:bg-destructive/10 focus:text-destructive"
                                        onClick={(e) => { e.preventDefault(); handleDelete(testimonial); }}
                                    >
                                        Delete
                                    </DropdownMenuItem>
                                    </DropdownMenuContent>
                                </DropdownMenu>
                                </div>
                            </CardHeader>
                            <CardContent className="flex-grow p-0 overflow-hidden">
                                <TestimonialEmbed postUrl={testimonial.postUrl} />
                            </CardContent>
                        </Card>
                    </div>
                ))}
            </div>
        )}
      </div>

      {isDeleteDialogOpen && (
        <DeleteTestimonialDialog
            isOpen={isDeleteDialogOpen}
            onClose={handleCloseDialogs}
            testimonial={selectedTestimonial}
            onDeleted={onDeleted}
        />
      )}
    </>
  );
}
</file>

<file path="src/app/layout.tsx">
import type { Metadata } from 'next';
import './globals.css';
import { Toaster } from '@/components/ui/toaster';
import MainLayout from '@/components/MainLayout';
import FacebookSDKInitializer from '@/components/FacebookSDKInitializer';
import Footer from '@/components/Footer';

export const metadata: Metadata = {
  title: {
    default: 'Bilacert - Your Compliance Partner | ICASA & NRCS Approvals',
    template: '%s | Bilacert',
  },
  description: 'Bilacert simplifies ICASA and NRCS LOA compliance for South African businesses. Expert guidance for type approvals, licensing, and regulatory compliance. Get your approvals faster with our streamlined process.',
  keywords: 'ICASA, NRCS, compliance, South Africa, regulatory approval, type approval, licensing',
};

export default function RootLayout({
  children,
}: Readonly<{
  children: React.ReactNode;
}>) {
  return (
    <html lang="en" suppressHydrationWarning>
      <head>
        <link rel="preconnect" href="https://fonts.googleapis.com" />
        <link
          rel="preconnect"
          href="https://fonts.gstatic.com"
          crossOrigin="anonymous"
        />
        <link
          href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap"
          rel="stylesheet"
        />
      </head>
      <body className="font-body antialiased bg-background text-foreground">
        <FacebookSDKInitializer />
        <MainLayout footer={<Footer />}>{children}</MainLayout>
        <Toaster />
      </body>
    </html>
  );
}
</file>

<file path="src/app/page.tsx">
import type { Metadata } from 'next';
import Link from 'next/link';
import Image from 'next/image';
import {
	CheckCircle,
	Shield,
	ArrowRight,
} from 'lucide-react';
import StructuredData from '@/components/StructuredData';
import Testimonials from '@/components/Testimonials';
import { getFeaturedServices } from '@/lib/supabase/services';
import { getPublishedBlogPosts } from '@/lib/supabase/blog';
import { Button } from '@/components/ui/button';
import Icon from '@/components/Icon';
import { format } from 'date-fns';

export const metadata: Metadata = {
	title: 'Bilacert - Your Compliance Partner | ICASA & NRCS Approvals',
	description:
		'Bilacert simplifies ICASA and NRCS LOA compliance for South African businesses. Expert guidance for type approvals, licensing, and regulatory compliance. Get your approvals faster with our streamlined process.',
	keywords: [
		'ICASA type approval',
		'NRCS LOA',
		'South Africa compliance',
		'radio dealer license',
		'ECS ECNS licensing',
		'VHF radio license',
		'compliance consultant',
		'regulatory approval',
		'telecommunications compliance',
		'electronic communications',
	],
	authors: [{ name: 'Bilacert (Pty) Ltd' }],
	creator: 'Bilacert',
	publisher: 'Bilacert',
	formatDetection: {
		email: false,
		address: false,
		telephone: false,
	},
	metadataBase: new URL('https://bilacert.co.za'),
	alternates: {
		canonical: '/',
	},
	openGraph: {
		title: 'Bilacert - Your Compliance Partner | ICASA & NRCS Approvals',
		description:
			'Simplifying ICASA and NRCS compliance for South African businesses. Expert guidance for type approvals, licensing, and regulatory compliance.',
		url: 'https://bilacert.co.za',
		siteName: 'Bilacert',
		images: [
			{
				url: '/logo.jpg',
				width: 1200,
				height: 630,
				alt: 'Bilacert - Your Compliance Partner',
			},
		],
		locale: 'en_ZA',
		type: 'website',
	},
	twitter: {
		card: 'summary_large_image',
		title: 'Bilacert - Your Compliance Partner',
		description: 'Simplifying ICASA and NRCS compliance for South African businesses',
		images: ['/logo.jpg'],
	},
	robots: {
		index: true,
		follow: true,
		googleBot: {
			'index': true,
			'follow': true,
			'max-video-preview': -1,
			'max-image-preview': 'large',
			'max-snippet': -1,
		},
	},
	verification: {
		google: 'your-google-verification-code',
	},
};


export default async function HomePage() {
	const organizationData = {
		name: 'Bilacert (Pty) Ltd',
		description:
			'Bilacert simplifies ICASA and NRCS LOA compliance for South African businesses. Expert guidance for type approvals, licensing, and regulatory compliance.',
		serviceType: 'Compliance Consulting',
		price: 'From R1,000',
	};

	const services = await getFeaturedServices();
	const blogPosts = await getPublishedBlogPosts(3);


	const whyChooseUs = [
		{
			title: 'Expert Guidance',
			description:
				'Deep industry knowledge and regulatory expertise to guide you through complex compliance requirements.',
			icon: 'Users',
		},
		{
			title: 'Efficient Process',
			description:
				'Streamlined applications and proactive problem-solving to minimize delays and maximize success rates.',
			icon: 'Clock',
		},
		{
			title: 'Client-Centric Approach',
			description:
				'Personalized support and clear communication throughout your compliance journey.',
			icon: 'CheckCircle',
		},
	];

	return (
		<div className='min-h-screen'>
			<StructuredData
				type='Organization'
				data={organizationData}
			/>
			{/* Hero Section */}
			<section className='relative text-white py-20 lg:py-32'>
				<Image
					src="https://picsum.photos/seed/hero/1920/1080"
					data-ai-hint="compliance business"
					alt='Bilacert compliance'
					fill
					priority
					className='object-cover'
				/>
				<div className='absolute inset-0 bg-black/40'></div>
				<div className='relative max-w-7xl mx-auto px-4 sm:px-6 lg:px-8'>
					<div className='grid grid-cols-1 lg:grid-cols-2 gap-12 items-center'>
						<div>
							<h1 className='text-4xl lg:text-6xl font-bold mb-6 leading-tight'>
								Compliance Simplified
							</h1>
							<p className='text-xl lg:text-2xl mb-8 text-gray-200'>
								Expert guidance for ICASA and NRCS approvals. We handle the complexity so you can
								focus on growing your business.
							</p>
							<div className='flex flex-col sm:flex-row gap-4'>
								<Button size="lg" asChild>
									<Link href='/contact'>Get Free Consultation</Link>
								</Button>
								<Button size="lg" variant="outline" asChild className="bg-transparent border-white text-white hover:bg-white hover:text-primary">
									<Link href='/services'>View Our Services</Link>
								</Button>
							</div>
						</div>
						<div className='hidden lg:block'>
							<div className='bg-white/10 backdrop-blur-sm rounded-2xl p-8'>
								<div className='space-y-6'>
									<div className='flex items-center space-x-4'>
										<div className='bg-accent p-3 rounded-lg'>
											<CheckCircle className='h-6 w-6 text-white' />
										</div>
										<div>
											<h3 className='font-semibold'>30+ Days Faster</h3>
											<p className='text-gray-300'>Than industry average</p>
										</div>
									</div>
									<div className='flex items-center space-x-4'>
										<div className='bg-accent p-3 rounded-lg'>
											<Shield className='h-6 w-6 text-white' />
										</div>
										<div>
											<h3 className='font-semibold'>100% Compliance</h3>
											<p className='text-gray-300'>Guaranteed approval</p>
										</div>
									</div>
									<div className='flex items-center space-x-4'>
										<div className='bg-accent p-3 rounded-lg'>
											<Icon name="Users" className='h-6 w-6 text-white' />
										</div>
										<div>
											<h3 className='font-semibold'>500+ Clients</h3>
											<p className='text-gray-300'>Successfully served</p>
										</div>
									</div>
								</div>
							</div>
						</div>
					</div>
				</div>
			</section>

			{/* Services Overview */}
			<section className='py-20 bg-secondary-gray'>
				<div className='max-w-7xl mx-auto px-4 sm:px-6 lg:px-8'>
					<div className='text-center mb-16'>
						<h2 className='text-3xl lg:text-4xl font-bold text-primary mb-4'>Our Services</h2>
						<p className='text-xl text-gray-600 max-w-3xl mx-auto'>
							Comprehensive compliance solutions covering all aspects of ICASA and NRCS regulatory
							approvals
						</p>
					</div>

					<div className='grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-8'>
						{services.map((service) => (
							<Link
								key={service.id}
								href={service.href}
								className='bg-white p-6 rounded-xl shadow-sm hover:shadow-lg transition-all duration-300 transform hover:-translate-y-2 group'>
								<div className='text-accent mb-4 group-hover:scale-110 transition-transform duration-200'>
									<Icon name={service.icon || 'Shield'} className='h-8 w-8' />
								</div>
								<h3 className='text-xl font-semibold text-primary mb-3'>{service.title}</h3>
								<p className='text-gray-600 mb-4'>{service.short_description}</p>
								<div className='flex items-center text-accent font-medium'>
									Learn More
									<ArrowRight className='h-4 w-4 ml-2 group-hover:translate-x-1 transition-transform duration-200' />
								</div>
							</Link>
						))}
					</div>
				</div>
			</section>

			{/* Why Choose Us */}
			<section className='py-20'>
				<div className='max-w-7xl mx-auto px-4 sm:px-6 lg:px-8'>
					<div className='text-center mb-16'>
						<h2 className='text-3xl lg:text-4xl font-bold text-primary mb-4'>
							Why Choose Bilacert?
						</h2>
						<p className='text-xl text-gray-600 max-w-3xl mx-auto'>
							We make compliance simple, efficient, and stress-free for businesses of all sizes
						</p>
					</div>

					<div className='grid grid-cols-1 md:grid-cols-3 gap-8'>
						{whyChooseUs.map((item, index) => (
							<div
								key={index}
								className='text-center'>
								<div className='bg-accent/10 w-16 h-16 rounded-full flex items-center justify-center mx-auto mb-6'>
									<div className='text-accent'><Icon name={item.icon} className='h-8 w-8' /></div>
								</div>
								<h3 className='text-xl font-semibold text-primary mb-4'>{item.title}</h3>
								<p className='text-gray-600'>{item.description}</p>
							</div>
						))}
					</div>
				</div>
			</section>

			<Testimonials />

			{/* Blog Preview */}
			<section className='py-20 bg-secondary-gray'>
				<div className='max-w-7xl mx-auto px-4 sm:px-6 lg:px-8'>
					<div className='text-center mb-16'>
						<h2 className='text-3xl lg:text-4xl font-bold text-primary mb-4'>Latest Insights</h2>
						<p className='text-xl text-gray-600 max-w-3xl mx-auto'>
							Stay informed with our latest compliance insights and industry updates
						</p>
					</div>

					<div className='grid grid-cols-1 md:grid-cols-3 gap-8'>
						{blogPosts.map((post) => (
							<Link
								key={post.id}
								href={`/blog/${post.slug}`}
								className='bg-white p-6 rounded-xl shadow-sm hover:shadow-lg transition-all duration-300 transform hover:-translate-y-2'>
								<div className='text-sm text-gray-500 mb-2'>
									{format(new Date(post.createdAt), 'PP')}
								</div>
								<h3 className='text-xl font-semibold text-primary mb-3'>{post.title}</h3>
								<p className='text-gray-600 mb-4'>{post.excerpt}</p>
								<div className='flex items-center text-accent font-medium'>
									Read More
									<ArrowRight className='h-4 w-4 ml-2' />
								</div>
							</Link>
						))}
					</div>

					<div className='text-center mt-12'>
						<Button asChild>
							<Link href='/blog'>View All Posts</Link>
						</Button>
					</div>
				</div>
			</section>

			{/* Final CTA */}
			<section className='py-20 bg-gradient-to-r from-primary to-primary-light text-white'>
				<div className='max-w-4xl mx-auto px-4 sm:px-6 lg:px-8 text-center'>
					<h2 className='text-3xl lg:text-4xl font-bold mb-6'>
						Ready to Simplify Your Compliance?
					</h2>
					<p className='text-xl mb-8 text-gray-200'>
						Get expert guidance and streamline your ICASA and NRCS approval process. Contact us
						today for a free consultation.
					</p>
					<div className='flex flex-col sm:flex-row gap-4 justify-center'>
						<Button size="lg" asChild>
							<Link href='/contact'>Get Free Consultation</Link>
						</Button>
						<Button size="lg" variant="outline" asChild className="bg-transparent border-white text-white hover:bg-white hover:text-primary">
							<a href='tel:0754304433'>Call 075 430 4433</a>
						</Button>
					</div>
				</div>
			</section>
		</div>
	);
}
</file>

<file path="src/components/ui/ImageUpload.tsx">
'use client';

import { supabase } from '@/lib/supabase/supabase';
import { useState } from 'react';
import { useToast } from '@/hooks/use-toast';
import { Loader2, Upload, X } from 'lucide-react';
import { Button } from './button';
import Image from 'next/image';

interface ImageUploadProps {
  bucket: string;
  onUpload: (url: string) => void;
  initialUrl?: string | null;
  onRemove?: () => void;
}

export default function ImageUpload({ bucket, onUpload, initialUrl, onRemove }: ImageUploadProps) {
  const { toast } = useToast();
  const [uploading, setUploading] = useState(false);
  const [imageUrl, setImageUrl] = useState<string | null>(initialUrl || null);

  const handleFileChange = async (event: React.ChangeEvent<HTMLInputElement>) => {
    const file = event.target.files?.[0];
    if (!file) return;

    setUploading(true);
    try {
      const fileName = `${Date.now()}_${file.name.replace(/\s/g, '_')}`;
      const filePath = fileName;

      const { data, error } = await supabase.storage
        .from(bucket)
        .upload(filePath, file);

      if (error) throw error;

      const { data: { publicUrl } } = supabase.storage
        .from(bucket)
        .getPublicUrl(filePath);

      setImageUrl(publicUrl);
      onUpload(publicUrl);
      toast({ title: 'Image uploaded successfully' });
    } catch (error: any) {
      toast({
        variant: 'destructive',
        title: 'Error uploading image',
        description: error.message,
      });
      throw error;
    } finally {
      setUploading(false);
    }
  };

  const handleRemoveImage = () => {
    setImageUrl(null);
    if (onRemove) {
        onRemove();
    } else {
        onUpload('');
    }
  };

  return (
    <div className="space-y-2">
      {imageUrl ? (
        <div className="relative group w-full max-w-sm">
          <Image
            src={imageUrl}
            alt="Uploaded image"
            width={400}
            height={200}
            className="rounded-lg object-cover border"
          />
          <Button
            type="button"
            variant="destructive"
            size="icon"
            className="absolute top-2 right-2 h-6 w-6 opacity-0 group-hover:opacity-100 transition-opacity"
            onClick={handleRemoveImage}
          >
            <X className="h-4 w-4" />
          </Button>
        </div>
      ) : (
        <div className="flex items-center justify-center w-full">
          <label
            htmlFor={`image-upload-${bucket}`}
            className="flex flex-col items-center justify-center w-full h-32 border-2 border-dashed rounded-lg cursor-pointer bg-muted/50 hover:bg-muted"
          >
            <div className="flex flex-col items-center justify-center pt-5 pb-6">
              {uploading ? (
                <Loader2 className="h-8 w-8 animate-spin text-muted-foreground" />
              ) : (
                <>
                  <Upload className="h-8 w-8 text-muted-foreground" />
                  <p className="mb-2 text-sm text-muted-foreground">
                    <span className="font-semibold">Click to upload</span> or drag and drop
                  </p>
                  <p className="text-xs text-muted-foreground">PNG, JPG, GIF</p>
                </>
              )}
            </div>
            <input id={`image-upload-${bucket}`} type="file" className="hidden" onChange={handleFileChange} disabled={uploading} accept="image/*" />
          </label>
        </div>
      )}
    </div>
  );
}
</file>

<file path="src/hooks/useBlogs.ts">
'use client';

import { useState, useEffect } from 'react';
import type { BlogPost } from '@/lib/types';
import { supabase, isSupabaseConfigured } from '@/lib/supabase/supabase';

export function useBlogs() {
  const [blogs, setBlogs] = useState<BlogPost[]>([]);
  const [loading, setLoading] = useState(true);
  const [error, setError] = useState<Error | null>(null);

  useEffect(() => {
    if (!isSupabaseConfigured) {
        setLoading(false);
        return;
    }
      
    const fetchBlogs = async () => {
      setLoading(true);
      const { data, error } = await supabase
        .from('blog_posts')
        .select('*')
        .order('created_at', { ascending: false });

      if (error) {
        setError(error);
        setBlogs([]);
      } else {
        const mappedData = data.map(item => ({
            id: item.id,
            title: item.title,
            slug: item.slug,
            excerpt: item.excerpt,
            content: item.content,
            category: item.category,
            tags: item.tags,
            read_time: item.read_time,
            seo_title: item.seo_title,
            seo_description: item.seo_description,
            seo_keywords: item.seo_keywords,
            featured_image: item.featured_image,
            thumbnail: item.thumbnail,
            published: item.published,
            published_at: item.published_at,
            featured: item.featured,
            author_id: item.author_id,
            author_name: item.author_name,
            views_count: item.views_count,
            createdAt: item.created_at,
            updatedAt: item.updated_at,
        })) as BlogPost[];

        setBlogs(mappedData);
        setError(null);
      }
      setLoading(false);
    };

    fetchBlogs();

    const channel = supabase
      .channel('blog_posts-realtime')
      .on(
        'postgres_changes',
        { event: '*', schema: 'public', table: 'blog_posts' },
        (payload) => {
          fetchBlogs();
        }
      )
      .subscribe();

    return () => {
      supabase.removeChannel(channel);
    };
  }, []);

  return { blogs, loading, error };
}
</file>

<file path="src/lib/supabase/services.ts">
import 'server-only';
import { createClient as createServerClient } from '@/lib/supabase/server';
import { createClient } from '@supabase/supabase-js';
import type { Service } from '../types';

function mapToService(item: any): Service {
    return {
        id: item.id,
        title: item.title,
        slug: item.slug,
        href: item.href,
        category: item.category,
        description: item.description,
        short_description: item.short_description,
        icon: item.icon,
        order_index: item.order_index,
        content: item.content,
        features: item.features,
        requirements: item.requirements,
        includes: item.includes,
        published: item.published,
        featured: item.featured,
        created_at: item.created_at,
        processing_time: item.processing_time,
        pricing: item.pricing,
        image: item.image,
        thumbnail: item.thumbnail,
        seo_title: item.seo_title,
        seo_description: item.seo_description,
        seo_keywords: item.seo_keywords,
        pricing_plans: item.pricing_plans,
        process_steps: item.process_steps,
        success_story: item.success_story,
    };
}

export async function getPublishedServices(): Promise<Service[]> {
  const supabase = await createServerClient();
  const { data, error } = await supabase
    .from('services')
    .select('*')
    .eq('published', true)
    .order('order_index', { ascending: true });

  if (error) {
    console.error('Error fetching services:', error);
    return [];
  }

  return data.map(mapToService);
}

export async function getFeaturedServices(): Promise<Service[]> {
  const supabase = await createServerClient();
  const { data, error } = await supabase
    .from('services')
    .select('*')
    .eq('published', true)
    .eq('featured', true)
    .order('order_index', { ascending: true })
    .limit(4);

  if (error) {
    console.error('Error fetching featured services:', error);
    return [];
  }

  return data.map(mapToService);
}

export async function getServiceBySlug(slug: string): Promise<Service | null> {
  const supabase = createClient(
    process.env.NEXT_PUBLIC_SUPABASE_URL!,
    process.env.NEXT_PUBLIC_SUPABASE_ANON_KEY!
  );
  const { data, error } = await supabase
    .from('services')
    .select('*')
    .eq('slug', slug)
    .single();

  if (error || !data) {
    return null;
  }

  return mapToService(data);
}

export async function getAllPublishedServiceSlugs(): Promise<{ slug: string }[]> {
    const supabase = createClient(
        process.env.NEXT_PUBLIC_SUPABASE_URL!,
        process.env.NEXT_PUBLIC_SUPABASE_ANON_KEY!
    );
    const { data, error } = await supabase
      .from('services')
      .select('slug')
      .eq('published', true);
  
    if (error) {
      console.error('Error fetching service slugs:', error);
      return [];
    }
  
    return data;
}
</file>

<file path="src/app/admin/blogs/[id]/edit/page.tsx">
import { supabase } from '@/lib/supabase/supabase';
import BlogForm from '../../BlogForm';
import { notFound } from 'next/navigation';
import { Card, CardContent, CardHeader, CardTitle, CardDescription } from '@/components/ui/card';
import type { BlogPost } from '@/lib/types';
import Link from 'next/link';
import { Button } from '@/components/ui/button';
import { ArrowLeft } from 'lucide-react';

export const metadata = {
    title: 'Edit Blog Post | Bilacert Admin Pro',
    description: 'Edit an existing blog post.',
};

async function getBlog(id: string): Promise<BlogPost | null> {
    const { data, error } = await supabase
        .from('blog_posts')
        .select('*')
        .eq('id', id)
        .single();

    if (error || !data) {
        return null;
    }

    return {
        id: data.id,
        title: data.title,
        slug: data.slug,
        excerpt: data.excerpt,
        content: data.content,
        category: data.category,
        tags: data.tags,
        read_time: data.read_time,
        seo_title: data.seo_title,
        seo_description: data.seo_description,
        seo_keywords: data.seo_keywords,
        featured_image: data.featured_image,
        thumbnail: data.thumbnail,
        published: data.published,
        published_at: data.published_at,
        featured: data.featured,
        author_id: data.author_id,
        author_name: data.author_name,
        views_count: data.views_count,
        createdAt: data.created_at,
        updatedAt: data.updated_at,
    } as BlogPost;
}


export default async function EditBlogPage({ params }: { params: Promise<{ id: string }> }) {
    const { id } = await params;
    const blog = await getBlog(id);

    if (!blog) {
        notFound();
    }

    return (
        <div className="space-y-6">
            <Button variant="outline" asChild>
                <Link href="/admin/blogs">
                    <ArrowLeft className="mr-2 h-4 w-4" />
                    Back to Blogs
                </Link>
            </Button>
            <Card>
                <CardHeader>
                    <CardTitle>Edit Blog Post</CardTitle>
                    <CardDescription>Update the details for "{blog.title}".</CardDescription>
                </CardHeader>
                <CardContent>
                    <BlogForm blog={blog} />
                </CardContent>
            </Card>
        </div>
    );
}
</file>

<file path="src/app/admin/blogs/[id]/page.tsx">
import { supabase } from '@/lib/supabase/supabase';
import BlogDetails from '../BlogDetails';
import { notFound } from 'next/navigation';
import type { BlogPost } from '@/lib/types';
import type { Metadata } from 'next';

async function getBlog(id: string): Promise<BlogPost | null> {
    const { data, error } = await supabase
        .from('blog_posts')
        .select('*')
        .eq('id', id)
        .single();

    if (error || !data) {
        return null;
    }

    return {
        id: data.id,
        title: data.title,
        slug: data.slug,
        excerpt: data.excerpt,
        content: data.content,
        category: data.category,
        tags: data.tags,
        read_time: data.read_time,
        seo_title: data.seo_title,
        seo_description: data.seo_description,
        seo_keywords: data.seo_keywords,
        featured_image: data.featured_image,
        thumbnail: data.thumbnail,
        published: data.published,
        published_at: data.published_at,
        featured: data.featured,
        author_id: data.author_id,
        author_name: data.author_name,
        views_count: data.views_count,
        createdAt: data.created_at,
        updatedAt: data.updated_at,
    } as BlogPost;
}

export async function generateMetadata({ params }: { params: { id: string } }): Promise<Metadata> {
    const blog = await getBlog(params.id);
    if (!blog) {
        return {
            title: 'Blog Post Not Found'
        }
    }
    return {
        title: `${blog.title} | Bilacert Admin Pro`,
    }
}

export default async function BlogDetailsPage({ params }: { params: Promise<{ id: string }> }) {
    const { id } = await params;
    const blog = await getBlog(id);

    if (!blog) {
        notFound();
    }

    return <BlogDetails blog={blog} />;
}
</file>

<file path="src/components/Footer.tsx">
import Link from 'next/link';
import { Phone, Mail, Clock } from 'lucide-react';
import { getPublishedServices } from '@/lib/supabase/services';
import Image from 'next/image';

export default async function Footer() {
	const currentYear = new Date().getFullYear();
    const services = await getPublishedServices();

	const quickLinks = [
		{ name: 'About Us', href: '/about' },
		{ name: 'Our Services', href: '/services' },
		{ name: 'Blog', href: '/blog' },
		{ name: 'FAQ', href: '/faq' },
		{ name: 'Contact', href: '/contact' },
	];

	return (
		<footer className='bg-primary text-primary-foreground'>
			<div className='max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-12'>
				<div className='grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-8'>
					{/* Company Info */}
					<div className='lg:col-span-1'>
						<Link href='/' className="flex items-center gap-2 font-bold text-xl mb-4 text-white">
                            <Image src="/logo.png" alt="Bilacert Logo" width={32} height={32} />
                            <span>Bilacert</span>
                        </Link>
						<p className='text-muted-foreground mb-6 text-primary-foreground/70'>
							Your trusted compliance partner, simplifying ICASA and NRCS approvals for South
							African businesses.
						</p>
						<div className='space-y-3'>
							<a href="tel:0754304433" className='flex items-center space-x-3 text-primary-foreground/70 hover:text-accent transition-colors'>
								<Phone className='h-5 w-5 text-accent' />
								<span>075 430 4433</span>
							</a>
							<a href="mailto:info@bilacert.co.za" className='flex items-center space-x-3 text-primary-foreground/70 hover:text-accent transition-colors'>
								<Mail className='h-5 w-5 text-accent' />
								<span>info@bilacert.co.za</span>
							</a>
							<div className='flex items-center space-x-3 text-primary-foreground/70'>
								<Clock className='h-5 w-5 text-accent' />
								<span>Mon - Fri: 8:00 - 16:30</span>
							</div>
						</div>
					</div>

					{/* Services */}
					<div>
						<h3 className='text-lg font-semibold mb-4'>Our Services</h3>
						<ul className='space-y-2'>
							{services.slice(0, 6).map((service) => (
								<li key={service.id}>
									<Link
										href={service.href}
										className='text-primary-foreground/70 hover:text-accent transition-colors duration-200'>
										{service.title}
									</Link>
								</li>
							))}
						</ul>
					</div>

					{/* Quick Links */}
					<div>
						<h3 className='text-lg font-semibold mb-4'>Quick Links</h3>
						<ul className='space-y-2'>
							{quickLinks.map((link) => (
								<li key={link.name}>
									<Link
										href={link.href}
										className='text-primary-foreground/70 hover:text-accent transition-colors duration-200'>
										{link.name}
									</Link>
								</li>
							))}
						</ul>
					</div>

					{/* Newsletter Signup */}
					<div>
						<h3 className='text-lg font-semibold mb-4'>Stay Updated</h3>
						<p className='text-primary-foreground/70 mb-4'>
							Subscribe to our newsletter for compliance updates and industry insights.
						</p>
						<form className='space-y-3'>
							<input
								type='email'
								placeholder='Enter your email'
								className='w-full px-4 py-2 rounded-lg bg-primary-foreground/5 border border-primary-foreground/20 text-primary-foreground placeholder:text-muted-foreground focus:outline-none focus:border-accent'
							/>
							<button
								type='submit'
								className='w-full bg-accent text-accent-foreground px-4 py-2 rounded-lg font-medium hover:bg-accent/90 transition-colors duration-200'>
								Subscribe
							</button>
						</form>
					</div>
				</div>

				{/* Bottom Bar */}
				<div className='border-t border-primary-foreground/20 mt-8 pt-8'>
					<div className='flex flex-col md:flex-row justify-between items-center'>
						<p className='text-primary-foreground/70 text-sm'>
							 {currentYear} Bilacert (Pty) Ltd. All rights reserved.
						</p>
						<div className='flex space-x-6 mt-4 md:mt-0'>
							<Link
								href='#'
								className='text-primary-foreground/70 hover:text-accent text-sm transition-colors duration-200'>
								Privacy Policy
							</Link>
							<Link
								href='#'
								className='text-primary-foreground/70 hover:text-accent text-sm transition-colors duration-200'>
								Terms of Service
							</Link>
                            <Link
                                href='/admin/login'
                                className='text-primary-foreground/70 hover:text-accent text-sm transition-colors duration-200'>
                                Admin
                            </Link>
						</div>
					</div>
				</div>
			</div>
		</footer>
	);
}
</file>

<file path="src/app/blog/page.tsx">
import type { Metadata } from 'next';
import Link from 'next/link';
import { Calendar, ArrowRight, User } from 'lucide-react';
import Image from 'next/image';
import { getPublishedBlogPosts } from '@/lib/supabase/blog';
import type { BlogPost } from '@/lib/types';
import { format } from 'date-fns';

export const metadata: Metadata = {
	title: 'Blog',
	description:
		'Stay updated with the latest ICASA and NRCS compliance news, guides, and insights. Expert articles on type approvals, licensing, and regulatory changes in South Africa.',
	keywords: [
		'ICASA compliance blog',
		'NRCS LOA news',
		'compliance articles South Africa',
		'type approval guides',
		'licensing updates',
		'regulatory compliance news',
		'ICASA NRCS insights',
	],
	openGraph: {
		title: 'Blog - ICASA & NRCS Compliance Insights',
		description:
			'Stay updated with the latest ICASA and NRCS compliance news, guides, and insights. Expert articles on type approvals, licensing, and regulatory changes in South Africa.',
		url: 'https://bilacert.co.za/blog',
		type: 'website',
	},
	alternates: {
		canonical: 'https://bilacert.co.za/blog',
	},
};

export default async function BlogPage() {
	const categories = [
		'All',
		'ICASA Approvals',
		'NRCS Compliance',
		'Licensing',
		'Telecom Licensing',
		'Business Strategy',
		'Marine Compliance',
	];

    const blogPosts = await getPublishedBlogPosts();

	if (blogPosts.length === 0) {
		return <div className="min-h-screen text-center py-20">No blog posts found.</div>;
	}
    
    const featuredPost = blogPosts[0];
    const otherPosts = blogPosts.slice(1);

	return (
		<div className='min-h-screen'>
			{/* Hero Section */}
			<section className='relative text-white py-20'>
				<Image
					src="https://picsum.photos/seed/blog/1920/1080"
                    data-ai-hint="library books"
					alt='Compliance Insights & Updates'
					fill
					priority
					className='object-cover'
				/>
				<div className='absolute inset-0 bg-black/40' />
				<div className='relative max-w-7xl mx-auto px-4 sm:px-6 lg:px-8'>
					<div className='text-center'>
						<h1 className='text-4xl lg:text-5xl font-bold mb-6'>Compliance Insights & Updates</h1>
						<p className='text-xl lg:text-2xl text-gray-200 max-w-4xl mx-auto'>
							Stay informed with the latest compliance news, regulatory updates, and expert insights
							to keep your business ahead of the curve.
						</p>
					</div>
				</div>
			</section>

			{/* Featured Post */}
			<section className='py-16 bg-secondary-gray'>
				<div className='max-w-7xl mx-auto px-4 sm:px-6 lg:px-8'>
					<div className='bg-card rounded-2xl shadow-lg overflow-hidden'>
						<div className='grid grid-cols-1 lg:grid-cols-2 gap-0'>
							<div className='bg-gradient-to-br from-primary to-primary/80 p-8 lg:p-12 flex items-center'>
								<div>
									<div className='inline-block bg-accent text-accent-foreground px-3 py-1 rounded-full text-sm font-medium mb-4'>
										Featured Article
									</div>
									<h2 className='text-3xl lg:text-4xl font-bold text-white mb-4'>
										{featuredPost.title}
									</h2>
									<p className='text-xl text-gray-200 mb-6'>{featuredPost.excerpt}</p>
									<div className='flex items-center space-x-4 text-gray-200 mb-6'>
										<div className='flex items-center space-x-2'>
											<User className='h-4 w-4' />
											<span>{featuredPost.author_name || 'Bilacert Team'}</span>
										</div>
										<div className='flex items-center space-x-2'>
											<Calendar className='h-4 w-4' />
											<span>
												{format(new Date(featuredPost.createdAt), 'PP')}
											</span>
										</div>
										<span>{featuredPost.read_time}</span>
									</div>
									<Link
										href={`/blog/${featuredPost.slug}`}
										className='inline-flex items-center bg-accent text-accent-foreground px-6 py-3 rounded-lg font-semibold hover:bg-accent/90 transition-colors duration-200'>
										Read Article
										<ArrowRight className='h-4 w-4 ml-2' />
									</Link>
								</div>
							</div>
							<div className='relative min-h-[300px] lg:min-h-0'>
								<Image
									src={featuredPost.featured_image || `https://picsum.photos/seed/${featuredPost.id}/800/600`}
									alt={featuredPost.title}
									fill
									className='object-cover'
								/>
							</div>
						</div>
					</div>
				</div>
			</section>

			{/* Blog Posts Grid */}
			<section className='py-20'>
				<div className='max-w-7xl mx-auto px-4 sm:px-6 lg:px-8'>
					<div className='text-center mb-16'>
						<h2 className='text-3xl lg:text-4xl font-bold text-primary mb-4'>Latest Articles</h2>
						<p className='text-xl text-gray-600 max-w-3xl mx-auto'>
							Expert insights and practical guidance to help you navigate South African compliance
							requirements
						</p>
					</div>

					{/* Category Filter - Non-functional for now */}
					<div className='flex flex-wrap justify-center gap-4 mb-12'>
						{categories.map((category) => (
							<button
								key={category}
								className='px-6 py-2 rounded-full border border-border text-foreground hover:bg-primary hover:text-primary-foreground hover:border-primary transition-colors duration-200'>
								{category}
							</button>
						))}
					</div>

					{/* Posts Grid */}
					<div className='grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-8'>
						{otherPosts.map((post: BlogPost) => (
							<Link
								key={post.id}
								href={`/blog/${post.slug}`}
								className='bg-card rounded-xl shadow-sm hover:shadow-lg transition-all duration-300 transform hover:-translate-y-2 overflow-hidden flex flex-col'>
								<div className='relative h-48 bg-gray-200 flex items-center justify-center overflow-hidden'>
									<Image
										src={post.featured_image || `https://picsum.photos/seed/${post.id}/600/400`}
										alt={post.title}
										fill
										style={{ objectFit: 'cover' }}
										className='transition-transform duration-300 group-hover:scale-105'
									/>
								</div>
								<div className='p-6 flex flex-col flex-grow'>
									<div className='flex items-center justify-between mb-3'>
										<span className='bg-accent/10 text-accent px-3 py-1 rounded-full text-sm font-medium'>
											{post.category}
										</span>
									</div>
									<h3 className='text-xl font-semibold text-primary mb-3 line-clamp-2'>
										{post.title}
									</h3>
									<p className='text-muted-foreground mb-4 line-clamp-3 flex-grow'>{post.excerpt}</p>
									<div className='flex items-center justify-between text-sm text-muted-foreground mt-auto'>
										<div className='flex items-center space-x-2'>
											<User className='h-4 w-4' />
											<span>{post.author_name || 'Bilacert Team'}</span>
										</div>
										<div className='flex items-center space-x-2'>
											<Calendar className='h-4 w-4' />
											<span>
												{format(new Date(post.createdAt), 'dd MMM, yyyy')}
											</span>
										</div>
									</div>
								</div>
							</Link>
						))}
					</div>
				</div>
			</section>
		</div>
	);
}
</file>

<file path="src/app/services/page.tsx">
import type { Metadata } from 'next';
import Link from 'next/link';
import { ArrowRight, CheckCircle } from 'lucide-react';
import { getPublishedServices } from '@/lib/supabase/services';
import Icon from '@/components/Icon';
import { Button } from '@/components/ui/button';
import Image from 'next/image';

export const metadata: Metadata = {
	title: 'Our Services - Bilacert',
	description:
		'Comprehensive licensing and certification services for South African businesses. ICASA type approvals, NRCS LOA, radio dealer licensing, and more.',
	keywords: [
		'ICASA licensing',
		'NRCS certification',
		'radio licensing',
		'VHF licensing',
		'ECS ECNS licensing',
		'license exemptions',
		'compliance services South Africa',
	],
	openGraph: {
		title: 'Services - Bilacert',
		description:
			'Comprehensive licensing and certification services for South African businesses.',
		url: 'https://bilacert.co.za/services',
		type: 'website',
	},
	alternates: {
		canonical: 'https://bilacert.co.za/services',
	},
};

export default async function ServicesPage() {
	const services = await getPublishedServices();

	return (
		<div className='min-h-screen'>
			{/* Hero Section */}
			<section className='relative text-white py-20'>
				<Image
					src="https://picsum.photos/seed/services/1920/1080"
                    data-ai-hint="compliance document"
					alt='Bilacert Services'
					fill
					priority
					className='object-cover'
				/>
				<div className='absolute inset-0 bg-black/40' />
				<div className='relative max-w-7xl mx-auto px-4 sm:px-6 lg:px-8'>
					<div className='max-w-3xl'>
						<h1 className='text-4xl lg:text-5xl font-bold mb-6'>Our Services</h1>
						<p className='text-xl text-gray-200 mb-8'>
							Comprehensive licensing and certification services to help your business stay compliant and
							competitive in South Africa's regulated industries.
						</p>
					</div>
				</div>
			</section>

			{/* Services Grid */}
			<section className='py-20'>
				<div className='max-w-7xl mx-auto px-4 sm:px-6 lg:px-8'>
					<div className='grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-8 items-stretch'>
						{services.map((service) => (
							<Link key={service.id} href={service.href} className="group block h-full">
                                <div className="flex h-full flex-col rounded-xl border bg-card p-6 shadow-sm transition-all duration-300 hover:border-primary/30 hover:shadow-xl">
                                    <div className="mb-4 flex-shrink-0 text-accent">
                                        <Icon name={service.icon || 'Shield'} className="h-8 w-8" />
                                    </div>
                                    <div className="flex flex-grow flex-col">
                                        <h3 className="text-xl font-bold text-primary mb-2">
                                            {service.title}
                                        </h3>
                                        <p className="mb-4 text-sm text-muted-foreground flex-grow">
                                            {service.description}
                                        </p>
                                        {service.includes && service.includes.length > 0 && (
                                            <div className="mb-4">
                                                <h4 className="mb-2 text-sm font-semibold text-card-foreground">Includes:</h4>
                                                <ul className="space-y-2 text-sm text-muted-foreground">
                                                    {service.includes.slice(0, 4).map((item: string, index: number) => (
                                                        <li key={index} className="flex items-center gap-2">
                                                            <CheckCircle className="h-4 w-4 text-accent" />
                                                            <span>{item}</span>
                                                        </li>
                                                    ))}
                                                </ul>
                                            </div>
                                        )}
                                    </div>
                                    <div className="mt-auto pt-6">
                                        {service.pricing && (
                                            <p className="mb-4 text-lg font-semibold text-primary">
                                                From R{service.pricing.toLocaleString('en-ZA', { minimumFractionDigits: 0, maximumFractionDigits: 0 })}
                                            </p>
                                        )}
                                        <Button className="w-full bg-primary hover:bg-primary/90">
                                            Learn More
                                            <ArrowRight className="ml-2 h-4 w-4" />
                                        </Button>
                                    </div>
                                </div>
                            </Link>
						))}
					</div>
				</div>
			</section>

			{/* CTA Section */}
			<section className='py-20 bg-secondary-gray'>
				<div className='max-w-4xl mx-auto px-4 sm:px-6 lg:px-8 text-center'>
					<h2 className='text-3xl lg:text-4xl font-bold text-primary mb-6'>
						Don't see what you need?
					</h2>
					<p className='text-xl text-gray-600 mb-8'>
						Contact us today to discuss your specific licensing and certification needs.
					</p>
					<div className='flex flex-col sm:flex-row gap-4 justify-center'>
						<Button size="lg" asChild>
							<Link href='/contact'>Get in Touch</Link>
						</Button>
						<Button size="lg" variant="outline" asChild>
							<a href='tel:0754304433'>Call 075 430 4433</a>
						</Button>
					</div>
				</div>
			</section>
		</div>
	);
}
</file>

<file path="src/app/admin/services/ServicesClient.tsx">
'use client';

import { useState } from 'react';
import { useServices } from '@/hooks/useServices';
import { Service } from '@/lib/types';
import { Button } from '@/components/ui/button';
import { PlusCircle, MoreHorizontal } from 'lucide-react';
import DeleteServiceDialog from './DeleteServiceDialog';
import Link from 'next/link';
import { useRouter } from 'next/navigation';
import { Card, CardContent, CardDescription, CardFooter, CardHeader, CardTitle } from '@/components/ui/card';
import { Badge } from '@/components/ui/badge';
import {
    DropdownMenu,
    DropdownMenuContent,
    DropdownMenuItem,
    DropdownMenuLabel,
    DropdownMenuSeparator,
    DropdownMenuTrigger,
} from '@/components/ui/dropdown-menu';
import ServicesLoading from './loading';

export default function ServicesClient() {
  const { services, loading, error } = useServices();
  const router = useRouter();
  const [isDeleteDialogOpen, setIsDeleteDialogOpen] = useState(false);
  const [selectedService, setSelectedService] = useState<Service | null>(null);

  const handleDelete = (service: Service) => {
    setSelectedService(service);
    setIsDeleteDialogOpen(true);
  };

  const handleEdit = (service: Service) => {
    router.push(`/admin/services/${service.id}/edit`);
  };

  const handleCloseDialogs = () => {
    setIsDeleteDialogOpen(false);
    setSelectedService(null);
  };
  
  const onDeleted = () => {
      handleCloseDialogs();
      router.refresh();
  }

  if (error) {
    return <div className="text-destructive">Error loading services: {error.message}</div>;
  }

  return (
    <>
      <div className="flex items-center justify-between">
        <div>
            <h1 className="text-3xl font-bold tracking-tight">Services</h1>
        </div>
        <Button asChild>
            <Link href="/admin/services/new">
                <PlusCircle className="mr-2 h-4 w-4" />
                Add Service
            </Link>
        </Button>
      </div>

      <div className="mt-6">
        {loading ? <ServicesLoading /> : services.length === 0 ? (
            <div className="flex flex-col items-center justify-center rounded-lg border-2 border-dashed border-muted-foreground/30 py-24 text-center">
                <h3 className="text-lg font-semibold tracking-tight">No Services Yet</h3>
                <p className="text-sm text-muted-foreground">Click "Add Service" to get started.</p>
            </div>
        ) : (
          <div className="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6">
            {services.map((service) => (
                <div key={service.id} className="group relative">
                    <Link href={`/admin/services/${service.id}`} className="absolute inset-0 z-10" aria-label={`View ${service.title}`}>
                        <span className="sr-only">View Details</span>
                    </Link>
                    <Card className="flex h-full flex-col transition-all duration-300 group-hover:shadow-lg group-hover:border-primary/50">
                        <CardHeader>
                            <div className="flex justify-between items-start">
                                <CardTitle className="text-lg line-clamp-2">{service.title}</CardTitle>
                                <div className="relative z-20">
                                    <DropdownMenu>
                                        <DropdownMenuTrigger asChild>
                                            <Button variant="ghost" className="h-8 w-8 p-0" onClick={(e) => e.preventDefault()}>
                                                <span className="sr-only">Open menu</span>
                                                <MoreHorizontal className="h-4 w-4" />
                                            </Button>
                                        </DropdownMenuTrigger>
                                        <DropdownMenuContent align="end">
                                            <DropdownMenuLabel>Actions</DropdownMenuLabel>
                                            <DropdownMenuItem onClick={(e) => { e.preventDefault(); router.push(`/admin/services/${service.id}`) }}>View Details</DropdownMenuItem>
                                            <DropdownMenuItem onClick={(e) => { e.preventDefault(); handleEdit(service); }}>Edit</DropdownMenuItem>
                                            <DropdownMenuSeparator />
                                            <DropdownMenuItem
                                                className="text-destructive focus:bg-destructive/10 focus:text-destructive"
                                                onClick={(e) => { e.preventDefault(); handleDelete(service); }}
                                            >
                                                Delete
                                            </DropdownMenuItem>
                                        </DropdownMenuContent>
                                    </DropdownMenu>
                                </div>
                            </div>
                        <CardDescription>{service.category}</CardDescription>
                        </CardHeader>
                        <CardContent className="space-y-4 flex-grow">
                        <div className="flex flex-wrap gap-2">
                            <Badge variant={service.published ? "default" : "secondary"}>
                            {service.published ? 'Published' : 'Draft'}
                            </Badge>
                            {service.featured && <Badge variant="outline">Featured</Badge>}
                        </div>
                        <p className="text-sm text-muted-foreground line-clamp-3">{service.short_description}</p>
                        </CardContent>
                        <CardFooter>
                           <p className="text-lg font-semibold">{service.pricing ? `R ${service.pricing.toLocaleString()}`: 'Not Set'}</p>
                        </CardFooter>
                    </Card>
                </div>
            ))}
          </div>
        )}
      </div>
      
      {isDeleteDialogOpen && (
        <DeleteServiceDialog
            isOpen={isDeleteDialogOpen}
            onClose={handleCloseDialogs}
            service={selectedService}
            onDeleted={onDeleted}
        />
      )}
    </>
  );
}
</file>

<file path="src/app/blog/[slug]/page.tsx">
import { notFound } from 'next/navigation';
import Link from 'next/link';
import { Calendar, User, ArrowLeft, Share2, Clock } from 'lucide-react';
import { getBlogPostBySlug, getAllPublishedBlogSlugs } from '@/lib/supabase/blog';
import { format } from 'date-fns';
import { Button } from '@/components/ui/button';
import Image from 'next/image';
import type { Metadata } from 'next';

interface BlogPostPageProps {
  params: { slug: string };
}

export async function generateMetadata({ params }: BlogPostPageProps): Promise<Metadata> {
  const post = await getBlogPostBySlug(params.slug);

  if (!post) {
    return {
      title: 'Blog Post Not Found'
    }
  }
  
  const siteUrl = process.env.NEXT_PUBLIC_SITE_URL || 'http://localhost:3000';

  return {
    title: post.title,
    description: post.excerpt,
    openGraph: {
      title: post.title,
      description: post.excerpt,
      url: `${siteUrl}/blog/${post.slug}`,
      type: 'article',
      publishedTime: post.createdAt,
      images: post.featured_image ? [{ url: post.featured_image }] : [],
    },
  };
}


export async function generateStaticParams() {
    const slugs = await getAllPublishedBlogSlugs();
    return slugs;
}

export default async function BlogPostPage({ params }: { params: Promise<{ slug: string }> }) {
  const { slug } = await params;
  
  const post = await getBlogPostBySlug(slug);

  if (!post) {
    notFound();
  }

  return (
    <div className="min-h-screen">
      <div className="bg-card border-b">
        <div className="max-w-4xl mx-auto px-4 sm:px-6 lg:px-8 py-4">
          <Button variant="ghost" asChild>
            <Link href="/blog">
              <ArrowLeft className="mr-2 h-4 w-4" />
              Back to Blog
            </Link>
          </Button>
        </div>
      </div>

      <section className="py-12 bg-secondary">
        <div className="max-w-4xl mx-auto px-4 sm:px-6 lg:px-8">
          <div className="text-center">
            {post.category && (
              <div className="inline-block bg-accent text-accent-foreground px-4 py-2 rounded-full text-sm font-medium mb-4">
                {post.category}
              </div>
            )}
            <h1 className="text-4xl lg:text-5xl font-bold text-primary mb-6">
              {post.title}
            </h1>
            {post.excerpt && (
                <p className="text-xl text-muted-foreground mb-8 max-w-3xl mx-auto">
                    {post.excerpt}
                </p>
            )}
            <div className="flex items-center justify-center space-x-6 text-muted-foreground">
              {post.author_name && 
                <div className="flex items-center space-x-2">
                  <User className="h-5 w-5" />
                  <span>{post.author_name}</span>
                </div>
              }
              <div className="flex items-center space-x-2">
                <Calendar className="h-5 w-5" />
                <span>
                  {format(new Date(post.createdAt), 'PP')}
                </span>
              </div>
              {post.read_time && 
                <div className="flex items-center space-x-2">
                  <Clock className="h-5 w-5" />
                  <span>{post.read_time}</span>
                </div>
              }
            </div>
          </div>
        </div>
      </section>

      {post.featured_image && (
        <div className="relative h-64 md:h-96 max-w-5xl mx-auto my-8 rounded-lg overflow-hidden">
            <Image src={post.featured_image} alt={post.title} fill className="object-cover" />
        </div>
      )}

      <section className="py-12">
        <div className="max-w-4xl mx-auto px-4 sm:px-6 lg:px-8">
          <div className="bg-card rounded-xl shadow-sm p-8 lg:p-12">
            {/* 
              NOTE: Using dangerouslySetInnerHTML can be a security risk if the content is not properly sanitized.
              In a real-world application, you would want to use a library like DOMPurify to sanitize the HTML before rendering it.
            */}
            <div
              className="prose prose-lg max-w-none dark:prose-invert"
              dangerouslySetInnerHTML={{ __html: post.content || '' }}
            />
          </div>
        </div>
      </section>

      <section className="py-12 bg-secondary">
        <div className="max-w-4xl mx-auto px-4 sm:px-6 lg:px-8">
          <div className="bg-card rounded-xl shadow-sm p-8 text-center">
            <h3 className="text-2xl font-bold text-primary mb-4">Found this helpful?</h3>
            <div className="flex justify-center space-x-4 mb-8">
              <Button>
                <Share2 className="mr-2 h-4 w-4" />
                Share
              </Button>
            </div>
            <div className="border-t pt-8">
              <Button asChild size="lg">
                <Link href="/contact">
                    Get Free Consultation
                </Link>
              </Button>
            </div>
          </div>
        </div>
      </section>
    </div>
  );
}
</file>

<file path="src/app/admin/testimonials/TestimonialForm.tsx">
'use client';

import { useForm } from 'react-hook-form';
import { zodResolver } from '@hookform/resolvers/zod';
import { Button } from '@/components/ui/button';
import {
  Form,
  FormControl,
  FormField,
  FormItem,
  FormLabel,
  FormMessage,
} from '@/components/ui/form';
import { Input } from '@/components/ui/input';
import { useToast } from '@/hooks/use-toast';
import type { Testimonial } from '@/lib/types';
import { useEffect } from 'react';
import { Loader2 } from 'lucide-react';
import { useRouter } from 'next/navigation';
import Link from 'next/link';
import { testimonialSchema } from './schema';
import { upsertTestimonial } from './actions';

type TestimonialFormValues = Zod.infer<typeof testimonialSchema>;

interface TestimonialFormProps {
  testimonial?: Testimonial | null;
}

export default function TestimonialForm({ testimonial }: TestimonialFormProps) {
  const { toast } = useToast();
  const router = useRouter();
  const isEditing = !!testimonial;
  
  const form = useForm<TestimonialFormValues>({
    resolver: zodResolver(testimonialSchema),
    defaultValues: {
      postUrl: '',
    },
  });

  const { handleSubmit, reset, formState: { isSubmitting } } = form;

  useEffect(() => {
    if (testimonial) {
      reset({
        postUrl: testimonial.postUrl,
      });
    } else {
      reset({
        postUrl: '',
      });
    }
  }, [testimonial, reset]);

  const onSubmit = async (values: TestimonialFormValues) => {
    try {

      const result = await upsertTestimonial(values, testimonial?.id);

      if (result.error) {
        throw new Error(result.error);
      }

      toast({
        title: result.message,
      });
      router.push('/admin/testimonials');
      router.refresh();

    } catch (error: any) {
      toast({
        variant: 'destructive',
        title: 'Error saving testimonial',
        description: error.message,
      });
    }
  };

  return (
    <Form {...form}>
      <form onSubmit={handleSubmit(onSubmit)} className="space-y-6">
        <FormField
          control={form.control}
          name="postUrl"
          render={({ field }) => (
            <FormItem>
              <FormLabel>Facebook Post URL</FormLabel>
              <FormControl>
                <Input placeholder="https://www.facebook.com/..." {...field} />
              </FormControl>
              <FormMessage />
            </FormItem>
          )}
        />
        <div className="flex justify-end gap-4">
          <Button type="button" variant="outline" asChild>
            <Link href="/admin/testimonials">Cancel</Link>
          </Button>
          <Button type="submit" disabled={isSubmitting}>
            {isSubmitting && <Loader2 className="mr-2 h-4 w-4 animate-spin" />}
            {isEditing ? 'Save Changes' : 'Add Testimonial'}
          </Button>
        </div>
      </form>
    </Form>
  );
}
</file>

<file path="src/app/contact/ContactForm.tsx">
'use client';

import { useState } from 'react';
import Image from 'next/image';
import { Phone, Mail, Clock, Send, CheckCircle, AlertCircle } from 'lucide-react';
import { useFormSubmission } from '@/hooks/useFormSubmission';
import { Button } from '@/components/ui/button';

export default function ContactForm() {
	const [formData, setFormData] = useState({
		name: '',
		email: '',
		phone: '',
		service: '',
		message: '',
	});

	const { isLoading, error, isSuccess, successMessage, handleSubmit, reset } =
		useFormSubmission();

	const onSubmit = async (e: React.FormEvent) => {
		e.preventDefault();

		const result = await handleSubmit({
			formType: 'contact',
			fullName: formData.name,
			email: formData.email,
			phone: formData.phone || undefined,
			message: formData.message,
		});

		if (result?.success) {
			setFormData({
				name: '',
				email: '',
				phone: '',
				service: '',
				message: '',
			});
			setTimeout(reset, 5000);
		}
	};

	const handleChange = (
		e: React.ChangeEvent<HTMLInputElement | HTMLTextAreaElement | HTMLSelectElement>
	) => {
		setFormData({
			...formData,
			[e.target.name]: e.target.value,
		});
	};

	return (
		<div className='min-h-screen'>
			{/* Hero Section */}
			<section className='relative text-white py-20'>
				<Image
					src="https://picsum.photos/seed/contact/1920/1080"
                    data-ai-hint="contact us"
					alt='Get in touch'
					fill
					priority
					className='object-cover'
				/>
				<div className='absolute inset-0 bg-black/40' />
				<div className='relative max-w-7xl mx-auto px-4 sm:px-6 lg:px-8'>
					<div className='text-center'>
						<h1 className='text-4xl lg:text-5xl font-bold mb-6'>Get in Touch</h1>
						<p className='text-xl text-gray-200 max-w-3xl mx-auto'>
							Ready to simplify your compliance journey? Contact our experts for a free consultation
							and discover how we can help your business navigate ICASA and NRCS requirements.
						</p>
					</div>
				</div>
			</section>

			{/* Contact Information */}
			<section className='py-20'>
				<div className='max-w-7xl mx-auto px-4 sm:px-6 lg:px-8'>
					<div className='grid grid-cols-1 lg:grid-cols-3 gap-8 mb-16'>
						<div className='text-center'>
							<div className='bg-accent/10 w-16 h-16 rounded-full flex items-center justify-center mx-auto mb-4'>
								<Phone className='h-8 w-8 text-accent' />
							</div>
							<h3 className='text-xl font-semibold text-primary mb-2'>Phone</h3>
							<p className='text-gray-600 mb-2'>075 430 4433</p>
							<p className='text-sm text-gray-500'>Mon-Fri 08:00 - 16:30</p>
						</div>

						<div className='text-center'>
							<div className='bg-accent/10 w-16 h-16 rounded-full flex items-center justify-center mx-auto mb-4'>
								<Mail className='h-8 w-8 text-accent' />
							</div>
							<h3 className='text-xl font-semibold text-primary mb-2'>Email</h3>
							<p className='text-gray-600 mb-2'>info@bilacert.co.za</p>
							<p className='text-sm text-gray-500'>We&apos;ll respond within 24 hours</p>
						</div>

						<div className='text-center'>
							<div className='bg-accent/10 w-16 h-16 rounded-full flex items-center justify-center mx-auto mb-4'>
								<Clock className='h-8 w-8 text-accent' />
							</div>
							<h3 className='text-xl font-semibold text-primary mb-2'>Business Hours</h3>
							<p className='text-gray-600 mb-2'>Monday - Friday</p>
							<p className='text-sm text-gray-500'>08:00 - 16:30</p>
						</div>
					</div>

					<div className='max-w-2xl mx-auto'>
						<div className='bg-white p-8 rounded-xl shadow-sm'>
							<h2 className='text-2xl font-bold text-primary mb-6 text-center'>
								Send us a Message
							</h2>

							{isSuccess && successMessage && (
								<div className='bg-green-50 border border-green-200 rounded-lg p-4 mb-6'>
									<div className='flex items-center'>
										<CheckCircle className='h-5 w-5 text-green-500 mr-2' />
										<p className='text-green-700'>{successMessage}</p>
									</div>
								</div>
							)}

							{error && (
								<div className='bg-red-50 border border-red-200 rounded-lg p-4 mb-6'>
									<div className='flex items-center'>
										<AlertCircle className='h-5 w-5 text-red-500 mr-2' />
										<p className='text-red-700'>{error}</p>
									</div>
								</div>
							)}

							<form
								onSubmit={onSubmit}
								className='space-y-6'>
								<div className='grid grid-cols-1 md:grid-cols-2 gap-6'>
									<div>
										<label
											htmlFor='name'
											className='block text-sm font-medium text-gray-700 mb-2'>
											Full Name *
										</label>
										<input
											type='text'
											id='name'
											name='name'
											required
											value={formData.name}
											onChange={handleChange}
											className='w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-accent focus:border-transparent'
											placeholder='Your full name'
										/>
									</div>

									<div>
										<label
											htmlFor='email'
											className='block text-sm font-medium text-gray-700 mb-2'>
											Email Address *
										</label>
										<input
											type='email'
											id='email'
											name='email'
											required
											value={formData.email}
											onChange={handleChange}
											className='w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-accent focus:border-transparent'
											placeholder='your.email@example.com'
										/>
									</div>
								</div>

								<div className='grid grid-cols-1 md:grid-cols-2 gap-6'>
									<div>
										<label
											htmlFor='phone'
											className='block text-sm font-medium text-gray-700 mb-2'>
											Phone Number
										</label>
										<input
											type='tel'
											id='phone'
											name='phone'
											value={formData.phone}
											onChange={handleChange}
											className='w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-accent focus:border-transparent'
											placeholder='+27 XX XXX XXXX'
										/>
									</div>

									<div>
										<label
											htmlFor='service'
											className='block text-sm font-medium text-gray-700 mb-2'>
											Service Interest
										</label>
										<select
											id='service'
											name='service'
											value={formData.service}
											onChange={handleChange}
											className='w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-accent focus:border-transparent'>
											<option value=''>Select a service</option>
											<option value='icasa-type-approvals'>ICASA Type Approvals</option>
											<option value='nrcs-loa-applications'>NRCS LOA Applications</option>
											<option value='radio-dealer-licensing'>Radio Dealer Licensing</option>
											<option value='class-ecs-ecns-licensing'>Class ECS/ECNS Licensing</option>
											<option value='license-exemptions'>License Exemptions</option>
											<option value='ski-boat-vhf-licensing'>Ski Boat VHF Licensing</option>
											<option value='general-inquiry'>General Inquiry</option>
										</select>
									</div>
								</div>

								<div>
									<label
										htmlFor='message'
										className='block text-sm font-medium text-gray-700 mb-2'>
										Message *
									</label>
									<textarea
										id='message'
										name='message'
										required
										rows={6}
										value={formData.message}
											onChange={handleChange}
										className='w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-accent focus:border-transparent'
										placeholder='Tell us about your compliance needs...'
									/>
								</div>
								 <button
									type='submit'
									disabled={isLoading}
									className='w-full bg-primary text-white py-4 px-6 rounded-lg font-semibold text-lg hover:bg-primary/90 transition-colors duration-200 disabled:opacity-50 disabled:cursor-not-allowed flex items-center justify-center'>
									{isLoading ? (
										'Sending...'
									) : (
										<><Send className='h-5 w-5 mr-2' />Send Message</>
									)}
								</button>
							</form>
						</div>
					</div>
				</div>
			</section>

			{/* CTA Section */}
			<section className='py-20 bg-secondary-gray'>
				<div className='max-w-4xl mx-auto px-4 sm:px-6 lg:px-8 text-center'>
					<h2 className='text-3xl font-bold text-primary mb-6'>Need Immediate Assistance?</h2>
					<p className='text-xl text-gray-600 mb-8'>
						For urgent compliance matters, call us directly at 075 430 4433 or reach out via
						WhatsApp for instant support.
					</p>
					<div className='flex flex-col sm:flex-row gap-4 justify-center'>
						<Button asChild size="lg">
							<a href='tel:0754304433'>Call Now</a>
						</Button>
						<Button asChild variant="outline" size="lg">
							<a
								href='https://wa.me/27754304433'
								target='_blank'
								rel='noopener noreferrer'
								>
								WhatsApp Us
							</a>
						</Button>
					</div>
				</div>
			</section>
		</div>
	);
}
</file>

<file path="src/app/services/[slug]/page.tsx">
import type { Metadata } from 'next';
import { notFound } from 'next/navigation';
import { getServiceBySlug, getAllPublishedServiceSlugs } from '@/lib/supabase/services';
import Image from 'next/image';
import Link from 'next/link';
import { Button } from '@/components/ui/button';
import { CheckCircle, ArrowLeft } from 'lucide-react';
import Icon from '@/components/Icon';
import { Card, CardContent, CardDescription, CardHeader, CardTitle } from '@/components/ui/card';
import type { PricingPlan, ProcessStep, SuccessStory } from '@/lib/types';
import { Badge } from '@/components/ui/badge';

interface ServicePageProps {
	params: { slug: string };
}

export async function generateMetadata({ params }: { params: { slug: string } }): Promise<Metadata> {
	const service = await getServiceBySlug(params.slug);

	if (!service) {
		return {
			title: 'Service Not Found'
		}
	}
    
    const siteUrl = process.env.NEXT_PUBLIC_SITE_URL || 'http://localhost:3000';

	return {
		title: service.seo_title || service.title,
		description: service.seo_description || service.description,
		keywords: service.seo_keywords ? service.seo_keywords.split(',') : [service.title, service.category],
		openGraph: {
			title: service.seo_title || service.title,
			description: service.seo_description || service.description,
			url: `${siteUrl}${service.href}`,
			type: 'website',
			images: service.image ? [{ url: service.image }] : [],
		},
		alternates: {
			canonical: `${siteUrl}${service.href}`,
		},
	};
}

export async function generateStaticParams() {
	const slugs = await getAllPublishedServiceSlugs();
	return slugs;
}


const renderPricingPlans = (plans: PricingPlan[] | undefined, formPath: string) => {
    if (!plans || plans.length === 0) return null;
    return (
        <section className='py-20'>
            <div className='max-w-7xl mx-auto px-4 sm:px-6 lg:px-8'>
                <div className='text-center mb-16'>
                    <h2 className='text-3xl lg:text-4xl font-bold text-primary mb-4'>Pricing Plans</h2>
                    <p className='text-xl text-gray-600 max-w-3xl mx-auto'>
                        Flexible plans to suit businesses of all sizes
                    </p>
                </div>
                <div className='grid grid-cols-1 md:grid-cols-3 gap-8'>
                    {plans.map((plan, index) => (
                        <Card key={index} className={`flex flex-col ${plan.popular ? 'border-accent ring-2 ring-accent' : ''}`}>
                            <CardHeader>
                                {plan.popular && <Badge className="absolute -top-3 right-4">Most Popular</Badge>}
                                <CardTitle>{plan.title}</CardTitle>
                                <CardDescription>{plan.description}</CardDescription>
                            </CardHeader>
                            <CardContent className="flex-grow flex flex-col">
                                <p className="text-4xl font-bold mb-6">{plan.price}</p>
                                <ul className="space-y-3 mb-8 flex-grow">
                                    {Array.isArray(plan.features) && plan.features.map((feature, i) => (
                                        <li key={i} className="flex items-start">
                                            <CheckCircle className="h-5 w-5 text-green-500 mr-2 mt-1 shrink-0" />
                                            <span>{feature}</span>
                                        </li>
                                    ))}
                                </ul>
                                <Button asChild className="w-full mt-auto" variant={plan.popular ? 'default' : 'secondary'}>
                                    <Link href={formPath || '/contact'}>Get Started</Link>
                                </Button>
                            </CardContent>
                        </Card>
                    ))}
                </div>
            </div>
        </section>
    )
};

const renderProcessSteps = (steps: ProcessStep[] | undefined) => {
    if (!steps || steps.length === 0) return null;
    return (
        <section className="py-20 bg-secondary-gray">
            <div className='max-w-7xl mx-auto px-4 sm:px-6 lg:px-8'>
                <div className='text-center mb-16'>
                    <h2 className='text-3xl lg:text-4xl font-bold text-primary mb-4'>Our Process</h2>
                    <p className='text-xl text-gray-600 max-w-3xl mx-auto'>
                        A proven {steps.length}-step process for successful approval.
                    </p>
                </div>
                <div className="grid grid-cols-1 md:grid-cols-5 gap-8">
                    {steps.map((step, index) => (
                        <div key={index} className='text-center'>
                            <div className='bg-primary text-white w-16 h-16 rounded-full flex items-center justify-center font-bold text-xl mx-auto mb-4'>
                                {step.step}
                            </div>
                            <h3 className='text-lg font-semibold text-primary mb-2'>{step.title}</h3>
                            <p className='text-gray-600 text-sm'>{step.description}</p>
                        </div>
                    ))}
                </div>
            </div>
        </section>
    )
};

const renderSuccessStory = (story: SuccessStory | undefined) => {
    if (!story || !story.scenario) return null;
    return (
        <section className="py-20">
            <div className='max-w-4xl mx-auto px-4 sm:px-6 lg:px-8'>
                <Card>
                    <CardHeader>
                        <CardTitle>Success Story</CardTitle>
                    </CardHeader>
                    <CardContent className="space-y-4">
                        <div>
                            <h4 className="font-semibold">Scenario</h4>
                            <p className="text-muted-foreground">{story.scenario}</p>
                        </div>
                         <div>
                            <h4 className="font-semibold">Challenge</h4>
                            <p className="text-muted-foreground">{story.challenge}</p>
                        </div>
                         <div>
                            <h4 className="font-semibold">Solution</h4>
                            <p className="text-muted-foreground">{story.solution}</p>
                        </div>
                         <div>
                            <h4 className="font-semibold">Result</h4>
                            <p className="text-muted-foreground font-medium">{story.result}</p>
                        </div>
                    </CardContent>
                 </Card>
            </div>
        </section>
    )
};


export default async function ServiceDetailPage({ params }: { params: Promise<{ slug: string }> }) {
    const { slug } = await params;
	const service = await getServiceBySlug(slug);

	if (!service) {
		notFound();
	}

    const formPath = `/forms/${slug}`;

	return (
		<div className='min-h-screen'>
			{/* Hero Section */}
			<section className='relative text-white py-20'>
				<Image
					src={service.image || `https://picsum.photos/seed/${service.id}/1920/1080`}
                    data-ai-hint="paperwork compliance"
					alt={service.title}
					fill
					priority
					className='object-cover'
				/>
				<div className='absolute inset-0 bg-black/50' />
				<div className='relative max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 z-10'>
                    <Button variant="ghost" asChild className="mb-8 hover:bg-white/10 text-white">
                        <Link href="/services"><ArrowLeft className="mr-2 h-4 w-4"/>Back to Services</Link>
                    </Button>
					<div className='max-w-3xl'>
                        <div className="flex items-center gap-4 mb-4">
                            <Icon name={service.icon || 'Shield'} className="h-8 w-8 text-accent" />
                            <p className="text-accent font-semibold">{service.category}</p>
                        </div>
						<h1 className='text-4xl lg:text-5xl font-bold mb-4'>{service.title}</h1>
						<p className='text-xl text-gray-200 mb-8'>{service.short_description || service.description}</p>
                        <div className="flex flex-col sm:flex-row gap-4">
                            <Button size="lg" asChild><Link href={formPath}>Get a Quote</Link></Button>
                            <Button size="lg" variant="outline" asChild><a href="tel:0754304433">Call Now</a></Button>
                        </div>
					</div>
				</div>
			</section>

			{/* Main Content */}
			<section className="py-20">
                <div className="max-w-4xl mx-auto px-4 sm:px-6 lg:px-8">
                     <h2 className="text-3xl font-bold text-primary mb-6">Service Overview</h2>
                     <div className='prose prose-lg max-w-none text-gray-700 leading-relaxed'>
                        {service.content ||
                            service.description.split('\n').map((para: string, idx: number) => (
                                <p key={idx}>{para}</p>
                            ))}
                    </div>

                    {(service.features && service.features.length > 0) && (
                        <div className="mt-12">
                            <h3 className="text-2xl font-bold text-primary mb-4">What's Included</h3>
                            <ul className="grid grid-cols-1 md:grid-cols-2 gap-4">
                                {service.features.map((feature, idx) => (
                                    <li key={idx} className="flex items-start">
                                        <CheckCircle className="h-5 w-5 text-accent mr-3 mt-1 shrink-0" />
                                        <span>{feature}</span>
                                    </li>
                                ))}
                            </ul>
                        </div>
                    )}
                </div>
            </section>

			{renderPricingPlans(service.pricing_plans, formPath)}
			{renderProcessSteps(service.process_steps)}
			{renderSuccessStory(service.success_story)}
		</div>
	);
}
</file>

<file path="src/components/ui/calendar.tsx">
"use client"

import * as React from "react"
import { DayPicker } from "react-day-picker"
import { ChevronLeft, ChevronRight } from "lucide-react"

import { cn } from "@/lib/utils"
import { buttonVariants } from "@/components/ui/button"

export type CalendarProps = React.ComponentProps<typeof DayPicker>

function Calendar({
  className,
  classNames,
  showOutsideDays = true,
  ...props
}: CalendarProps) {
  return (
    <DayPicker
      showOutsideDays={showOutsideDays}
      className={cn("p-3", className)}
      classNames={{
        months: "flex flex-col sm:flex-row space-y-4 sm:space-x-4 sm:space-y-0",
        month: "space-y-4",
        caption: "flex justify-center pt-1 relative items-center",
        caption_label: "text-sm font-medium",
        nav: "space-x-1 flex items-center",
        nav_button: cn(
          buttonVariants({ variant: "outline" }),
          "h-7 w-7 bg-transparent p-0 opacity-50 hover:opacity-100"
        ),
        nav_button_previous: "absolute left-1",
        nav_button_next: "absolute right-1",
        table: "w-full border-collapse space-y-1",
        head_row: "flex",
        head_cell:
          "text-muted-foreground rounded-md w-9 font-normal text-[0.8rem]",
        row: "flex w-full mt-2",
        cell: "h-9 w-9 text-center text-sm p-0 relative [&:has([aria-selected].day-range-end)]:rounded-r-md [&:has([aria-selected].day-outside)]:bg-accent/50 [&:has([aria-selected])]:bg-accent first:[&:has([aria-selected])]:rounded-l-md last:[&:has([aria-selected])]:rounded-r-md focus-within:relative focus-within:z-20",
        day: cn(
          buttonVariants({ variant: "ghost" }),
          "h-9 w-9 p-0 font-normal aria-selected:opacity-100"
        ),
        day_range_end: "day-range-end",
        day_selected:
          "bg-primary text-primary-foreground hover:bg-primary hover:text-primary-foreground focus:bg-primary focus:text-primary-foreground",
        day_today: "bg-accent text-accent-foreground",
        day_outside:
          "day-outside text-muted-foreground opacity-50 aria-selected:bg-accent/50 aria-selected:text-muted-foreground",
        day_disabled: "text-muted-foreground opacity-50",
        day_range_middle:
          "aria-selected:bg-accent aria-selected:text-accent-foreground",
        day_hidden: "invisible",
        ...classNames,
      }}
      {...props}
    />
  )
}
Calendar.displayName = "Calendar"

export { Calendar }
</file>

<file path="src/app/admin/contacts/ContactForm.tsx">
'use client';

import { useForm } from 'react-hook-form';
import { zodResolver } from '@hookform/resolvers/zod';
import { Button } from '@/components/ui/button';
import {
  Form,
  FormControl,
  FormField,
  FormItem,
  FormLabel,
  FormMessage,
} from '@/components/ui/form';
import { Input } from '@/components/ui/input';
import { useToast } from '@/hooks/use-toast';
import type { Contact } from '@/lib/types';
import { useEffect } from 'react';
import { Loader2 } from 'lucide-react';
import { Textarea } from '@/components/ui/textarea';
import { useRouter } from 'next/navigation';
import Link from 'next/link';
import { contactSchema } from './schema';
import { upsertContact } from './actions';

type ContactFormValues = Zod.infer<typeof contactSchema>;

interface ContactFormProps {
  contact?: Contact | null;
}

export default function ContactForm({ contact }: ContactFormProps) {
  const { toast } = useToast();
  const router = useRouter();
  const form = useForm<ContactFormValues>({
    resolver: zodResolver(contactSchema),
    defaultValues: {
      name: '',
      email: '',
      phone: '',
      service: '',
      message: '',
    },
  });

  const {
    handleSubmit,
    reset,
    formState: { isSubmitting },
  } = form;
  const isEditing = !!contact;

  useEffect(() => {
    if (contact) {
      reset({
        name: contact.name,
        email: contact.email,
        phone: contact.phone || '',
        service: contact.service || '',
        message: contact.message || '',
      });
    }
  }, [contact, reset]);

  const onSubmit = async (values: ContactFormValues) => {
    try {
      const result = await upsertContact(values, contact?.id);

      if (result.error) {
        throw new Error(result.error);
      }

      toast({
        title: result.message,
      });
      router.push('/admin/contacts');
      router.refresh();
    } catch (error: any) {
      toast({
        variant: 'destructive',
        title: 'Error saving contact',
        description: error.message,
      });
    }
  };

  return (
    <Form {...form}>
      <form onSubmit={handleSubmit(onSubmit)} className="space-y-4">
        <FormField
          control={form.control}
          name="name"
          render={({ field }) => (
            <FormItem>
              <FormLabel>Name</FormLabel>
              <FormControl>
                <Input placeholder="John Doe" {...field} />
              </FormControl>
              <FormMessage />
            </FormItem>
          )}
        />
        <FormField
          control={form.control}
          name="email"
          render={({ field }) => (
            <FormItem>
              <FormLabel>Email</FormLabel>
              <FormControl>
                <Input placeholder="john.doe@example.com" {...field} />
              </FormControl>
              <FormMessage />
            </FormItem>
          )}
        />
        <FormField
          control={form.control}
          name="phone"
          render={({ field }) => (
            <FormItem>
              <FormLabel>Phone</FormLabel>
              <FormControl>
                <Input placeholder="(123) 456-7890" {...field} />
              </FormControl>
              <FormMessage />
            </FormItem>
          )}
        />
        <FormField
          control={form.control}
          name="service"
          render={({ field }) => (
            <FormItem>
              <FormLabel>Service</FormLabel>
              <FormControl>
                <Input placeholder="e.g. Web Development" {...field} />
              </FormControl>
              <FormMessage />
            </FormItem>
          )}
        />
        <FormField
          control={form.control}
          name="message"
          render={({ field }) => (
            <FormItem>
              <FormLabel>Message / Notes</FormLabel>
              <FormControl>
                <Textarea placeholder="Initial contact from the website..." {...field} />
              </FormControl>
              <FormMessage />
            </FormItem>
          )}
        />
        <div className="flex justify-end gap-4 pt-4">
          <Button type="button" variant="outline" asChild>
            <Link href="/admin/contacts">Cancel</Link>
          </Button>
          <Button type="submit" disabled={isSubmitting}>
            {isSubmitting && <Loader2 className="mr-2 h-4 w-4 animate-spin" />}
            {isEditing ? 'Save Changes' : 'Add Contact'}
          </Button>
        </div>
      </form>
    </Form>
  );
}
</file>

<file path="src/lib/supabase/blog.ts">
import 'server-only';
import { createClient as createServerClient } from '@/lib/supabase/server';
import { createClient } from '@supabase/supabase-js';
import type { BlogPost } from '../types';

function mapToBlogPost(item: any): BlogPost {
    return {
        id: item.id,
        title: item.title,
        slug: item.slug,
        excerpt: item.excerpt,
        content: item.content,
        category: item.category,
        tags: item.tags,
        read_time: item.read_time,
        seo_title: item.seo_title,
        seo_description: item.seo_description,
        seo_keywords: item.seo_keywords,
        featured_image: item.featured_image,
        thumbnail: item.thumbnail,
        published: item.published,
        published_at: item.published_at,
        featured: item.featured,
        author_id: item.author_id,
        author_name: item.author_name,
        views_count: item.views_count,
        createdAt: item.created_at,
        updatedAt: item.updated_at,
    };
}

export async function getPublishedBlogPosts(limit?: number): Promise<BlogPost[]> {
    const supabase = await createServerClient();
    let query = supabase
        .from('blog_posts')
        .select('*')
        .eq('published', true)
        .order('created_at', { ascending: false });

    if (limit) {
        query = query.limit(limit);
    }
  
    const { data, error } = await query;
  
    if (error) {
      console.error('Error fetching blog posts:', error.message);
      return [];
    }
  
    return data.map(mapToBlogPost);
}

export async function getBlogPostBySlug(slug: string): Promise<BlogPost | null> {
    const supabase = createClient(
        process.env.NEXT_PUBLIC_SUPABASE_URL!,
        process.env.NEXT_PUBLIC_SUPABASE_ANON_KEY!
    );
    const { data, error } = await supabase
      .from('blog_posts')
      .select('*')
      .eq('slug', slug)
      .eq('published', true)
      .single();
  
    if (error || !data) {
      return null;
    }
  
    return mapToBlogPost(data);
}

export async function getAllPublishedBlogSlugs(): Promise<{ slug: string }[]> {
    const supabase = createClient(
        process.env.NEXT_PUBLIC_SUPABASE_URL!,
        process.env.NEXT_PUBLIC_SUPABASE_ANON_KEY!
    );
    const { data, error } = await supabase
      .from('blog_posts')
      .select('slug')
      .eq('published', true);
  
    if (error) {
      console.error('Error fetching blog slugs:', error);
      return [];
    }
  
    return data;
}
</file>

<file path="src/lib/types.ts">
export interface PricingPlan {
  title: string;
  description: string;
  features: string[];
  price: string;
  popular: boolean;
}

export interface ProcessStep {
  step: string;
  title: string;
  description: string;
}

export interface SuccessStory {
  scenario: string;
  challenge: string;
  solution: string;
  result: string;
}

export interface Submission {
  id?: string;
  formType: string;
  status: 'pending' | 'in-progress' | 'completed' | 'rejected' | 'archived';
  serviceId?: string;
  serviceName?: string;
  fullName: string;
  email: string;
  phone?: string;
  company?: string;
  industry?: string;
  details?: any; // jsonb
  internalNotes?: string;
  assignedTo?: string;
  createdAt: string; // timestamp
  updatedAt: string; // timestamp
  completedAt?: string; // timestamp
}


export interface Service {
  id: string;
  title: string;
  description: string;
  short_description?: string;
  slug: string;
  icon?: string;
  href: string;
  category: string;
  order_index?: number;
  content?: string;
  features?: string[];
  requirements?: string[];
  includes?: string[];
  published: boolean;
  featured: boolean;
  created_at: string;
  processing_time?: string;
  pricing?: number;
  image?: string;
  thumbnail?: string;
  seo_title?: string;
  seo_description?: string;
  seo_keywords?: string;
  pricing_plans?: PricingPlan[];
  process_steps?: ProcessStep[];
  success_story?: SuccessStory;
  updated_at?: string;
}

export interface Testimonial {
  id: string;
  postUrl: string;
  createdAt: string;
}

export interface BlogPost {
  id: string;
  title: string;
  slug: string;
  excerpt?: string;
  content?: string;
  category?: string;
  tags?: string;
  read_time?: string;
  seo_title?: string;
  seo_description?: string;
  seo_keywords?: string;
  featured_image?: string;
  thumbnail?: string;
  published: boolean;
  published_at?: string;
  featured: boolean;
  author_id?: string;
  author_name?: string;
  views_count?: number;
  createdAt: string;
  updatedAt?: string;
}

export interface Contact {
  id: string;
  name: string;
  email: string;
  phone?: string;
  service?: string;
  message?: string;
  submitted_at: string;
}
</file>

<file path="src/app/admin/blogs/BlogForm.tsx">
'use client';

import { useForm } from 'react-hook-form';
import { zodResolver } from '@hookform/resolvers/zod';
import { Button } from '@/components/ui/button';
import {
  Form,
  FormControl,
  FormDescription,
  FormField,
  FormItem,
  FormLabel,
  FormMessage,
} from '@/components/ui/form';
import { Input } from '@/components/ui/input';
import { Textarea } from '@/components/ui/textarea';
import { Switch } from '@/components/ui/switch';
import { useToast } from '@/hooks/use-toast';
import type { BlogPost } from '@/lib/types';
import { useEffect, useTransition } from 'react';
import { Loader2 } from 'lucide-react';
import { useRouter } from 'next/navigation';
import Link from 'next/link';
import ImageUpload from '@/components/ui/ImageUpload';
import { Card, CardContent, CardHeader, CardTitle } from '@/components/ui/card';
import { blogSchema, BlogFormValues } from './schema';
import { upsertBlog } from './actions';

interface BlogFormProps {
  blog?: BlogPost | null;
}

const slugify = (str: string) =>
  str
    .toLowerCase()
    .trim()
    .replace(/[^\w\s-]/g, '')
    .replace(/[\s_-]+/g, '-')
    .replace(/^-+|-+$/g, '');

export default function BlogForm({ blog }: BlogFormProps) {
  const { toast } = useToast();
  const router = useRouter();
  const [isPending, startTransition] = useTransition();

  const form = useForm<BlogFormValues>({
    resolver: zodResolver(blogSchema),
    defaultValues: {
      title: '',
      slug: '',
      author_name: 'Bilacert Team',
      read_time: '5 min read',
      category: '',
      tags: '',
      excerpt: '',
      content: '',
      published: false,
      featured_image: '',
      thumbnail: '',
      featured: false,
      seo_title: '',
      seo_description: '',
      seo_keywords: '',
    },
  });

  const { handleSubmit, reset, watch, setValue } = form;

  const title = watch('title');
  const isEditing = !!blog;

  useEffect(() => {
    if (!isEditing && title) {
      setValue('slug', slugify(title), { shouldValidate: true });
    }
  }, [title, setValue, isEditing]);

  useEffect(() => {
    if (blog) {
      reset({
        title: blog.title,
        slug: blog.slug,
        author_name: blog.author_name || 'Bilacert Team',
        read_time: blog.read_time || '5 min read',
        tags: blog.tags || '',
        excerpt: blog.excerpt || '',
        content: blog.content || '',
        published: blog.published,
        featured_image: blog.featured_image || '',
        thumbnail: blog.thumbnail || '',
        featured: blog.featured || false,
        seo_title: blog.seo_title || '',
        seo_description: blog.seo_description || '',
        seo_keywords: blog.seo_keywords || '',
      });
    }
  }, [blog, reset]);

  const onSubmit = (values: BlogFormValues) => {
    startTransition(async () => {
      const result = await upsertBlog(values, blog?.id);
      if (result.error) {
        toast({
          variant: 'destructive',
          title: 'Error saving blog post',
          description: result.error,
        });
      } else {
        toast({
          title: result.message,
        });
        router.push('/admin/blogs');
      }
    });
  };

  return (
    <Form {...form}>
      <form onSubmit={handleSubmit(onSubmit)} className="space-y-8">
        <div className="grid grid-cols-1 gap-8 lg:grid-cols-3">
          <div className="space-y-6 lg:col-span-2">
            <Card>
              <CardHeader><CardTitle>Core Details</CardTitle></CardHeader>
              <CardContent className="space-y-4">
                <FormField control={form.control} name="title" render={({ field }) => ( <FormItem><FormLabel>Title</FormLabel><FormControl><Input placeholder="e.g., My Awesome Blog Post" {...field} /></FormControl><FormMessage /></FormItem> )} />
                <FormField control={form.control} name="slug" render={({ field }) => ( <FormItem><FormLabel>Slug</FormLabel><FormControl><Input placeholder="e.g., my-awesome-blog-post" {...field} /></FormControl><FormMessage /></FormItem> )} />
              </CardContent>
            </Card>

            <Card>
              <CardHeader><CardTitle>Media</CardTitle></CardHeader>
              <CardContent className="grid grid-cols-1 md:grid-cols-2 gap-6">
                <FormField control={form.control} name="featured_image" render={({ field }) => ( <FormItem><FormLabel>Featured Image</FormLabel><FormControl><ImageUpload bucket='blogs' initialUrl={field.value} onUpload={(url) => field.onChange(url)} onRemove={() => field.onChange('')} /></FormControl><FormMessage /></FormItem> )}/>
                <FormField control={form.control} name="thumbnail" render={({ field }) => ( <FormItem><FormLabel>Thumbnail Image</FormLabel><FormControl><ImageUpload bucket='blogs' initialUrl={field.value} onUpload={(url) => field.onChange(url)} onRemove={() => field.onChange('')} /></FormControl><FormMessage /></FormItem> )}/>
              </CardContent>
            </Card>

            <Card>
                <CardHeader><CardTitle>Content</CardTitle></CardHeader>
                <CardContent className="space-y-4">
                  <FormField control={form.control} name="excerpt" render={({ field }) => ( <FormItem><FormLabel>Excerpt</FormLabel><FormControl><Textarea placeholder="A short summary of the post." {...field} /></FormControl><FormMessage /></FormItem> )} />
                  <FormField control={form.control} name="content" render={({ field }) => ( <FormItem><FormLabel>Content</FormLabel><FormControl><Textarea placeholder="Write your blog post here. Markdown is supported." rows={12} {...field} /></FormControl><FormMessage /></FormItem> )} />
                </CardContent>
            </Card>
            
            <Card>
                <CardHeader><CardTitle>SEO</CardTitle></CardHeader>
                <CardContent className="space-y-4">
                    <FormField control={form.control} name="seo_title" render={({ field }) => ( <FormItem><FormLabel>SEO Title</FormLabel><FormControl><Input {...field} /></FormControl><FormMessage /></FormItem> )}/>
                    <FormField control={form.control} name="seo_description" render={({ field }) => ( <FormItem><FormLabel>SEO Description</FormLabel><FormControl><Textarea {...field} /></FormControl><FormMessage /></FormItem> )}/>
                    <FormField control={form.control} name="seo_keywords" render={({ field }) => ( <FormItem><FormLabel>SEO Keywords (comma separated)</FormLabel><FormControl><Input {...field} /></FormControl><FormMessage /></FormItem> )}/>
                </CardContent>
            </Card>
          </div>
          <div className="space-y-6 lg:col-span-1">
             <Card>
                <CardHeader><CardTitle>Publishing</CardTitle></CardHeader>
                <CardContent className="space-y-4">
                    <FormField control={form.control} name="published" render={({ field }) => ( <FormItem className="flex flex-row items-center justify-between rounded-lg border p-4"><div className="space-y-0.5"><FormLabel>Published</FormLabel><FormDescription>Make this post visible.</FormDescription></div><FormControl><Switch checked={field.value} onCheckedChange={field.onChange} /></FormControl></FormItem> )}/>
                    <FormField control={form.control} name="featured" render={({ field }) => ( <FormItem className="flex flex-row items-center justify-between rounded-lg border p-4"><div className="space-y-0.5"><FormLabel>Featured Post</FormLabel><FormDescription>Display this post prominently.</FormDescription></div><FormControl><Switch checked={field.value} onCheckedChange={field.onChange} /></FormControl></FormItem> )}/>
                </CardContent>
            </Card>
            <Card>
                <CardHeader><CardTitle>Details</CardTitle></CardHeader>
                <CardContent className="space-y-4">
                    <FormField control={form.control} name="author_name" render={({ field }) => ( <FormItem><FormLabel>Author</FormLabel><FormControl><Input {...field} /></FormControl><FormMessage /></FormItem> )}/>
                    <FormField control={form.control} name="read_time" render={({ field }) => ( <FormItem><FormLabel>Read Time</FormLabel><FormControl><Input placeholder="e.g., 5 min read" {...field} /></FormControl><FormMessage /></FormItem> )}/>
                    <FormField control={form.control} name="category" render={({ field }) => ( <FormItem><FormLabel>Category</FormLabel><FormControl><Input placeholder="e.g., Tech" {...field} /></FormControl><FormMessage /></FormItem> )}/>
                    <FormField control={form.control} name="tags" render={({ field }) => ( <FormItem><FormLabel>Tags (comma separated)</FormLabel><FormControl><Input placeholder="e.g., icasa, nrcs" {...field} /></FormControl><FormMessage /></FormItem> )}/>
                </CardContent>
            </Card>
          </div>
        </div>
        <div className="flex justify-end gap-4">
          <Button type="button" variant="outline" asChild>
            <Link href="/admin/blogs">Cancel</Link>
          </Button>
          <Button type="submit" disabled={isPending}>
            {isPending && <Loader2 className="mr-2 h-4 w-4 animate-spin" />}
            {isEditing ? 'Save Changes' : 'Create Post'}
          </Button>
        </div>
      </form>
    </Form>
  );
}
</file>

</files>
